{"version":3,"file":"TimelineFlameChartDataProvider.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineFlameChartDataProvider.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2014 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport * as TimelineModel from '../../models/timeline_model/timeline_model.js';\nimport * as PerfUI from '../../ui/legacy/components/perf_ui/perf_ui.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as ThemeSupport from '../../ui/legacy/theme_support/theme_support.js';\n\nimport type {PerformanceModel} from './PerformanceModel.js'; // eslint-disable-line no-unused-vars\nimport {FlameChartStyle, Selection, TimelineFlameChartMarker} from './TimelineFlameChartView.js';\nimport {TimelineSelection} from './TimelinePanel.js';\nimport type {TimelineCategory} from './TimelineUIUtils.js';\nimport {TimelineUIUtils} from './TimelineUIUtils.js';  // eslint-disable-line no-unused-vars\n\nconst UIStrings = {\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  onIgnoreList: 'On ignore list',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  input: 'Input',\n  /**\n  *@description Text that refers to the animation of the web page\n  */\n  animation: 'Animation',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  timings: 'Timings',\n  /**\n  *@description Title of the Console tool\n  */\n  console: 'Console',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  *@example {example.com} PH1\n  */\n  mainS: 'Main — {PH1}',\n  /**\n  *@description Text that refers to the main target\n  */\n  main: 'Main',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  *@example {https://example.com} PH1\n  */\n  frameS: 'Frame — {PH1}',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  subframe: 'Subframe',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  raster: 'Raster',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  *@example {2} PH1\n  */\n  rasterizerThreadS: 'Rasterizer Thread {PH1}',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  gpu: 'GPU',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  thread: 'Thread',\n  /**\n  *@description Text in Timeline for the Experience title\n  */\n  experience: 'Experience',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  interactions: 'Interactions',\n  /**\n  *@description Text for rendering frames\n  */\n  frames: 'Frames',\n  /**\n  * @description Text in the Performance panel to show how long was spent in a particular part of the code.\n  * The first placeholder is the total time taken for this node and all children, the second is the self time\n  * (time taken in this node, without children included).\n  *@example {10ms} PH1\n  *@example {10ms} PH2\n  */\n  sSelfS: '{PH1} (self {PH2})',\n  /**\n  *@description Tooltip text for the number of CLS occurences in Timeline\n  *@example {4} PH1\n  */\n  occurrencesS: 'Occurrences: {PH1}',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  *@example {10ms} PH1\n  *@example {100.0} PH2\n  */\n  sFfps: '{PH1} ~ {PH2} fps',\n  /**\n  *@description Text in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  idleFrame: 'Idle Frame',\n  /**\n  *@description Text in Timeline Frame Chart Data Provider of the Performance panel\n  */\n  droppedFrame: 'Dropped Frame',\n  /**\n  *@description Text for a rendering frame\n  */\n  frame: 'Frame',\n  /**\n  *@description Warning text content in Timeline Flame Chart Data Provider of the Performance panel\n  */\n  longFrame: 'Long frame',\n  /**\n  * @description Text for the name of a thread of the page. Used when there are multiple threads but\n  * a more specific name for this thread is not available. The placeholder is a number that uniquely\n  * identifies this thread.\n  * @example {1} PH1\n  */\n  threadS: 'Thread {PH1}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/TimelineFlameChartDataProvider.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class TimelineFlameChartDataProvider extends Common.ObjectWrapper.ObjectWrapper implements\n    PerfUI.FlameChart.FlameChartDataProvider {\n  _font: string;\n  _timelineData: PerfUI.FlameChart.TimelineData|null;\n  _currentLevel: number;\n  _performanceModel: PerformanceModel|null;\n  _model: TimelineModel.TimelineModel.TimelineModelImpl|null;\n  _minimumBoundary: number;\n  _maximumBoundary: number;\n  _timeSpan: number;\n  _consoleColorGenerator: Common.Color.Generator;\n  _extensionColorGenerator: Common.Color.Generator;\n  _headerLevel1: PerfUI.FlameChart.GroupStyle;\n  _headerLevel2: PerfUI.FlameChart.GroupStyle;\n  _staticHeader: PerfUI.FlameChart.GroupStyle;\n  _framesHeader: PerfUI.FlameChart.GroupStyle;\n  _collapsibleTimingsHeader: PerfUI.FlameChart.GroupStyle;\n  _timingsHeader: PerfUI.FlameChart.GroupStyle;\n  _screenshotsHeader: PerfUI.FlameChart.GroupStyle;\n  _interactionsHeaderLevel1: PerfUI.FlameChart.GroupStyle;\n  _interactionsHeaderLevel2: PerfUI.FlameChart.GroupStyle;\n  _experienceHeader: PerfUI.FlameChart.GroupStyle;\n  _flowEventIndexById: Map<string, number>;\n  _entryData!: (SDK.FilmStripModel.Frame|SDK.TracingModel.Event|\n                TimelineModel.TimelineFrameModel.TimelineFrame|TimelineModel.TimelineIRModel.Phases)[];\n  _entryTypeByLevel!: EntryType[];\n  _markers!: TimelineFlameChartMarker[];\n  _asyncColorByInteractionPhase!: Map<TimelineModel.TimelineIRModel.Phases, string>;\n  _screenshotImageCache!: Map<SDK.FilmStripModel.Frame, HTMLImageElement|null>;\n  _extensionInfo!: {\n    title: string,\n    model: SDK.TracingModel.TracingModel,\n  }[];\n  _entryIndexToTitle!: string[];\n  _asyncColorByCategory!: Map<TimelineCategory, string>;\n  _lastInitiatorEntry!: number;\n  _entryParent!: SDK.TracingModel.Event[];\n  _frameGroup?: PerfUI.FlameChart.Group;\n  _lastSelection?: Selection;\n  _colorForEvent?: ((arg0: SDK.TracingModel.Event) => string);\n\n  constructor() {\n    super();\n    this.reset();\n    this._font = '11px ' + Host.Platform.fontFamily();\n    this._timelineData = null;\n    this._currentLevel = 0;\n    this._performanceModel = null;\n    this._model = null;\n    this._minimumBoundary = 0;\n    this._maximumBoundary = 0;\n    this._timeSpan = 0;\n\n    this._consoleColorGenerator = new Common.Color.Generator(\n        {\n          min: 30,\n          max: 55,\n          count: undefined,\n        },\n        {min: 70, max: 100, count: 6}, 50, 0.7);\n    this._extensionColorGenerator = new Common.Color.Generator(\n        {\n          min: 210,\n          max: 300,\n          count: undefined,\n        },\n        {min: 70, max: 100, count: 6}, 70, 0.7);\n\n    this._headerLevel1 = this._buildGroupStyle({shareHeaderLine: false});\n    this._headerLevel2 = this._buildGroupStyle({padding: 2, nestingLevel: 1, collapsible: false});\n    this._staticHeader = this._buildGroupStyle({collapsible: false});\n    this._framesHeader = this._buildGroupStyle({useFirstLineForOverview: true});\n    this._collapsibleTimingsHeader =\n        this._buildGroupStyle({shareHeaderLine: true, useFirstLineForOverview: true, collapsible: true});\n    this._timingsHeader =\n        this._buildGroupStyle({shareHeaderLine: true, useFirstLineForOverview: true, collapsible: false});\n    this._screenshotsHeader =\n        this._buildGroupStyle({useFirstLineForOverview: true, nestingLevel: 1, collapsible: false, itemsHeight: 150});\n    this._interactionsHeaderLevel1 = this._buildGroupStyle({useFirstLineForOverview: true});\n    this._interactionsHeaderLevel2 = this._buildGroupStyle({padding: 2, nestingLevel: 1});\n    this._experienceHeader = this._buildGroupStyle({collapsible: false});\n\n    this._flowEventIndexById = new Map();\n  }\n\n  _buildGroupStyle(extra: Object): PerfUI.FlameChart.GroupStyle {\n    const defaultGroupStyle = {\n      padding: 4,\n      height: 17,\n      collapsible: true,\n      color:\n          ThemeSupport.ThemeSupport.instance().patchColorText('#222', ThemeSupport.ThemeSupport.ColorUsage.Foreground),\n      backgroundColor:\n          ThemeSupport.ThemeSupport.instance().patchColorText('white', ThemeSupport.ThemeSupport.ColorUsage.Background),\n      font: this._font,\n      nestingLevel: 0,\n      shareHeaderLine: true,\n    };\n    return /** @type {!PerfUI.FlameChart.GroupStyle} */ Object.assign(defaultGroupStyle, extra) as\n        PerfUI.FlameChart.GroupStyle;\n  }\n\n  setModel(performanceModel: PerformanceModel|null): void {\n    this.reset();\n    this._performanceModel = performanceModel;\n    this._model = performanceModel && performanceModel.timelineModel();\n  }\n\n  groupTrack(group: PerfUI.FlameChart.Group): TimelineModel.TimelineModel.Track|null {\n    return group.track || null;\n  }\n\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  navStartTimes(): Map<any, any> {\n    if (!this._model) {\n      return new Map();\n    }\n\n    return this._model.navStartTimes();\n  }\n\n  entryTitle(entryIndex: number): string|null {\n    const entryTypes = EntryType;\n    const entryType = this._entryType(entryIndex);\n    if (entryType === entryTypes.Event) {\n      const event = (this._entryData[entryIndex] as SDK.TracingModel.Event);\n      if (event.phase === SDK.TracingModel.Phase.AsyncStepInto ||\n          event.phase === SDK.TracingModel.Phase.AsyncStepPast) {\n        return event.name + ':' + event.args['step'];\n      }\n      if (eventToDisallowRoot.get(event)) {\n        return i18nString(UIStrings.onIgnoreList);\n      }\n      if (this._performanceModel && this._performanceModel.timelineModel().isMarkerEvent(event)) {\n        return TimelineUIUtils.markerShortTitle(event);\n      }\n      return TimelineUIUtils.eventTitle(event);\n    }\n    if (entryType === entryTypes.ExtensionEvent) {\n      const event = (this._entryData[entryIndex] as SDK.TracingModel.Event);\n      return event.name;\n    }\n    if (entryType === entryTypes.Screenshot) {\n      return '';\n    }\n    let title: Common.UIString.LocalizedString|string = this._entryIndexToTitle[entryIndex];\n    if (!title) {\n      title = `Unexpected entryIndex ${entryIndex}`;\n      console.error(title);\n    }\n    return title;\n  }\n\n  textColor(index: number): string {\n    const event = this._entryData[index];\n    return event && eventToDisallowRoot.get((event as SDK.TracingModel.Event)) ? '#888' : FlameChartStyle.textColor;\n  }\n\n  entryFont(_index: number): string|null {\n    return this._font;\n  }\n\n  reset(): void {\n    this._currentLevel = 0;\n    this._timelineData = null;\n    this._entryData = [];\n    this._entryParent = [];\n    this._entryTypeByLevel = [];\n    this._entryIndexToTitle = [];\n    this._markers = [];\n    this._asyncColorByCategory = new Map();\n    this._asyncColorByInteractionPhase = new Map();\n    this._extensionInfo = [];\n    this._screenshotImageCache = new Map();\n  }\n\n  maxStackDepth(): number {\n    return this._currentLevel;\n  }\n\n  timelineData(): PerfUI.FlameChart.TimelineData {\n    if (this._timelineData) {\n      return this._timelineData;\n    }\n\n    this._timelineData = new PerfUI.FlameChart.TimelineData([], [], [], []);\n    if (!this._model) {\n      return this._timelineData;\n    }\n\n    this._flowEventIndexById.clear();\n    this._minimumBoundary = this._model.minimumRecordTime();\n    this._timeSpan = this._model.isEmpty() ? 1000 : this._model.maximumRecordTime() - this._minimumBoundary;\n    this._currentLevel = 0;\n\n    if (this._model.isGenericTrace()) {\n      this._processGenericTrace();\n    } else {\n      this._processInspectorTrace();\n    }\n\n    return this._timelineData;\n  }\n\n  _processGenericTrace(): void {\n    const processGroupStyle = this._buildGroupStyle({shareHeaderLine: false});\n    const threadGroupStyle = this._buildGroupStyle({padding: 2, nestingLevel: 1, shareHeaderLine: false});\n    const eventEntryType = EntryType.Event;\n    const tracksByProcess =\n        new Platform.MapUtilities.Multimap<SDK.TracingModel.Process, TimelineModel.TimelineModel.Track>();\n    if (!this._model) {\n      return;\n    }\n    for (const track of this._model.tracks()) {\n      if (track.thread !== null) {\n        tracksByProcess.set(track.thread.process(), track);\n      } else {\n        // The Timings track can reach this point, so we should probably do something more useful.\n        console.error('Failed to process track');\n      }\n    }\n    for (const process of tracksByProcess.keysArray()) {\n      if (tracksByProcess.size > 1) {\n        const name = `${process.name()} ${process.id()}`;\n        this._appendHeader(name, processGroupStyle, false /* selectable */);\n      }\n      for (const track of tracksByProcess.get(process)) {\n        const group = this._appendSyncEvents(\n            track, track.events, track.name, threadGroupStyle, eventEntryType, true /* selectable */);\n        if (this._timelineData &&\n            (!this._timelineData.selectedGroup ||\n             track.name === TimelineModel.TimelineModel.TimelineModelImpl.BrowserMainThreadName)) {\n          this._timelineData.selectedGroup = group;\n        }\n      }\n    }\n  }\n\n  _processInspectorTrace(): void {\n    this._appendFrames();\n    this._appendInteractionRecords();\n\n    const eventEntryType = EntryType.Event;\n\n    const weight = (track: TimelineModel.TimelineModel.Track): 0|1|2|3|4|5|6|7|8|9|10|- 1 => {\n      switch (track.type) {\n        case TimelineModel.TimelineModel.TrackType.Input:\n          return 0;\n        case TimelineModel.TimelineModel.TrackType.Animation:\n          return 1;\n        case TimelineModel.TimelineModel.TrackType.Timings:\n          return 2;\n        case TimelineModel.TimelineModel.TrackType.Console:\n          return 3;\n        case TimelineModel.TimelineModel.TrackType.Experience:\n          return 4;\n        case TimelineModel.TimelineModel.TrackType.MainThread:\n          return track.forMainFrame ? 5 : 6;\n        case TimelineModel.TimelineModel.TrackType.Worker:\n          return 7;\n        case TimelineModel.TimelineModel.TrackType.Raster:\n          return 8;\n        case TimelineModel.TimelineModel.TrackType.GPU:\n          return 9;\n        case TimelineModel.TimelineModel.TrackType.Other:\n          return 10;\n        default:\n          return -1;\n      }\n    };\n\n    if (!this._model) {\n      return;\n    }\n\n    const tracks = this._model.tracks().slice();\n    tracks.sort((a, b) => weight(a) - weight(b));\n    let rasterCount = 0;\n    for (const track of tracks) {\n      switch (track.type) {\n        case TimelineModel.TimelineModel.TrackType.Input: {\n          this._appendAsyncEventsGroup(\n              track, i18nString(UIStrings.input), track.asyncEvents, this._interactionsHeaderLevel2, eventEntryType,\n              false /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Animation: {\n          this._appendAsyncEventsGroup(\n              track, i18nString(UIStrings.animation), track.asyncEvents, this._interactionsHeaderLevel2, eventEntryType,\n              false /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Timings: {\n          const style = track.asyncEvents.length > 0 ? this._collapsibleTimingsHeader : this._timingsHeader;\n          const group = this._appendHeader(i18nString(UIStrings.timings), style, true /* selectable */);\n          group.track = track;\n          this._appendPageMetrics();\n          this._copyPerfMarkEvents(track);\n          this._appendSyncEvents(track, track.events, null, null, eventEntryType, true /* selectable */);\n          this._appendAsyncEventsGroup(track, null, track.asyncEvents, null, eventEntryType, true /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Console: {\n          this._appendAsyncEventsGroup(\n              track, i18nString(UIStrings.console), track.asyncEvents, this._headerLevel1, eventEntryType,\n              true /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.MainThread: {\n          if (track.forMainFrame) {\n            const group = this._appendSyncEvents(\n                track, track.events,\n                track.url ? i18nString(UIStrings.mainS, {PH1: track.url}) : i18nString(UIStrings.main),\n                this._headerLevel1, eventEntryType, true /* selectable */);\n            if (group && this._timelineData) {\n              this._timelineData.selectedGroup = group;\n            }\n          } else {\n            this._appendSyncEvents(\n                track, track.events,\n                track.url ? i18nString(UIStrings.frameS, {PH1: track.url}) : i18nString(UIStrings.subframe),\n                this._headerLevel1, eventEntryType, true /* selectable */);\n          }\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Worker: {\n          this._appendSyncEvents(\n              track, track.events, track.name, this._headerLevel1, eventEntryType, true /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Raster: {\n          if (!rasterCount) {\n            this._appendHeader(i18nString(UIStrings.raster), this._headerLevel1, false /* selectable */);\n          }\n          ++rasterCount;\n          this._appendSyncEvents(\n              track, track.events, i18nString(UIStrings.rasterizerThreadS, {PH1: rasterCount}), this._headerLevel2,\n              eventEntryType, true /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.GPU: {\n          this._appendSyncEvents(\n              track, track.events, i18nString(UIStrings.gpu), this._headerLevel1, eventEntryType,\n              true /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Other: {\n          this._appendSyncEvents(\n              track, track.events, track.name || i18nString(UIStrings.thread), this._headerLevel1, eventEntryType,\n              true /* selectable */);\n          this._appendAsyncEventsGroup(\n              track, track.name, track.asyncEvents, this._headerLevel1, eventEntryType, true /* selectable */);\n          break;\n        }\n\n        case TimelineModel.TimelineModel.TrackType.Experience: {\n          this._appendSyncEvents(\n              track, track.events, i18nString(UIStrings.experience), this._experienceHeader, eventEntryType,\n              true /* selectable */);\n          break;\n        }\n      }\n    }\n    if (this._timelineData && this._timelineData.selectedGroup) {\n      this._timelineData.selectedGroup.expanded = true;\n    }\n\n    for (let extensionIndex = 0; extensionIndex < this._extensionInfo.length; extensionIndex++) {\n      this._innerAppendExtensionEvents(extensionIndex);\n    }\n\n    this._markers.sort((a, b) => a.startTime() - b.startTime());\n    if (this._timelineData) {\n      this._timelineData.markers = this._markers;\n    }\n    this._flowEventIndexById.clear();\n  }\n\n  minimumBoundary(): number {\n    return this._minimumBoundary;\n  }\n\n  totalTime(): number {\n    return this._timeSpan;\n  }\n\n  search(startTime: number, endTime: number, filter: TimelineModel.TimelineModelFilter.TimelineModelFilter): number[] {\n    const result = [];\n    const entryTypes = EntryType;\n    this.timelineData();\n    for (let i = 0; i < this._entryData.length; ++i) {\n      if (this._entryType(i) !== entryTypes.Event) {\n        continue;\n      }\n      const event = (this._entryData[i] as SDK.TracingModel.Event);\n      if (event.startTime > endTime) {\n        continue;\n      }\n      if ((event.endTime || event.startTime) < startTime) {\n        continue;\n      }\n      if (filter.accept(event)) {\n        result.push(i);\n      }\n    }\n    result.sort(\n        (a, b) => SDK.TracingModel.Event.compareStartTime(\n            (this._entryData[a] as SDK.TracingModel.Event), (this._entryData[b] as SDK.TracingModel.Event)));\n    return result;\n  }\n\n  _appendSyncEvents(\n      track: TimelineModel.TimelineModel.Track|null, events: SDK.TracingModel.Event[], title: string|null,\n      style: PerfUI.FlameChart.GroupStyle|null, entryType: EntryType, selectable: boolean): PerfUI.FlameChart.Group\n      |null {\n    if (!events.length) {\n      return null;\n    }\n    if (!this._performanceModel || !this._model) {\n      return null;\n    }\n    const isExtension = entryType === EntryType.ExtensionEvent;\n    const openEvents = [];\n    const ignoreListingEnabled = !isExtension && Root.Runtime.experiments.isEnabled('blackboxJSFramesOnTimeline');\n    let maxStackDepth = 0;\n    let group: PerfUI.FlameChart.Group|null = null;\n    if (track && track.type === TimelineModel.TimelineModel.TrackType.MainThread) {\n      group = this._appendHeader((title as string), (style as PerfUI.FlameChart.GroupStyle), selectable);\n      group.track = track;\n    }\n    for (let i = 0; i < events.length; ++i) {\n      const e = events[i];\n      // Skip Layout Shifts and TTI events when dealing with the main thread.\n      if (this._performanceModel) {\n        const isInteractiveTime = this._performanceModel.timelineModel().isInteractiveTimeEvent(e);\n        const isLayoutShift = this._performanceModel.timelineModel().isLayoutShiftEvent(e);\n        const skippableEvent = isInteractiveTime || isLayoutShift;\n\n        if (track && track.type === TimelineModel.TimelineModel.TrackType.MainThread && skippableEvent) {\n          continue;\n        }\n      }\n\n      if (this._performanceModel && this._performanceModel.timelineModel().isLayoutShiftEvent(e)) {\n        // Expand layout shift events to the size of the frame in which it is situated.\n        for (const frame of this._performanceModel.frames()) {\n          // Locate the correct frame and expand the event accordingly.\n          if (typeof e.endTime === 'undefined') {\n            e.setEndTime(e.startTime);\n          }\n\n          const isAfterStartTime = e.startTime >= frame.startTime;\n          const isBeforeEndTime = e.endTime && e.endTime <= frame.endTime;\n          const eventIsInFrame = isAfterStartTime && isBeforeEndTime;\n\n          if (!eventIsInFrame) {\n            continue;\n          }\n\n          e.startTime = frame.startTime;\n          e.setEndTime(frame.endTime);\n        }\n      }\n\n      if (!isExtension && this._performanceModel.timelineModel().isMarkerEvent(e)) {\n        this._markers.push(new TimelineFlameChartMarker(\n            e.startTime, e.startTime - this._model.minimumRecordTime(), TimelineUIUtils.markerStyleForEvent(e)));\n      }\n      if (!SDK.TracingModel.TracingModel.isFlowPhase(e.phase)) {\n        if (!e.endTime && e.phase !== SDK.TracingModel.Phase.Instant) {\n          continue;\n        }\n        if (SDK.TracingModel.TracingModel.isAsyncPhase(e.phase)) {\n          continue;\n        }\n        if (!isExtension && !this._performanceModel.isVisible(e)) {\n          continue;\n        }\n      }\n      while (openEvents.length &&\n             // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration\n             // @ts-expect-error\n             ((openEvents[openEvents.length - 1] as SDK.TracingModel.Event).endTime) <= e.startTime) {\n        openEvents.pop();\n      }\n      eventToDisallowRoot.set(e, false);\n      if (ignoreListingEnabled && this._isIgnoreListedEvent(e)) {\n        const parent = openEvents[openEvents.length - 1];\n        if (parent && eventToDisallowRoot.get(parent)) {\n          continue;\n        }\n        eventToDisallowRoot.set(e, true);\n      }\n      if (!group && title) {\n        group = this._appendHeader(title, (style as PerfUI.FlameChart.GroupStyle), selectable);\n        if (selectable) {\n          group.track = track;\n        }\n      }\n\n      const level = this._currentLevel + openEvents.length;\n      const index = this._appendEvent(e, level);\n      if (openEvents.length) {\n        this._entryParent[index] = (openEvents[openEvents.length - 1] as SDK.TracingModel.Event);\n      }\n      if (!isExtension && this._performanceModel.timelineModel().isMarkerEvent(e)) {\n        // @ts-ignore This is invalid code, but we should keep it for now\n        this._timelineData.entryTotalTimes[this._entryData.length] = undefined;\n      }\n\n      maxStackDepth = Math.max(maxStackDepth, openEvents.length + 1);\n      if (e.endTime) {\n        openEvents.push(e);\n      }\n    }\n    this._entryTypeByLevel.length = this._currentLevel + maxStackDepth;\n    this._entryTypeByLevel.fill(entryType, this._currentLevel);\n    this._currentLevel += maxStackDepth;\n    return group;\n  }\n\n  _isIgnoreListedEvent(event: SDK.TracingModel.Event): boolean {\n    if (event.name !== TimelineModel.TimelineModel.RecordType.JSFrame) {\n      return false;\n    }\n    const url = event.args['data']['url'];\n    return url && this._isIgnoreListedURL(url);\n  }\n\n  _isIgnoreListedURL(url: string): boolean {\n    return Bindings.IgnoreListManager.IgnoreListManager.instance().isIgnoreListedURL(url);\n  }\n\n  _appendAsyncEventsGroup(\n      track: TimelineModel.TimelineModel.Track|null, title: string|null, events: SDK.TracingModel.AsyncEvent[],\n      style: PerfUI.FlameChart.GroupStyle|null, entryType: EntryType, selectable: boolean): PerfUI.FlameChart.Group\n      |null {\n    if (!events.length) {\n      return null;\n    }\n    const lastUsedTimeByLevel: number[] = [];\n    let group: PerfUI.FlameChart.Group|null = null;\n    for (let i = 0; i < events.length; ++i) {\n      const asyncEvent = events[i];\n      if (!this._performanceModel || !this._performanceModel.isVisible(asyncEvent)) {\n        continue;\n      }\n      if (!group && title) {\n        group = this._appendHeader(title, (style as PerfUI.FlameChart.GroupStyle), selectable);\n        if (selectable) {\n          group.track = track;\n        }\n      }\n      const startTime = asyncEvent.startTime;\n      let level;\n      for (level = 0; level < lastUsedTimeByLevel.length && lastUsedTimeByLevel[level] > startTime; ++level) {\n      }\n      this._appendAsyncEvent(asyncEvent, this._currentLevel + level);\n      lastUsedTimeByLevel[level] = (asyncEvent.endTime as number);\n    }\n    this._entryTypeByLevel.length = this._currentLevel + lastUsedTimeByLevel.length;\n    this._entryTypeByLevel.fill(entryType, this._currentLevel);\n    this._currentLevel += lastUsedTimeByLevel.length;\n    return group;\n  }\n\n  _appendInteractionRecords(): void {\n    if (!this._performanceModel) {\n      return;\n    }\n    const interactionRecords = this._performanceModel.interactionRecords();\n    if (!interactionRecords.length) {\n      return;\n    }\n    this._appendHeader(i18nString(UIStrings.interactions), this._interactionsHeaderLevel1, false /* selectable */);\n    for (const segment of interactionRecords) {\n      const index = this._entryData.length;\n      this._entryData.push((segment.data as TimelineModel.TimelineIRModel.Phases));\n      this._entryIndexToTitle[index] = (segment.data as string);\n      if (this._timelineData) {\n        this._timelineData.entryLevels[index] = this._currentLevel;\n        this._timelineData.entryTotalTimes[index] = segment.end - segment.begin;\n        this._timelineData.entryStartTimes[index] = segment.begin;\n      }\n    }\n    this._entryTypeByLevel[this._currentLevel++] = EntryType.InteractionRecord;\n  }\n\n  _appendPageMetrics(): void {\n    this._entryTypeByLevel[this._currentLevel] = EntryType.Event;\n\n    if (!this._performanceModel || !this._model) {\n      return;\n    }\n\n    const metricEvents: SDK.TracingModel.Event[] = [];\n    const lcpEvents = [];\n    const timelineModel = this._performanceModel.timelineModel();\n    for (const track of this._model.tracks()) {\n      for (const event of track.events) {\n        if (!timelineModel.isMarkerEvent(event)) {\n          continue;\n        }\n        if (timelineModel.isLCPCandidateEvent(event) || timelineModel.isLCPInvalidateEvent(event)) {\n          lcpEvents.push(event);\n        } else {\n          metricEvents.push(event);\n        }\n      }\n    }\n\n    // Only the LCP event with the largest candidate index is relevant.\n    // Do not record an LCP event if it is an invalidate event.\n    if (lcpEvents.length > 0) {\n      const lcpEventsByNavigationId = new Map<string, SDK.TracingModel.Event>();\n      for (const e of lcpEvents) {\n        const key = e.args['data']['navigationId'];\n        const previousLastEvent = lcpEventsByNavigationId.get(key);\n\n        if (!previousLastEvent || previousLastEvent.args['data']['candidateIndex'] < e.args['data']['candidateIndex']) {\n          lcpEventsByNavigationId.set(key, e);\n        }\n      }\n\n      const latestCandidates = Array.from(lcpEventsByNavigationId.values());\n      const latestEvents = latestCandidates.filter(e => timelineModel.isLCPCandidateEvent(e));\n\n      metricEvents.push(...latestEvents);\n    }\n\n    metricEvents.sort(SDK.TracingModel.Event.compareStartTime);\n    if (this._timelineData) {\n      const totalTimes = this._timelineData.entryTotalTimes;\n      for (const event of metricEvents) {\n        this._appendEvent(event, this._currentLevel);\n        totalTimes[totalTimes.length - 1] = Number.NaN;\n      }\n    }\n\n    ++this._currentLevel;\n  }\n\n  /**\n   * This function pushes a copy of each performance.mark() event from the Main track\n   * into Timings so they can be appended to the performance UI.\n   * Performance.mark() are a part of the \"blink.user_timing\" category alongside\n   * Navigation and Resource Timing events, so we must filter them out before pushing.\n   */\n  _copyPerfMarkEvents(timingTrack: TimelineModel.TimelineModel.Track|null): void {\n    this._entryTypeByLevel[this._currentLevel] = EntryType.Event;\n    if (!this._performanceModel || !this._model || !timingTrack) {\n      return;\n    }\n    const timelineModel = this._performanceModel.timelineModel();\n    const ResourceTimingNames = [\n      'workerStart',\n      'redirectStart',\n      'redirectEnd',\n      'fetchStart',\n      'domainLookupStart',\n      'domainLookupEnd',\n      'connectStart',\n      'connectEnd',\n      'secureConnectionStart',\n      'requestStart',\n      'responseStart',\n      'responseEnd',\n    ];\n    const NavTimingNames = [\n      'navigationStart',\n      'unloadEventStart',\n      'unloadEventEnd',\n      'redirectStart',\n      'redirectEnd',\n      'fetchStart',\n      'domainLookupStart',\n      'domainLookupEnd',\n      'connectStart',\n      'connectEnd',\n      'secureConnectionStart',\n      'requestStart',\n      'responseStart',\n      'responseEnd',\n      'domLoading',\n      'domInteractive',\n      'domContentLoadedEventStart',\n      'domContentLoadedEventEnd',\n      'domComplete',\n      'loadEventStart',\n      'loadEventEnd',\n    ];\n    const IgnoreNames = [...ResourceTimingNames, ...NavTimingNames];\n    for (const track of this._model.tracks()) {\n      if (track.type === TimelineModel.TimelineModel.TrackType.MainThread) {\n        for (const event of track.events) {\n          if (timelineModel.isUserTimingEvent(event)) {\n            if (IgnoreNames.includes(event.name)) {\n              continue;\n            }\n            if (SDK.TracingModel.TracingModel.isAsyncPhase(event.phase)) {\n              continue;\n            }\n            event.setEndTime(event.startTime);\n            timingTrack.events.push(event);\n          }\n        }\n      }\n    }\n\n    ++this._currentLevel;\n  }\n\n  _appendFrames(): void {\n    if (!this._performanceModel || !this._timelineData || !this._model) {\n      return;\n    }\n    const screenshots = this._performanceModel.filmStripModel().frames();\n    const hasFilmStrip = Boolean(screenshots.length);\n    this._framesHeader.collapsible = hasFilmStrip;\n    this._appendHeader(i18nString(UIStrings.frames), this._framesHeader, false /* selectable */);\n    this._frameGroup = this._timelineData.groups[this._timelineData.groups.length - 1];\n    const style = TimelineUIUtils.markerStyleForFrame();\n\n    this._entryTypeByLevel[this._currentLevel] = EntryType.Frame;\n    for (const frame of this._performanceModel.frames()) {\n      this._markers.push(\n          new TimelineFlameChartMarker(frame.startTime, frame.startTime - this._model.minimumRecordTime(), style));\n      this._appendFrame(frame);\n    }\n    ++this._currentLevel;\n\n    if (!hasFilmStrip) {\n      return;\n    }\n    this._appendHeader('', this._screenshotsHeader, false /* selectable */);\n    this._entryTypeByLevel[this._currentLevel] = EntryType.Screenshot;\n    let prevTimestamp: number|undefined;\n    for (const screenshot of screenshots) {\n      this._entryData.push(screenshot);\n      (this._timelineData.entryLevels as number[]).push(this._currentLevel);\n      (this._timelineData.entryStartTimes as number[]).push(screenshot.timestamp);\n      if (prevTimestamp) {\n        (this._timelineData.entryTotalTimes as number[]).push(screenshot.timestamp - prevTimestamp);\n      }\n      prevTimestamp = screenshot.timestamp;\n    }\n    if (screenshots.length && prevTimestamp !== undefined) {\n      (this._timelineData.entryTotalTimes as number[]).push(this._model.maximumRecordTime() - prevTimestamp);\n    }\n    ++this._currentLevel;\n  }\n\n  _entryType(entryIndex: number): EntryType {\n    return this._entryTypeByLevel[/** @type {!PerfUI.FlameChart.TimelineData} */ (\n                                      this._timelineData as PerfUI.FlameChart.TimelineData)\n                                      .entryLevels[entryIndex]];\n  }\n\n  prepareHighlightedEntryInfo(entryIndex: number): Element|null {\n    let time = '';\n    let title;\n    let warning;\n    let nameSpanTimelineInfoTime = 'timeline-info-time';\n\n    const type = this._entryType(entryIndex);\n    if (type === EntryType.Event) {\n      const event = (this._entryData[entryIndex] as SDK.TracingModel.Event);\n      const totalTime = event.duration;\n      const selfTime = event.selfTime;\n      const eps = 1e-6;\n      if (typeof totalTime === 'number') {\n        time = Math.abs(totalTime - selfTime) > eps && selfTime > eps ?\n            i18nString(\n                UIStrings.sSelfS,\n                {PH1: i18n.i18n.millisToString(totalTime, true), PH2: i18n.i18n.millisToString(selfTime, true)}) :\n            i18n.i18n.millisToString(totalTime, true);\n      }\n      if (this._performanceModel && this._performanceModel.timelineModel().isMarkerEvent(event)) {\n        title = TimelineUIUtils.eventTitle(event);\n      } else {\n        title = this.entryTitle(entryIndex);\n      }\n      warning = TimelineUIUtils.eventWarning(event);\n\n      if (this._model && this._model.isLayoutShiftEvent(event)) {\n        // TODO: Update this to be dynamic when the trace data supports it.\n        const occurrences = 1;\n        time = i18nString(UIStrings.occurrencesS, {PH1: occurrences});\n      }\n\n      if (this._model && this._model.isParseHTMLEvent(event)) {\n        const startLine = event.args['beginData']['startLine'];\n        const endLine = event.args['endData'] && event.args['endData']['endLine'];\n        const url = Bindings.ResourceUtils.displayNameForURL(event.args['beginData']['url']);\n        const range = (endLine !== -1 || endLine === startLine) ? `${startLine}...${endLine}` : startLine;\n        title += ` - ${url} [${range}]`;\n      }\n\n    } else if (type === EntryType.Frame) {\n      const frame = (this._entryData[entryIndex] as TimelineModel.TimelineFrameModel.TimelineFrame);\n      time = i18nString(\n          UIStrings.sFfps,\n          {PH1: i18n.i18n.preciseMillisToString(frame.duration, 1), PH2: (1000 / frame.duration).toFixed(0)});\n\n      if (frame.idle) {\n        title = i18nString(UIStrings.idleFrame);\n      } else if (frame.dropped) {\n        title = i18nString(UIStrings.droppedFrame);\n        nameSpanTimelineInfoTime = 'timeline-info-warning';\n      } else {\n        title = i18nString(UIStrings.frame);\n      }\n\n      if (frame.hasWarnings()) {\n        warning = document.createElement('span');\n        warning.textContent = i18nString(UIStrings.longFrame);\n      }\n    } else {\n      return null;\n    }\n\n    const element = document.createElement('div');\n    const root = UI.Utils.createShadowRootWithCoreStyles(element, {\n      cssFile: 'panels/timeline/timelineFlamechartPopover.css',\n      enableLegacyPatching: false,\n      delegatesFocus: undefined,\n    });\n    const contents = root.createChild('div', 'timeline-flamechart-popover');\n    contents.createChild('span', nameSpanTimelineInfoTime).textContent = time;\n    contents.createChild('span', 'timeline-info-title').textContent = title;\n    if (warning) {\n      warning.classList.add('timeline-info-warning');\n      contents.appendChild(warning);\n    }\n    return element;\n  }\n\n  entryColor(entryIndex: number): string {\n    function patchColorAndCache<KEY>(cache: Map<KEY, string>, key: KEY, lookupColor: (arg0: KEY) => string): string {\n      let color = cache.get(key);\n      if (color) {\n        return color;\n      }\n      const parsedColor = Common.Color.Color.parse(lookupColor(key));\n      if (!parsedColor) {\n        throw new Error('Could not parse color from entry');\n      }\n      color = parsedColor.setAlpha(0.7).asString(Common.Color.Format.RGBA) || '';\n      cache.set(key, color);\n      return color;\n    }\n\n    if (!this._performanceModel || !this._model) {\n      return '';\n    }\n\n    const entryTypes = EntryType;\n    const type = this._entryType(entryIndex);\n    if (type === entryTypes.Event) {\n      const event = (this._entryData[entryIndex] as SDK.TracingModel.Event);\n      if (this._model.isGenericTrace()) {\n        return this._genericTraceEventColor(event);\n      }\n      if (this._performanceModel.timelineModel().isMarkerEvent(event)) {\n        return TimelineUIUtils.markerStyleForEvent(event).color;\n      }\n      if (!SDK.TracingModel.TracingModel.isAsyncPhase(event.phase) && this._colorForEvent) {\n        return this._colorForEvent(event);\n      }\n      if (event.hasCategory(TimelineModel.TimelineModel.TimelineModelImpl.Category.Console) ||\n          event.hasCategory(TimelineModel.TimelineModel.TimelineModelImpl.Category.UserTiming)) {\n        return this._consoleColorGenerator.colorForID(event.name);\n      }\n      if (event.hasCategory(TimelineModel.TimelineModel.TimelineModelImpl.Category.LatencyInfo)) {\n        const phase = TimelineModel.TimelineIRModel.TimelineIRModel.phaseForEvent(event) ||\n            TimelineModel.TimelineIRModel.Phases.Uncategorized;\n        return patchColorAndCache(this._asyncColorByInteractionPhase, phase, TimelineUIUtils.interactionPhaseColor);\n      }\n      const category = TimelineUIUtils.eventStyle(event).category;\n      return patchColorAndCache(this._asyncColorByCategory, category, () => category.color);\n    }\n    if (type === entryTypes.Frame) {\n      return 'white';\n    }\n    if (type === entryTypes.InteractionRecord) {\n      return 'transparent';\n    }\n    if (type === entryTypes.ExtensionEvent) {\n      const event = (this._entryData[entryIndex] as SDK.TracingModel.Event);\n      return this._extensionColorGenerator.colorForID(event.name);\n    }\n    return '';\n  }\n\n  _genericTraceEventColor(event: SDK.TracingModel.Event): string {\n    const key = event.categoriesString || event.name;\n    return key ? `hsl(${Platform.StringUtilities.hashCode(key) % 300 + 30}, 40%, 70%)` : '#ccc';\n  }\n\n  _drawFrame(\n      entryIndex: number, context: CanvasRenderingContext2D, text: string|null, barX: number, barY: number,\n      barWidth: number, barHeight: number): void {\n    const hPadding = 1;\n    const frame = (this._entryData[entryIndex] as TimelineModel.TimelineFrameModel.TimelineFrame);\n    barX += hPadding;\n    barWidth -= 2 * hPadding;\n    context.fillStyle =\n        frame.idle ? 'white' : frame.dropped ? '#f0b7b1' : (frame.hasWarnings() ? '#fad1d1' : '#d7f0d1');\n    context.fillRect(barX, barY, barWidth, barHeight);\n\n    const frameDurationText = i18n.i18n.preciseMillisToString(frame.duration, 1);\n    const textWidth = context.measureText(frameDurationText).width;\n    if (textWidth <= barWidth) {\n      context.fillStyle = this.textColor(entryIndex);\n      context.fillText(frameDurationText, barX + (barWidth - textWidth) / 2, barY + barHeight - 4);\n    }\n  }\n\n  async _drawScreenshot(\n      entryIndex: number, context: CanvasRenderingContext2D, barX: number, barY: number, barWidth: number,\n      barHeight: number): Promise<void> {\n    const screenshot = (this._entryData[entryIndex] as SDK.FilmStripModel.Frame);\n    if (!this._screenshotImageCache.has(screenshot)) {\n      this._screenshotImageCache.set(screenshot, null);\n      const data = await screenshot.imageDataPromise();\n      const image = await UI.UIUtils.loadImageFromData(data);\n      this._screenshotImageCache.set(screenshot, image);\n      this.dispatchEventToListeners(Events.DataChanged);\n      return;\n    }\n\n    const image = this._screenshotImageCache.get(screenshot);\n    if (!image) {\n      return;\n    }\n    const imageX = barX + 1;\n    const imageY = barY + 1;\n    const imageHeight = barHeight - 2;\n    const scale = imageHeight / image.naturalHeight;\n    const imageWidth = Math.floor(image.naturalWidth * scale);\n    context.save();\n    context.beginPath();\n    context.rect(barX, barY, barWidth, barHeight);\n    context.clip();\n    context.drawImage(image, imageX, imageY, imageWidth, imageHeight);\n    context.strokeStyle = '#ccc';\n    context.strokeRect(imageX - 0.5, imageY - 0.5, Math.min(barWidth - 1, imageWidth + 1), imageHeight);\n    context.restore();\n  }\n\n  decorateEntry(\n      entryIndex: number, context: CanvasRenderingContext2D, text: string|null, barX: number, barY: number,\n      barWidth: number, barHeight: number, unclippedBarX: number, timeToPixels: number): boolean {\n    const data = this._entryData[entryIndex];\n    const type = this._entryType(entryIndex);\n    const entryTypes = EntryType;\n\n    if (type === entryTypes.Frame) {\n      this._drawFrame(entryIndex, context, text, barX, barY, barWidth, barHeight);\n      return true;\n    }\n\n    if (type === entryTypes.Screenshot) {\n      this._drawScreenshot(entryIndex, context, barX, barY, barWidth, barHeight);\n      return true;\n    }\n\n    if (type === entryTypes.InteractionRecord) {\n      const color = TimelineUIUtils.interactionPhaseColor((data as TimelineModel.TimelineIRModel.Phases));\n      context.fillStyle = color;\n      context.fillRect(barX, barY, barWidth - 1, 2);\n      context.fillRect(barX, barY - 3, 2, 3);\n      context.fillRect(barX + barWidth - 3, barY - 3, 2, 3);\n      return false;\n    }\n\n    if (type === entryTypes.Event) {\n      const event = (data as SDK.TracingModel.Event);\n      if (event.hasCategory(TimelineModel.TimelineModel.TimelineModelImpl.Category.LatencyInfo)) {\n        const timeWaitingForMainThread =\n            TimelineModel.TimelineModel.TimelineData.forEvent(event).timeWaitingForMainThread;\n        if (timeWaitingForMainThread) {\n          context.fillStyle = 'hsla(0, 70%, 60%, 1)';\n          const width = Math.floor(unclippedBarX - barX + timeWaitingForMainThread * timeToPixels);\n          context.fillRect(barX, barY + barHeight - 3, width, 2);\n        }\n      }\n      if (TimelineModel.TimelineModel.TimelineData.forEvent(event).warning) {\n        paintWarningDecoration(barX, barWidth - 1.5);\n      }\n    }\n\n    function paintWarningDecoration(x: number, width: number): void {\n      const /** @const */ triangleSize = 8;\n      context.save();\n      context.beginPath();\n      context.rect(x, barY, width, barHeight);\n      context.clip();\n      context.beginPath();\n      context.fillStyle = 'red';\n      context.moveTo(x + width - triangleSize, barY);\n      context.lineTo(x + width, barY);\n      context.lineTo(x + width, barY + triangleSize);\n      context.fill();\n      context.restore();\n    }\n\n    return false;\n  }\n\n  forceDecoration(entryIndex: number): boolean {\n    const entryTypes = EntryType;\n    const type = this._entryType(entryIndex);\n    if (type === entryTypes.Frame) {\n      return true;\n    }\n    if (type === entryTypes.Screenshot) {\n      return true;\n    }\n\n    if (type === entryTypes.Event) {\n      const event = (this._entryData[entryIndex] as SDK.TracingModel.Event);\n      return Boolean(TimelineModel.TimelineModel.TimelineData.forEvent(event).warning);\n    }\n    return false;\n  }\n\n  appendExtensionEvents(entry: {\n    title: string,\n    model: SDK.TracingModel.TracingModel,\n  }): void {\n    this._extensionInfo.push(entry);\n    if (this._timelineData) {\n      this._innerAppendExtensionEvents(this._extensionInfo.length - 1);\n    }\n  }\n\n  _innerAppendExtensionEvents(index: number): void {\n    const entry = this._extensionInfo[index];\n    const entryType = EntryType.ExtensionEvent;\n    const allThreads = [...entry.model.sortedProcesses().map(process => process.sortedThreads())].flat();\n    if (!allThreads.length) {\n      return;\n    }\n\n    const singleTrack =\n        allThreads.length === 1 && (!allThreads[0].events().length || !allThreads[0].asyncEvents().length);\n    if (!singleTrack) {\n      this._appendHeader(entry.title, this._headerLevel1, false /* selectable */);\n    }\n    const style = singleTrack ? this._headerLevel2 : this._headerLevel1;\n    let threadIndex = 0;\n    for (const thread of allThreads) {\n      const title = singleTrack ? entry.title : thread.name() || i18nString(UIStrings.threadS, {PH1: ++threadIndex});\n      this._appendAsyncEventsGroup(null, title, thread.asyncEvents(), style, entryType, false /* selectable */);\n      this._appendSyncEvents(null, thread.events(), title, style, entryType, false /* selectable */);\n    }\n  }\n\n  _appendHeader(title: string, style: PerfUI.FlameChart.GroupStyle, selectable: boolean): PerfUI.FlameChart.Group {\n    const group =\n        ({startLevel: this._currentLevel, name: title, style: style, selectable: selectable} as\n         PerfUI.FlameChart.Group);\n    (this._timelineData as PerfUI.FlameChart.TimelineData).groups.push(group);\n    return group;\n  }\n\n  _appendEvent(event: SDK.TracingModel.Event, level: number): number {\n    const index = this._entryData.length;\n    this._entryData.push(event);\n    const timelineData = (this._timelineData as PerfUI.FlameChart.TimelineData);\n    timelineData.entryLevels[index] = level;\n    timelineData.entryTotalTimes[index] = event.duration || InstantEventVisibleDurationMs;\n    timelineData.entryStartTimes[index] = event.startTime;\n    indexForEvent.set(event, index);\n    return index;\n  }\n\n  _appendAsyncEvent(asyncEvent: SDK.TracingModel.AsyncEvent, level: number): void {\n    if (SDK.TracingModel.TracingModel.isNestableAsyncPhase(asyncEvent.phase)) {\n      // FIXME: also add steps once we support event nesting in the FlameChart.\n      this._appendEvent(asyncEvent, level);\n      return;\n    }\n    const steps = asyncEvent.steps;\n    // If we have past steps, put the end event for each range rather than start one.\n    const eventOffset = steps.length > 1 && steps[1].phase === SDK.TracingModel.Phase.AsyncStepPast ? 1 : 0;\n    for (let i = 0; i < steps.length - 1; ++i) {\n      const index = this._entryData.length;\n      this._entryData.push(steps[i + eventOffset]);\n      const startTime = steps[i].startTime;\n      const timelineData = (this._timelineData as PerfUI.FlameChart.TimelineData);\n      timelineData.entryLevels[index] = level;\n      timelineData.entryTotalTimes[index] = steps[i + 1].startTime - startTime;\n      timelineData.entryStartTimes[index] = startTime;\n    }\n  }\n\n  _appendFrame(frame: TimelineModel.TimelineFrameModel.TimelineFrame): void {\n    const index = this._entryData.length;\n    this._entryData.push(frame);\n    this._entryIndexToTitle[index] = i18n.i18n.millisToString(frame.duration, true);\n    if (!this._timelineData) {\n      return;\n    }\n    this._timelineData.entryLevels[index] = this._currentLevel;\n    this._timelineData.entryTotalTimes[index] = frame.duration;\n    this._timelineData.entryStartTimes[index] = frame.startTime;\n  }\n\n  createSelection(entryIndex: number): TimelineSelection|null {\n    const type = this._entryType(entryIndex);\n    let timelineSelection: TimelineSelection|null = null;\n    if (type === EntryType.Event) {\n      timelineSelection = TimelineSelection.fromTraceEvent((this._entryData[entryIndex] as SDK.TracingModel.Event));\n    } else if (type === EntryType.Frame) {\n      timelineSelection =\n          TimelineSelection.fromFrame((this._entryData[entryIndex] as TimelineModel.TimelineFrameModel.TimelineFrame));\n    }\n    if (timelineSelection) {\n      this._lastSelection = new Selection(timelineSelection, entryIndex);\n    }\n    return timelineSelection;\n  }\n\n  formatValue(value: number, precision?: number): string {\n    return i18n.i18n.preciseMillisToString(value, precision);\n  }\n\n  canJumpToEntry(_entryIndex: number): boolean {\n    return false;\n  }\n\n  entryIndexForSelection(selection: TimelineSelection|null): number {\n    if (!selection || selection.type() === TimelineSelection.Type.Range) {\n      return -1;\n    }\n\n    if (this._lastSelection && this._lastSelection.timelineSelection.object() === selection.object()) {\n      return this._lastSelection.entryIndex;\n    }\n    const index = this._entryData.indexOf(\n        (selection.object() as SDK.TracingModel.Event | TimelineModel.TimelineIRModel.Phases |\n         TimelineModel.TimelineFrameModel.TimelineFrame));\n    if (index !== -1) {\n      this._lastSelection = new Selection(selection, index);\n    }\n    return index;\n  }\n\n  buildFlowForInitiator(entryIndex: number): boolean {\n    if (this._lastInitiatorEntry === entryIndex) {\n      return false;\n    }\n    this._lastInitiatorEntry = entryIndex;\n    let event = this.eventByIndex(entryIndex);\n    const td = this._timelineData;\n    if (!td) {\n      return false;\n    }\n    td.flowStartTimes = [];\n    td.flowStartLevels = [];\n    td.flowEndTimes = [];\n    td.flowEndLevels = [];\n    while (event) {\n      // Find the closest ancestor with an initiator.\n      let initiator;\n      for (; event; event = this._eventParent(event)) {\n        initiator = TimelineModel.TimelineModel.TimelineData.forEvent(event).initiator();\n        if (initiator) {\n          break;\n        }\n      }\n      if (!initiator || !event) {\n        break;\n      }\n      const eventIndex = (indexForEvent.get(event) as number);\n      const initiatorIndex = (indexForEvent.get(initiator) as number);\n      td.flowStartTimes.push(initiator.endTime || initiator.startTime);\n      td.flowStartLevels.push(td.entryLevels[initiatorIndex]);\n      td.flowEndTimes.push(event.startTime);\n      td.flowEndLevels.push(td.entryLevels[eventIndex]);\n      event = initiator;\n    }\n    return true;\n  }\n\n  _eventParent(event: SDK.TracingModel.Event): SDK.TracingModel.Event|null {\n    const eventIndex = indexForEvent.get(event);\n    if (eventIndex === undefined) {\n      return null;\n    }\n    return this._entryParent[eventIndex] || null;\n  }\n\n  eventByIndex(entryIndex: number): SDK.TracingModel.Event|null {\n    return entryIndex >= 0 && this._entryType(entryIndex) === EntryType.Event ?\n        this._entryData[entryIndex] as SDK.TracingModel.Event :\n        null;\n  }\n\n  setEventColorMapping(colorForEvent: (arg0: SDK.TracingModel.Event) => string): void {\n    this._colorForEvent = colorForEvent;\n  }\n}\n\nexport const InstantEventVisibleDurationMs = 0.001;\n\nconst eventToDisallowRoot = new WeakMap<SDK.TracingModel.Event, boolean>();\nconst indexForEvent = new WeakMap<SDK.TracingModel.Event, number>();\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  DataChanged = 'DataChanged',\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum EntryType {\n  Frame = 'Frame',\n  Event = 'Event',\n  InteractionRecord = 'InteractionRecord',\n  ExtensionEvent = 'ExtensionEvent',\n  Screenshot = 'Screenshot',\n}\n"]}