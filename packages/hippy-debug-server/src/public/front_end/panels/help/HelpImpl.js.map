{"version":3,"file":"HelpImpl.js","sourceRoot":"","sources":["../../../../../../front_end/panels/help/HelpImpl.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2017 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as UI from '../../ui/legacy/legacy.js';  // eslint-disable-line no-unused-vars\n\nimport {releaseNoteText} from './ReleaseNoteText.js';\n\nexport const releaseVersionSeen = 'releaseNoteVersionSeen';\n\nexport const releaseNoteViewId: string = 'release-note';\n\nlet latestReleaseNoteInstance: ReleaseNote;\n\nlet releaseNotesForTest: ReleaseNote[];\n\nlet releaseNoteVersionSetting: Common.Settings.Setting<number>;\n\nexport function latestReleaseNote(): ReleaseNote {\n  if (!latestReleaseNoteInstance) {\n    latestReleaseNoteInstance =\n        (releaseNotesForTest || releaseNoteText).reduce((acc, note) => note.version > acc.version ? note : acc);\n  }\n  return latestReleaseNoteInstance;\n}\n\nexport function showReleaseNoteIfNeeded(): void {\n  const releaseNoteVersionSetting = Common.Settings.Settings.instance().createSetting(releaseVersionSeen, 0);\n  const releaseNoteVersionSettingValue = releaseNoteVersionSetting.get();\n  innerShowReleaseNoteIfNeeded(\n      releaseNoteVersionSettingValue, latestReleaseNote().version,\n      Common.Settings.Settings.instance().moduleSetting('help.show-release-note').get());\n}\n\nexport function setReleaseNotesForTest(releaseNote: ReleaseNote[]): void {\n  releaseNotesForTest = releaseNote;\n}\n\nexport function getReleaseNoteVersionSetting(): Common.Settings.Setting<number> {\n  if (!releaseNoteVersionSetting) {\n    releaseNoteVersionSetting = Common.Settings.Settings.instance().createSetting(releaseVersionSeen, 0);\n  }\n  return releaseNoteVersionSetting;\n}\n\nexport function innerShowReleaseNoteIfNeeded(\n    lastSeenVersion: number, latestVersion: number, showReleaseNote: boolean): boolean {\n  const releaseNoteVersionSetting = Common.Settings.Settings.instance().createSetting(releaseVersionSeen, 0);\n  if (!lastSeenVersion) {\n    releaseNoteVersionSetting.set(latestVersion);\n    return false;\n  }\n  if (!showReleaseNote) {\n    return false;\n  }\n  if (lastSeenVersion >= latestVersion) {\n    return false;\n  }\n  releaseNoteVersionSetting.set(latestVersion);\n  UI.ViewManager.ViewManager.instance().showView(releaseNoteViewId, true);\n  return true;\n}\n\nlet helpLateInitializationInstance: HelpLateInitialization;\nexport class HelpLateInitialization implements Common.Runnable.Runnable {\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): HelpLateInitialization {\n    const {forceNew} = opts;\n    if (!helpLateInitializationInstance || forceNew) {\n      helpLateInitializationInstance = new HelpLateInitialization();\n    }\n    return helpLateInitializationInstance;\n  }\n\n  async run(): Promise<void> {\n    if (!Host.InspectorFrontendHost.isUnderTest()) {\n      showReleaseNoteIfNeeded();\n    }\n  }\n}\nCommon.Runnable.registerLateInitializationRunnable(HelpLateInitialization.instance);\n\nlet releaseNotesActionDelegateInstance: ReleaseNotesActionDelegate;\nexport class ReleaseNotesActionDelegate implements UI.ActionRegistration.ActionDelegate {\n  handleAction(_context: UI.Context.Context, _actionId: string): boolean {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(latestReleaseNote().link);\n    return true;\n  }\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): ReleaseNotesActionDelegate {\n    const {forceNew} = opts;\n    if (!releaseNotesActionDelegateInstance || forceNew) {\n      releaseNotesActionDelegateInstance = new ReleaseNotesActionDelegate();\n    }\n\n    return releaseNotesActionDelegateInstance;\n  }\n}\n\nlet reportIssueActionDelegateInstance: ReportIssueActionDelegate;\nexport class ReportIssueActionDelegate implements UI.ActionRegistration.ActionDelegate {\n  handleAction(_context: UI.Context.Context, _actionId: string): boolean {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(\n        'https://bugs.chromium.org/p/chromium/issues/entry?template=DevTools+issue');\n    return true;\n  }\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): ReportIssueActionDelegate {\n    const {forceNew} = opts;\n    if (!reportIssueActionDelegateInstance || forceNew) {\n      reportIssueActionDelegateInstance = new ReportIssueActionDelegate();\n    }\n\n    return reportIssueActionDelegateInstance;\n  }\n}\nexport interface ReleaseNoteHighlight {\n  title: string;\n  subtitle: string;\n  link: string;\n}\nexport interface ReleaseNote {\n  version: number;\n  header: string;\n  highlights: {title: string, subtitle: string, link: string}[];\n  link: string;\n}\n"]}