{"version":3,"file":"AnimationScreenshotPopover.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationScreenshotPopover.ts"],"names":[],"mappings":"AAAA,gEAAgE;AAChE,yEAAyE;AACzE,6BAA6B;AAE7B,uDAAuD;AAEvD,OAAO,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAEhD,MAAM,OAAO,0BAA2B,SAAQ,EAAE,CAAC,MAAM,CAAC,IAAI;IAC5D,OAAO,CAAqB;IAC5B,MAAM,CAAS;IACf,aAAa,CAAS;IACtB,YAAY,CAAc;IAC1B,UAAU,CAAW;IACrB,SAAS,CAAU;IACnB,YAAY,MAA0B;QACpC,KAAK,CAAC,IAAI,CAAC,CAAC;QACZ,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAClC,IAAI,CAAC,mBAAmB,CAAC,iDAAiD,EAAE,EAAC,oBAAoB,EAAE,KAAK,EAAC,CAAC,CAAC;QAC3G,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;QAClE,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;YAC1B,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YACvC,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;SAC9B;QACD,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;QAChB,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;QACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,EAAE,oBAAoB,CAAC,CAAC;IACnF,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACjG,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC/D,OAAO,IAAI,CAAC,SAAS,CAAC;IACxB,CAAC;IAED,YAAY;QACV,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAE/F,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,SAAS,EAAE,CAAC;YACjB,OAAO;SACR;QACD,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;QACnC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,OAAO;SACR;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;QACtC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,GAAG,SAAS,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;QACpE,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,SAAS,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;QACvE,IAAI,IAAI,CAAC,aAAa,GAAG,SAAS,KAAK,SAAS,GAAG,CAAC,EAAE;YACpD,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;SACrB;QACD,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,aAAa,GAAG,SAAS,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,GAAG,GAAG,GAAG,CAAC;IAC/F,CAAC;CACF","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as UI from '../../ui/legacy/legacy.js';\n\nexport class AnimationScreenshotPopover extends UI.Widget.VBox {\n  _frames: HTMLImageElement[];\n  _rafId: number;\n  _currentFrame: number;\n  _progressBar: HTMLElement;\n  _showFrame?: boolean;\n  _endDelay?: number;\n  constructor(images: HTMLImageElement[]) {\n    super(true);\n    console.assert(images.length > 0);\n    this.registerRequiredCSS('panels/animation/animationScreenshotPopover.css', {enableLegacyPatching: false});\n    this.contentElement.classList.add('animation-screenshot-popover');\n    this._frames = images;\n    for (const image of images) {\n      this.contentElement.appendChild(image);\n      image.style.display = 'none';\n    }\n    this._rafId = 0;\n    this._currentFrame = 0;\n    this._frames[0].style.display = 'block';\n    this._progressBar = this.contentElement.createChild('div', 'animation-progress');\n  }\n\n  wasShown(): void {\n    this._rafId = this.contentElement.window().requestAnimationFrame(this._changeFrame.bind(this));\n  }\n\n  willHide(): void {\n    this.contentElement.window().cancelAnimationFrame(this._rafId);\n    delete this._endDelay;\n  }\n\n  _changeFrame(): void {\n    this._rafId = this.contentElement.window().requestAnimationFrame(this._changeFrame.bind(this));\n\n    if (this._endDelay) {\n      this._endDelay--;\n      return;\n    }\n    this._showFrame = !this._showFrame;\n    if (!this._showFrame) {\n      return;\n    }\n\n    const numFrames = this._frames.length;\n    this._frames[this._currentFrame % numFrames].style.display = 'none';\n    this._currentFrame++;\n    this._frames[(this._currentFrame) % numFrames].style.display = 'block';\n    if (this._currentFrame % numFrames === numFrames - 1) {\n      this._endDelay = 50;\n    }\n    this._progressBar.style.width = (this._currentFrame % numFrames + 1) / numFrames * 100 + '%';\n  }\n}\n"]}