{"version":3,"file":"StylePropertyEditor.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/StylePropertyEditor.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\nimport type {IconInfo} from './CSSPropertyIconResolver.js';\nimport {findFlexContainerIcon, findGridContainerIcon} from './CSSPropertyIconResolver.js';\n\nconst UIStrings = {\n  /**\n    * @description Title of the button that selects a flex property.\n    * @example {flex-direction} propertyName\n    * @example {column} propertyValue\n    */\n  selectButton: 'Add {propertyName}: {propertyValue}',\n  /**\n    * @description Title of the button that deselects a flex property.\n    * @example {flex-direction} propertyName\n    * @example {row} propertyValue\n    */\n  deselectButton: 'Remove {propertyName}: {propertyValue}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/components/StylePropertyEditor.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst {render, html, Directives} = LitHtml;\n\ndeclare global {\n  interface HTMLElementEventMap {\n    'propertyselected': PropertySelectedEvent;\n    'propertydeselected': PropertyDeselectedEvent;\n  }\n}\n\ninterface FlexEditorData {\n  authoredProperties: Map<string, string>;\n  computedProperties: Map<string, string>;\n}\n\ninterface EditableProperty {\n  propertyName: string;\n  propertyValues: string[];\n}\n\nexport class PropertySelectedEvent extends Event {\n  data: {name: string, value: string};\n\n  constructor(name: string, value: string) {\n    super('propertyselected', {});\n    this.data = {name, value};\n  }\n}\n\nexport class PropertyDeselectedEvent extends Event {\n  data: {name: string, value: string};\n\n  constructor(name: string, value: string) {\n    super('propertydeselected', {});\n    this.data = {name, value};\n  }\n}\n\nexport class StylePropertyEditor extends HTMLElement {\n  private readonly shadow = this.attachShadow({mode: 'open'});\n  private authoredProperties: Map<string, string> = new Map();\n  private computedProperties: Map<string, string> = new Map();\n  protected readonly editableProperties: EditableProperty[] = [];\n\n  constructor() {\n    super();\n  }\n\n  getEditableProperties(): EditableProperty[] {\n    return this.editableProperties;\n  }\n\n  set data(data: FlexEditorData) {\n    this.authoredProperties = data.authoredProperties;\n    this.computedProperties = data.computedProperties;\n    this.render();\n  }\n\n  private render(): void {\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      <style>\n        .container {\n          padding: 12px;\n          min-width: 170px;\n        }\n\n        .row {\n          padding: 0;\n          color: var(--color-text-primary);\n          padding-bottom: 16px;\n        }\n\n        .row:last-child {\n          padding-bottom: 0;\n        }\n\n        .property {\n          padding-bottom: 4px;\n          white-space: nowrap;\n        }\n\n        .property-name {\n          color: var(--color-syntax-1);\n        }\n\n        .property-value {\n          color: var(--color-text-primary);\n        }\n\n        .property-value.not-authored {\n          color: var(--color-text-disabled);\n        }\n\n        .buttons {\n          display: flex;\n          flex-direction: row;\n        }\n\n        .buttons > :first-child {\n          border-radius: 3px 0 0 3px;\n        }\n\n        .buttons > :last-child {\n          border-radius: 0 3px 3px 0;\n        }\n\n        .button {\n          border: 1px solid var(--color-background-elevation-2);\n          background-color: var(--color-background);\n          width: 24px;\n          height: 24px;\n          min-width: 24px;\n          min-height: 24px;\n          padding: 0;\n          margin: 0;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          cursor: pointer;\n        }\n\n        .button:focus-visible {\n          outline: auto 5px -webkit-focus-ring-color;\n        }\n\n        .button devtools-icon {\n          --icon-color: var(--color-text-secondary);\n        }\n\n        .button.selected {\n          background-color: var(--color-background-elevation-1);\n        }\n\n        .button.selected devtools-icon {\n          --icon-color: var(--color-primary);\n        }\n      </style>\n      <div class=\"container\">\n        ${this.editableProperties.map(prop => this.renderProperty(prop))}\n      </div>\n    `, this.shadow, {\n      host: this,\n    });\n    // clang-format on\n  }\n\n  private renderProperty(prop: EditableProperty): LitHtml.TemplateResult {\n    const authoredValue = this.authoredProperties.get(prop.propertyName);\n    const notAuthored = !authoredValue;\n    const shownValue = authoredValue || this.computedProperties.get(prop.propertyName);\n    const classes = Directives.classMap({\n      'property-value': true,\n      'not-authored': notAuthored,\n    });\n    return html`<div class=\"row\">\n      <div class=\"property\">\n        <span class=\"property-name\">${prop.propertyName}</span>: <span class=${classes}>${shownValue}</span>\n      </div>\n      <div class=\"buttons\">\n        ${prop.propertyValues.map(value => this.renderButton(value, prop.propertyName, value === authoredValue))}\n      </div>\n    </div>`;\n  }\n\n  private renderButton(propertyValue: string, propertyName: string, selected: boolean = false): LitHtml.TemplateResult {\n    const query = `${propertyName}: ${propertyValue}`;\n    const iconInfo = this.findIcon(query, this.computedProperties);\n    if (!iconInfo) {\n      throw new Error(`Icon for ${query} is not found`);\n    }\n    const transform = `transform: rotate(${iconInfo.rotate}deg) scale(${iconInfo.scaleX}, ${iconInfo.scaleY})`;\n    const classes = Directives.classMap({\n      'button': true,\n      'selected': selected,\n    });\n    const title =\n        i18nString(selected ? UIStrings.deselectButton : UIStrings.selectButton, {propertyName, propertyValue});\n    return html`<button title=${title} class=${classes} @click=${\n        (): void => this.onButtonClick(propertyName, propertyValue, selected)}>\n       <${IconButton.Icon.Icon.litTagName} style=${transform} .data=${\n        {iconName: iconInfo.iconName, color: 'var(--icon-color)', width: '18px', height: '18px'} as\n        IconButton.Icon.IconWithName}></${IconButton.Icon.Icon.litTagName}>\n    </button>`;\n  }\n\n  private onButtonClick(propertyName: string, propertyValue: string, selected: boolean): void {\n    if (selected) {\n      this.dispatchEvent(new PropertyDeselectedEvent(propertyName, propertyValue));\n    } else {\n      this.dispatchEvent(new PropertySelectedEvent(propertyName, propertyValue));\n    }\n  }\n\n  protected findIcon(_query: string, _computedProperties: Map<string, string>): IconInfo|null {\n    throw new Error('Not implemented');\n  }\n}\n\nexport class FlexboxEditor extends StylePropertyEditor {\n  protected readonly editableProperties: EditableProperty[] = FlexboxEditableProperties;\n\n  protected findIcon(query: string, computedProperties: Map<string, string>): IconInfo|null {\n    return findFlexContainerIcon(query, computedProperties);\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-flexbox-editor', FlexboxEditor);\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interface HTMLElementTagNameMap {\n    'devtools-flexbox-editor': FlexboxEditor;\n  }\n}\n\nexport class GridEditor extends StylePropertyEditor {\n  protected readonly editableProperties: EditableProperty[] = GridEditableProperties;\n\n  protected findIcon(query: string, computedProperties: Map<string, string>): IconInfo|null {\n    return findGridContainerIcon(query, computedProperties);\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-grid-editor', GridEditor);\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interface HTMLElementTagNameMap {\n    'devtools-grid-editor': GridEditor;\n  }\n}\n\nexport const FlexboxEditableProperties = [\n  {\n    propertyName: 'flex-direction',\n    propertyValues: [\n      'row',\n      'column',\n    ],\n  },\n  {\n    propertyName: 'flex-wrap',\n    propertyValues: [\n      'nowrap',\n      'wrap',\n    ],\n  },\n  {\n    propertyName: 'align-content',\n    propertyValues: [\n      'center',\n      'flex-start',\n      'flex-end',\n      'space-around',\n      'space-between',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'justify-content',\n    propertyValues: [\n      'center',\n      'flex-start',\n      'flex-end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n    ],\n  },\n  {\n    propertyName: 'align-items',\n    propertyValues: [\n      'center',\n      'flex-start',\n      'flex-end',\n      'stretch',\n      'baseline',\n    ],\n  },\n];\n\nexport const GridEditableProperties = [\n  {\n    propertyName: 'align-content',\n    propertyValues: [\n      'center',\n      'space-between',\n      'space-around',\n      'space-evenly',\n      'stretch',\n    ],\n  },\n  {\n    propertyName: 'justify-content',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'space-between',\n      'space-around',\n      'space-evenly',\n    ],\n  },\n  {\n    propertyName: 'align-items',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'stretch',\n      'baseline',\n    ],\n  },\n  {\n    propertyName: 'justify-items',\n    propertyValues: [\n      'center',\n      'start',\n      'end',\n      'stretch',\n    ],\n  },\n];\n"]}