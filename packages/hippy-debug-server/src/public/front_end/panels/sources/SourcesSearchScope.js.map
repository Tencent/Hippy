{"version":3,"file":"SourcesSearchScope.js","sourceRoot":"","sources":["../../../../../../front_end/panels/sources/SourcesSearchScope.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2011 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as Common from '../../core/common/common.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport * as Persistence from '../../models/persistence/persistence.js';\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport type * as Search from '../search/search.js'; // eslint-disable-line no-unused-vars\n\nexport class SourcesSearchScope implements Search.SearchConfig.SearchScope {\n  _searchId: number;\n  _searchResultCandidates: Workspace.UISourceCode.UISourceCode[];\n  _searchResultCallback: ((arg0: Search.SearchConfig.SearchResult) => void)|null;\n  _searchFinishedCallback: ((arg0: boolean) => void)|null;\n  _searchConfig: Workspace.Workspace.ProjectSearchConfig|null;\n  constructor() {\n    // FIXME: Add title once it is used by search controller.\n    this._searchId = 0;\n    this._searchResultCandidates = [];\n    this._searchResultCallback = null;\n    this._searchFinishedCallback = null;\n    this._searchConfig = null;\n  }\n\n  static _filesComparator(\n      uiSourceCode1: Workspace.UISourceCode.UISourceCode, uiSourceCode2: Workspace.UISourceCode.UISourceCode): number {\n    if (uiSourceCode1.isDirty() && !uiSourceCode2.isDirty()) {\n      return -1;\n    }\n    if (!uiSourceCode1.isDirty() && uiSourceCode2.isDirty()) {\n      return 1;\n    }\n    const isFileSystem1 = uiSourceCode1.project().type() === Workspace.Workspace.projectTypes.FileSystem &&\n        !Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode1);\n    const isFileSystem2 = uiSourceCode2.project().type() === Workspace.Workspace.projectTypes.FileSystem &&\n        !Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode2);\n    if (isFileSystem1 !== isFileSystem2) {\n      return isFileSystem1 ? 1 : -1;\n    }\n    const url1 = uiSourceCode1.url();\n    const url2 = uiSourceCode2.url();\n    if (url1 && !url2) {\n      return -1;\n    }\n    if (!url1 && url2) {\n      return 1;\n    }\n    return Platform.StringUtilities.naturalOrderComparator(\n        uiSourceCode1.fullDisplayName(), uiSourceCode2.fullDisplayName());\n  }\n\n  performIndexing(progress: Common.Progress.Progress): void {\n    this.stopSearch();\n\n    const projects = this._projects();\n    const compositeProgress = new Common.Progress.CompositeProgress(progress);\n    for (let i = 0; i < projects.length; ++i) {\n      const project = projects[i];\n      const projectProgress = compositeProgress.createSubProgress(project.uiSourceCodes().length);\n      project.indexContent(projectProgress);\n    }\n  }\n\n  _projects(): Workspace.Workspace.Project[] {\n    const searchInAnonymousAndContentScripts =\n        Common.Settings.Settings.instance().moduleSetting('searchInAnonymousAndContentScripts').get();\n\n    return Workspace.Workspace.WorkspaceImpl.instance().projects().filter(project => {\n      if (project.type() === Workspace.Workspace.projectTypes.Service) {\n        return false;\n      }\n      if (!searchInAnonymousAndContentScripts && project.isServiceProject() &&\n          project.type() !== Workspace.Workspace.projectTypes.Formatter) {\n        return false;\n      }\n      if (!searchInAnonymousAndContentScripts && project.type() === Workspace.Workspace.projectTypes.ContentScripts) {\n        return false;\n      }\n      return true;\n    });\n  }\n\n  performSearch(\n      searchConfig: Workspace.Workspace.ProjectSearchConfig, progress: Common.Progress.Progress,\n      searchResultCallback: (arg0: Search.SearchConfig.SearchResult) => void,\n      searchFinishedCallback: (arg0: boolean) => void): void {\n    this.stopSearch();\n    this._searchResultCandidates = [];\n    this._searchResultCallback = searchResultCallback;\n    this._searchFinishedCallback = searchFinishedCallback;\n    this._searchConfig = searchConfig;\n\n    const promises = [];\n    const compositeProgress = new Common.Progress.CompositeProgress(progress);\n    const searchContentProgress = compositeProgress.createSubProgress();\n    const findMatchingFilesProgress = new Common.Progress.CompositeProgress(compositeProgress.createSubProgress());\n    for (const project of this._projects()) {\n      const weight = project.uiSourceCodes().length;\n      const findMatchingFilesInProjectProgress = findMatchingFilesProgress.createSubProgress(weight);\n      const filesMathingFileQuery = this._projectFilesMatchingFileQuery(project, searchConfig);\n      const promise =\n          project\n              .findFilesMatchingSearchRequest(searchConfig, filesMathingFileQuery, findMatchingFilesInProjectProgress)\n              .then(this._processMatchingFilesForProject.bind(\n                  this, this._searchId, project, searchConfig, filesMathingFileQuery));\n      promises.push(promise);\n    }\n\n    Promise.all(promises).then(this._processMatchingFiles.bind(\n        this, this._searchId, searchContentProgress, this._searchFinishedCallback.bind(this, true)));\n  }\n\n  _projectFilesMatchingFileQuery(\n      project: Workspace.Workspace.Project, searchConfig: Workspace.Workspace.ProjectSearchConfig,\n      dirtyOnly?: boolean): string[] {\n    const result = [];\n    const uiSourceCodes = project.uiSourceCodes();\n    for (let i = 0; i < uiSourceCodes.length; ++i) {\n      const uiSourceCode = uiSourceCodes[i];\n      if (!uiSourceCode.contentType().isTextType()) {\n        continue;\n      }\n      const binding = Persistence.Persistence.PersistenceImpl.instance().binding(uiSourceCode);\n      if (binding && binding.network === uiSourceCode) {\n        continue;\n      }\n      if (dirtyOnly && !uiSourceCode.isDirty()) {\n        continue;\n      }\n      if (searchConfig.filePathMatchesFileQuery(uiSourceCode.fullDisplayName())) {\n        result.push(uiSourceCode.url());\n      }\n    }\n    result.sort(Platform.StringUtilities.naturalOrderComparator);\n    return result;\n  }\n\n  _processMatchingFilesForProject(\n      searchId: number, project: Workspace.Workspace.Project, searchConfig: Workspace.Workspace.ProjectSearchConfig,\n      filesMathingFileQuery: string[], files: string[]): void {\n    if (searchId !== this._searchId && this._searchFinishedCallback) {\n      this._searchFinishedCallback(false);\n      return;\n    }\n\n    files.sort(Platform.StringUtilities.naturalOrderComparator);\n    files = Platform.ArrayUtilities.intersectOrdered(\n        files, filesMathingFileQuery, Platform.StringUtilities.naturalOrderComparator);\n    const dirtyFiles = this._projectFilesMatchingFileQuery(project, searchConfig, true);\n    files = Platform.ArrayUtilities.mergeOrdered(files, dirtyFiles, Platform.StringUtilities.naturalOrderComparator);\n\n    const uiSourceCodes = [];\n    for (const file of files) {\n      const uiSourceCode = project.uiSourceCodeForURL(file);\n      if (!uiSourceCode) {\n        continue;\n      }\n      const script = Bindings.DefaultScriptMapping.DefaultScriptMapping.scriptForUISourceCode(uiSourceCode);\n      if (script && !script.isAnonymousScript()) {\n        continue;\n      }\n      uiSourceCodes.push(uiSourceCode);\n    }\n    uiSourceCodes.sort(SourcesSearchScope._filesComparator);\n    this._searchResultCandidates = Platform.ArrayUtilities.mergeOrdered(\n        this._searchResultCandidates, uiSourceCodes, SourcesSearchScope._filesComparator);\n  }\n\n  _processMatchingFiles(searchId: number, progress: Common.Progress.Progress, callback: () => void): void {\n    if (searchId !== this._searchId && this._searchFinishedCallback) {\n      this._searchFinishedCallback(false);\n      return;\n    }\n\n    const files = this._searchResultCandidates;\n    if (!files.length) {\n      progress.done();\n      callback();\n      return;\n    }\n\n    progress.setTotalWork(files.length);\n\n    let fileIndex = 0;\n    const maxFileContentRequests = 20;\n    let callbacksLeft = 0;\n\n    for (let i = 0; i < maxFileContentRequests && i < files.length; ++i) {\n      scheduleSearchInNextFileOrFinish.call(this);\n    }\n\n    function searchInNextFile(this: SourcesSearchScope, uiSourceCode: Workspace.UISourceCode.UISourceCode): void {\n      if (uiSourceCode.isDirty()) {\n        contentLoaded.call(this, uiSourceCode, uiSourceCode.workingCopy());\n      } else {\n        uiSourceCode.requestContent().then(deferredContent => {\n          contentLoaded.call(this, uiSourceCode, deferredContent.content || '');\n        });\n      }\n    }\n\n    function scheduleSearchInNextFileOrFinish(this: SourcesSearchScope): void {\n      if (fileIndex >= files.length) {\n        if (!callbacksLeft) {\n          progress.done();\n          callback();\n          return;\n        }\n        return;\n      }\n\n      ++callbacksLeft;\n      const uiSourceCode = files[fileIndex++];\n      setTimeout(searchInNextFile.bind(this, uiSourceCode), 0);\n    }\n\n    function contentLoaded(\n        this: SourcesSearchScope, uiSourceCode: Workspace.UISourceCode.UISourceCode, content: string): void {\n      function matchesComparator(\n          a: TextUtils.ContentProvider.SearchMatch, b: TextUtils.ContentProvider.SearchMatch): number {\n        return a.lineNumber - b.lineNumber;\n      }\n\n      progress.worked(1);\n      let matches: TextUtils.ContentProvider.SearchMatch[] = [];\n      const searchConfig = (this._searchConfig as Workspace.Workspace.ProjectSearchConfig);\n      const queries = searchConfig.queries();\n      if (content !== null) {\n        for (let i = 0; i < queries.length; ++i) {\n          const nextMatches = TextUtils.TextUtils.performSearchInContent(\n              content, queries[i], !searchConfig.ignoreCase(), searchConfig.isRegex());\n          matches = Platform.ArrayUtilities.mergeOrdered(matches, nextMatches, matchesComparator);\n        }\n      }\n      if (matches && this._searchResultCallback) {\n        const searchResult = new FileBasedSearchResult(uiSourceCode, matches);\n        this._searchResultCallback(searchResult);\n      }\n\n      --callbacksLeft;\n      scheduleSearchInNextFileOrFinish.call(this);\n    }\n  }\n\n  stopSearch(): void {\n    ++this._searchId;\n  }\n}\n\nexport class FileBasedSearchResult implements Search.SearchConfig.SearchResult {\n  _uiSourceCode: Workspace.UISourceCode.UISourceCode;\n  _searchMatches: TextUtils.ContentProvider.SearchMatch[];\n  constructor(\n      uiSourceCode: Workspace.UISourceCode.UISourceCode, searchMatches: TextUtils.ContentProvider.SearchMatch[]) {\n    this._uiSourceCode = uiSourceCode;\n    this._searchMatches = searchMatches;\n  }\n\n  label(): string {\n    return this._uiSourceCode.displayName();\n  }\n\n  description(): string {\n    return this._uiSourceCode.fullDisplayName();\n  }\n\n  matchesCount(): number {\n    return this._searchMatches.length;\n  }\n\n  matchLineContent(index: number): string {\n    return this._searchMatches[index].lineContent;\n  }\n\n  matchRevealable(index: number): Object {\n    const match = this._searchMatches[index];\n    return this._uiSourceCode.uiLocation(match.lineNumber, undefined);\n  }\n\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  matchLabel(index: number): any {\n    return this._searchMatches[index].lineNumber + 1;\n  }\n}\n"]}