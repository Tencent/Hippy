{"version":3,"file":"RecordingView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/components/RecordingView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Recorder from '../../../models/recorder/recorder.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\n\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-recoring-view': RecordingView;\n  }\n}\n\nexport interface RecordingViewData {\n  isRecording: boolean;\n  recording: Recorder.Steps.UserFlow;\n}\n\nexport class RecordingToggledEvent extends Event {\n  data: boolean;\n\n  constructor(isRecording: boolean) {\n    super('recordingtoggled', {});\n    this.data = isRecording;\n  }\n}\n\nexport class RecordingView extends HTMLElement {\n  private readonly shadow = this.attachShadow({mode: 'open'});\n  private userFlow: Recorder.Steps.UserFlow|null = null;\n  private isRecording: boolean = false;\n\n  set data(data: RecordingViewData) {\n    this.userFlow = data.recording;\n    this.isRecording = data.isRecording;\n    this.render();\n  }\n\n  connectedCallback(): void {\n    this.render();\n  }\n\n  scrollToBottom(): void {\n    const wrapper = this.shadowRoot?.querySelector('.sections');\n    if (!wrapper) {\n      return;\n    }\n    wrapper.scrollTop = wrapper.scrollHeight;\n  }\n\n  private handleToggleRecording(): void {\n    this.dispatchEvent(new RecordingToggledEvent(!this.isRecording));\n  }\n\n  private render(): void {\n    if (!this.userFlow) {\n      return;\n    }\n\n    const {title, sections} = this.userFlow;\n    // clang-format off\n    LitHtml.render(LitHtml.html`\n      <style>\n        .wrapper {\n          height: 100%;\n          overflow: scroll;\n          box-sizing: border-box;\n          display: flex;\n          flex-direction: column;\n        }\n\n        .sections {\n          flex: 1;\n          min-height: 0;\n          overflow: scroll;\n        }\n\n        .section {\n          display: flex;\n          border-bottom: 1px solid var(--color-details-hairline);\n          padding: 16px 32px;\n        }\n\n        .section:last-child {\n          border-bottom: none;\n        }\n\n        .screenshot-wrapper {\n          max-width: 80px;\n          margin-right: 16px;\n        }\n\n        .screenshot {\n          object-fit: cover;\n          object-position: top center;\n          max-width: 100%;\n          height: auto;\n        }\n\n        .steps {\n          flex: 1;\n          position: relative;\n          align-self: flex-start;\n        }\n\n        .steps::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          bottom: 0;\n          left: 0;\n          width: 16px;\n          background: var(--color-background-elevation-1);\n          border-radius: 8px;\n        }\n\n        .steps::after {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 8px;\n          width: 2px;\n          background: var(--color-primary);\n          bottom: 0;\n          display: block;\n          transform: translateX(-50%);\n        }\n\n        .section:not(:first-child) .steps::before {\n          top: -64px;\n        }\n\n        .section:not(:first-child) .steps::after {\n          top: -64px;\n        }\n\n        .step {\n          position: relative;\n          padding-left: 32px;\n          margin: 16px 0;\n        }\n\n        .step .action {\n          font-size: 13px;\n          line-height: 16px;\n          letter-spacing: 0.03em;\n        }\n\n        .step::before {\n          content: '';\n          width: 8px;\n          height: 8px;\n          border: 2px solid var(--color-background);\n          border-radius: 50%;\n          display: block;\n          position: absolute;\n          top: 50%;\n          left: 8px;\n          background: var(--color-primary);\n          transform: translate(-50%, -50%);\n          z-index: 1;\n        }\n\n        .title {\n          font-size: 13px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          color: var(--color-text-primary);\n          letter-spacing: 0.03em;\n          font-weight: bold;\n          margin-top: 0;\n        }\n\n        .title .fallback {\n          color: var(--color-text-secondary);\n        }\n\n        .title::before {\n          width: 12px;\n          height: 12px;\n          border: 2px solid var(--color-primary);\n          background: var(--color-background);\n          top: 0;\n          transform: translate(-50%, 0);\n        }\n\n        .recording {\n          color: var(--color-primary);\n          font-style: italic;\n          margin-bottom: 0;\n        }\n\n        .recording::before {\n          width: 12px;\n          height: 12px;\n          border: 2px solid var(--color-background);\n          background: var(--color-background);\n          bottom: 0;\n          top: unset;\n          transform: translate(-50%, 0);\n        }\n\n        .recording::after {\n          content: '';\n          border-radius: 50%;\n          display: block;\n          position: absolute;\n          left: 8px;\n          z-index: 1;\n          width: 8px;\n          height: 8px;\n          background: var(--color-background);\n          border: 2px solid var(--color-primary);\n          border-top-color: transparent;\n          bottom: 0;\n          transform: translate(-50%, -2px);\n          animation: rotate 1s infinite;\n        }\n\n        @keyframes rotate {\n          from { transform: translate(-50%, -2px) rotate(0deg); }\n          to { transform: translate(-50%, -2px) rotate(360deg); }\n        }\n\n        .details {\n          max-width: 240px;\n          display: flex;\n          flex-direction: column;\n          align-items: flex-end;\n        }\n\n        .url {\n          font-size: 14px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          color: var(--color-text-secondary);\n          max-width: 100%;\n        }\n\n        .header {\n          padding: 16px 32px;\n        }\n\n        .header-title {\n          font-size: 18px;\n          line-height: 16px;\n          letter-spacing: 0.02em;\n        }\n\n        .is-recording .header-title::before {\n          content: '';\n          width: 12px;\n          height: 12px;\n          display: inline-block;\n          background: var(--color-red);\n          border-radius: 50%;\n          margin-right: 7px;\n        }\n\n        .footer {\n          display: flex;\n          justify-content: center;\n          border-top: 1px solid var(--color-details-hairline);\n          padding: 16px 32px;\n          background: var(--color-background);\n        }\n\n        .control {\n          background: none;\n          border: none;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          cursor: pointer;\n        }\n\n        .icon {\n          display: block;\n          width: 40px;\n          height: 40px;\n          border-radius: 50%;\n          background: var(--color-red);\n          margin-bottom: 8px;\n          position: relative;\n          transition: background 200ms;\n        }\n\n        .icon::before {\n          content: '';\n          display: block;\n          width: 14px;\n          height: 14px;\n          border: 1px solid var(--color-background);\n          border-radius: 3px;\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n\n        .icon:hover {\n          background: var(--color-accent-red);\n        }\n\n        .icon:active {\n          background: var(--color-red);\n        }\n\n        .label {\n          font-size: 12px;\n          line-height: 16px;\n          text-align: center;\n          letter-spacing: 0.02em;\n          color: var(--color-text-primary);\n        }\n\n        .shortcut {\n          font-size: 12px;\n          line-height: 16px;\n          text-align: center;\n          letter-spacing: 0.02em;\n          color: var(--color-text-secondary);\n        }\n      </style>\n      <div class=\"wrapper ${this.isRecording ? 'is-recording' : null}\">\n        <div class=\"header\">\n          <div class=\"header-title\">${title}</div>\n        </div>\n        <div class=\"sections\">\n        ${sections.map((section, i) => LitHtml.html`\n        <div class=\"section\">\n          <div class=\"screenshot-wrapper\">\n            <img class=\"screenshot\" width=\"200\" height=\"120\" src=\"${section.screenshot}\" />\n          </div>\n          <div class=\"steps\">\n            <div class=\"step title\">${section.title\n        ? section.title\n        : LitHtml.html`<span class=\"fallback\">(No Title)</span>`}\n            </div>\n            ${section.steps.map(step => LitHtml.html`\n              <div class=\"step\">\n                <div class=\"action\">${step.type}</div>\n                ${'selector' in step ? LitHtml.html`<div class=\"selector\">${step.selector}</div>` : null}\n              </div>\n            `)}\n            ${this.isRecording && i === sections.length - 1 ? LitHtml.html`<div class=\"step recording\">Recording ...</div>` : null}\n          </div>\n          <div class=\"details\">\n            <div class=\"url\">${section.url}</div>\n          </div>\n        </div>\n        `)}\n        </div>\n        <div class=\"footer\">\n          <div class=\"controls\">\n            <button class=\"control\" @click=${this.handleToggleRecording.bind(this)}>\n              <div class=\"icon\"></div>\n              <div class=\"label\">${this.isRecording ? 'End recording' : 'Start recording'}</div>\n              <!-- <div class=\"shortcut\">Ctrl + E</div> -->\n            </button>\n          </div>\n        </div>\n      </div>\n    `, this.shadow);\n    // clang-format off\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-recording-view', RecordingView);\n"]}