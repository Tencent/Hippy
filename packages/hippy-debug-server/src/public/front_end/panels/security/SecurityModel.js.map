{"version":3,"file":"SecurityModel.js","sourceRoot":"","sources":["../../../../../../front_end/panels/security/SecurityModel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport * as Protocol from '../../generated/protocol.js';\n\nconst UIStrings = {\n  /**\n  *@description Text in Security Panel of the Security panel\n  */\n  theSecurityOfThisPageIsUnknown: 'The security of this page is unknown.',\n  /**\n  *@description Text in Security Panel of the Security panel\n  */\n  thisPageIsNotSecure: 'This page is not secure.',\n  /**\n  *@description Text in Security Panel of the Security panel\n  */\n  thisPageIsSecureValidHttps: 'This page is secure (valid HTTPS).',\n  /**\n  *@description Text in Security Panel of the Security panel\n  */\n  thisPageIsNotSecureBrokenHttps: 'This page is not secure (broken HTTPS).',\n  /**\n  *@description Description of an SSL cipher that contains a separate (bulk) cipher and MAC.\n  *@example {AES_256_CBC} PH1\n  *@example {HMAC-SHA1} PH2\n  */\n  cipherWithMAC: '{PH1} with {PH2}',\n  /**\n  *@description Description of an SSL Key and its Key Exchange Group.\n  *@example {ECDHE_RSA} PH1\n  *@example {X25519} PH2\n  */\n  keyExchangeWithGroup: '{PH1} with {PH2}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/security/SecurityModel.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst i18nLazyString = i18n.i18n.getLazilyComputedLocalizedString.bind(undefined, str_);\n\nexport class SecurityModel extends SDK.SDKModel.SDKModel {\n  _dispatcher: SecurityDispatcher;\n  _securityAgent: ProtocolProxyApi.SecurityApi;\n  constructor(target: SDK.Target.Target) {\n    super(target);\n    this._dispatcher = new SecurityDispatcher(this);\n    this._securityAgent = target.securityAgent();\n    target.registerSecurityDispatcher(this._dispatcher);\n    this._securityAgent.invoke_enable();\n  }\n\n  resourceTreeModel(): SDK.ResourceTreeModel.ResourceTreeModel {\n    return /** @type {!SDK.ResourceTreeModel.ResourceTreeModel} */ this.target().model(\n               SDK.ResourceTreeModel.ResourceTreeModel) as SDK.ResourceTreeModel.ResourceTreeModel;\n  }\n\n  networkManager(): SDK.NetworkManager.NetworkManager {\n    return /** @type {!SDK.NetworkManager.NetworkManager} */ this.target().model(SDK.NetworkManager.NetworkManager) as\n        SDK.NetworkManager.NetworkManager;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  static SecurityStateComparator(a: Protocol.Security.SecurityState|null, b: Protocol.Security.SecurityState|null):\n      number {\n    const securityStateMap = getOrCreateSecurityStateOrdinalMap();\n    const aScore = a && securityStateMap.get(a) || 0;\n    const bScore = b && securityStateMap.get(b) || 0;\n\n    return aScore - bScore;\n  }\n}\nlet securityStateToOrdinal: Map<Protocol.Security.SecurityState, number>|null = null;\n\nconst getOrCreateSecurityStateOrdinalMap = (): Map<Protocol.Security.SecurityState, number> => {\n  if (!securityStateToOrdinal) {\n    securityStateToOrdinal = new Map();\n    const ordering = [\n      Protocol.Security.SecurityState.Info,\n      Protocol.Security.SecurityState.InsecureBroken,\n      Protocol.Security.SecurityState.Insecure,\n      Protocol.Security.SecurityState.Neutral,\n      Protocol.Security.SecurityState.Secure,\n      // Unknown is max so that failed/cancelled requests don't overwrite the origin security state for successful requests,\n      // and so that failed/cancelled requests appear at the bottom of the origins list.\n      Protocol.Security.SecurityState.Unknown,\n    ];\n    for (let i = 0; i < ordering.length; i++) {\n      securityStateToOrdinal.set(ordering[i], i + 1);\n    }\n  }\n  return securityStateToOrdinal;\n};\n\nSDK.SDKModel.SDKModel.register(SecurityModel, {capabilities: SDK.Target.Capability.Security, autostart: false});\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  SecurityStateChanged = 'SecurityStateChanged',\n  VisibleSecurityStateChanged = 'VisibleSecurityStateChanged',\n}\n\nexport const SummaryMessages: {[x: string]: () => string} = {\n  [Protocol.Security.SecurityState.Unknown]: i18nLazyString(UIStrings.theSecurityOfThisPageIsUnknown),\n  [Protocol.Security.SecurityState.Insecure]: i18nLazyString(UIStrings.thisPageIsNotSecure),\n  [Protocol.Security.SecurityState.Neutral]: i18nLazyString(UIStrings.thisPageIsNotSecure),\n  [Protocol.Security.SecurityState.Secure]: i18nLazyString(UIStrings.thisPageIsSecureValidHttps),\n  [Protocol.Security.SecurityState.InsecureBroken]: i18nLazyString(UIStrings.thisPageIsNotSecureBrokenHttps),\n};\n\nexport class PageSecurityState {\n  securityState: Protocol.Security.SecurityState;\n  explanations: Protocol.Security.SecurityStateExplanation[];\n  summary: string|null;\n  constructor(\n      securityState: Protocol.Security.SecurityState, explanations: Protocol.Security.SecurityStateExplanation[],\n      summary: string|null) {\n    this.securityState = securityState;\n    this.explanations = explanations;\n    this.summary = summary;\n  }\n}\n\nexport class PageVisibleSecurityState {\n  securityState: Protocol.Security.SecurityState;\n  certificateSecurityState: CertificateSecurityState|null;\n  safetyTipInfo: SafetyTipInfo|null;\n  securityStateIssueIds: string[];\n  constructor(\n      securityState: Protocol.Security.SecurityState,\n      certificateSecurityState: Protocol.Security.CertificateSecurityState|null,\n      safetyTipInfo: Protocol.Security.SafetyTipInfo|null, securityStateIssueIds: string[]) {\n    this.securityState = securityState;\n    this.certificateSecurityState =\n        certificateSecurityState ? new CertificateSecurityState(certificateSecurityState) : null;\n    this.safetyTipInfo = safetyTipInfo ? new SafetyTipInfo(safetyTipInfo) : null;\n    this.securityStateIssueIds = securityStateIssueIds;\n  }\n}\n\nexport class CertificateSecurityState {\n  protocol: string;\n  keyExchange: string;\n  keyExchangeGroup: string|null;\n  cipher: string;\n  mac: string|null;\n  certificate: string[];\n  subjectName: string;\n  issuer: string;\n  validFrom: number;\n  validTo: number;\n  certificateNetworkError: string|null;\n  certificateHasWeakSignature: boolean;\n  certificateHasSha1Signature: boolean;\n  modernSSL: boolean;\n  obsoleteSslProtocol: boolean;\n  obsoleteSslKeyExchange: boolean;\n  obsoleteSslCipher: boolean;\n  obsoleteSslSignature: boolean;\n  constructor(certificateSecurityState: Protocol.Security.CertificateSecurityState) {\n    this.protocol = certificateSecurityState.protocol;\n    this.keyExchange = certificateSecurityState.keyExchange;\n    this.keyExchangeGroup = certificateSecurityState.keyExchangeGroup || null;\n    this.cipher = certificateSecurityState.cipher;\n    this.mac = certificateSecurityState.mac || null;\n    this.certificate = certificateSecurityState.certificate;\n    this.subjectName = certificateSecurityState.subjectName;\n    this.issuer = certificateSecurityState.issuer;\n    this.validFrom = certificateSecurityState.validFrom;\n    this.validTo = certificateSecurityState.validTo;\n    this.certificateNetworkError = certificateSecurityState.certificateNetworkError || null;\n    this.certificateHasWeakSignature = certificateSecurityState.certificateHasWeakSignature;\n    this.certificateHasSha1Signature = certificateSecurityState.certificateHasSha1Signature;\n    this.modernSSL = certificateSecurityState.modernSSL;\n    this.obsoleteSslProtocol = certificateSecurityState.obsoleteSslProtocol;\n    this.obsoleteSslKeyExchange = certificateSecurityState.obsoleteSslKeyExchange;\n    this.obsoleteSslCipher = certificateSecurityState.obsoleteSslCipher;\n    this.obsoleteSslSignature = certificateSecurityState.obsoleteSslSignature;\n  }\n\n  isCertificateExpiringSoon(): boolean {\n    const expiryDate = new Date(this.validTo * 1000).getTime();\n    return (expiryDate < new Date(Date.now()).setHours(48)) && (expiryDate > Date.now());\n  }\n\n  getKeyExchangeName(): string {\n    if (this.keyExchangeGroup) {\n      return this.keyExchange ?\n          i18nString(UIStrings.keyExchangeWithGroup, {PH1: this.keyExchange, PH2: this.keyExchangeGroup}) :\n          this.keyExchangeGroup;\n    }\n    return this.keyExchange;\n  }\n\n  getCipherFullName(): string {\n    return this.mac ? i18nString(UIStrings.cipherWithMAC, {PH1: this.cipher, PH2: this.mac}) : this.cipher;\n  }\n}\n\nclass SafetyTipInfo {\n  safetyTipStatus: string;\n  safeUrl: string|null;\n  constructor(safetyTipInfo: Protocol.Security.SafetyTipInfo) {\n    this.safetyTipStatus = safetyTipInfo.safetyTipStatus;\n    this.safeUrl = safetyTipInfo.safeUrl || null;\n  }\n}\n\nexport class SecurityStyleExplanation {\n  securityState: Protocol.Security.SecurityState;\n  title: string|undefined;\n  summary: string;\n  description: string;\n  certificate: string[];\n  mixedContentType: Protocol.Security.MixedContentType;\n  recommendations: string[];\n  constructor(\n      securityState: Protocol.Security.SecurityState, title: string|undefined, summary: string, description: string,\n      certificate: string[]|undefined = [],\n      mixedContentType: Protocol.Security.MixedContentType|undefined = Protocol.Security.MixedContentType.None,\n      recommendations: string[]|undefined = []) {\n    this.securityState = securityState;\n    this.title = title;\n    this.summary = summary;\n    this.description = description;\n    this.certificate = certificate;\n    this.mixedContentType = mixedContentType;\n    this.recommendations = recommendations;\n  }\n}\n\nclass SecurityDispatcher implements ProtocolProxyApi.SecurityDispatcher {\n  _model: SecurityModel;\n  constructor(model: SecurityModel) {\n    this._model = model;\n  }\n\n  securityStateChanged({securityState, explanations, summary}: Protocol.Security.SecurityStateChangedEvent): void {\n    const pageSecurityState = new PageSecurityState(securityState, explanations, summary || null);\n    this._model.dispatchEventToListeners(Events.SecurityStateChanged, pageSecurityState);\n  }\n\n  visibleSecurityStateChanged({visibleSecurityState}: Protocol.Security.VisibleSecurityStateChangedEvent): void {\n    const pageVisibleSecurityState = new PageVisibleSecurityState(\n        visibleSecurityState.securityState, visibleSecurityState.certificateSecurityState || null,\n        visibleSecurityState.safetyTipInfo || null, visibleSecurityState.securityStateIssueIds);\n    this._model.dispatchEventToListeners(Events.VisibleSecurityStateChanged, pageVisibleSecurityState);\n  }\n\n  certificateError(_event: Protocol.Security.CertificateErrorEvent): void {\n  }\n}\n"]}