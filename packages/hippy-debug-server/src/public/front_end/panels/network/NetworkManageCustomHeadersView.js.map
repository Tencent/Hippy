{"version":3,"file":"NetworkManageCustomHeadersView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/NetworkManageCustomHeadersView.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,uDAAuD;AAEvD,OAAO,KAAK,IAAI,MAAM,yBAAyB,CAAC;AAChD,OAAO,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAEhD,MAAM,SAAS,GAAG;IAChB;;MAEE;IACF,mBAAmB,EAAE,uBAAuB;IAC5C;;MAEE;IACF,eAAe,EAAE,mBAAmB;IACpC;;MAEE;IACF,eAAe,EAAE,oBAAoB;IACrC;;MAEE;IACF,UAAU,EAAE,aAAa;CAC1B,CAAC;AACF,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,kDAAkD,EAAE,SAAS,CAAC,CAAC;AACxG,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AAMtE,MAAM,OAAO,8BAA+B,SAAQ,EAAE,CAAC,MAAM,CAAC,IAAI;IAChE,KAAK,CAAyC;IAC9C,cAAc,CAGX;IACH,wBAAwB,CAA4B;IACpD,2BAA2B,CAA0C;IACrE,2BAA2B,CAA4B;IACvD,OAAO,CAAsC;IAE7C,YACI,UAGG,EACH,uBAAkD,EAClD,0BAAmE,EACnE,0BAAqD;QACvD,KAAK,CAAC,IAAI,CAAC,CAAC;QACZ,IAAI,CAAC,mBAAmB,CAAC,mDAAmD,EAAE,EAAC,oBAAoB,EAAE,KAAK,EAAC,CAAC,CAAC;QAE7G,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;QAC5D,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,WAAW,GAAG,UAAU,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;QAEzG,IAAI,CAAC,KAAK,GAAG,IAAI,EAAE,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAChD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;QACxD,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,mDAAmD,EAAE,EAAC,oBAAoB,EAAE,KAAK,EAAC,CAAC,CAAC;QAEnH,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAClD,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;QAC5D,WAAW,CAAC,WAAW,GAAG,UAAU,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;QAChE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,WAAW,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QACrC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC,OAAO,CAAC,gBAAgB,CACvD,UAAU,CAAC,SAAS,CAAC,eAAe,CAAC,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,YAAY,CAAC,CAAC,CAAC;QAE7F,IAAI,CAAC,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;QAChC,UAAU,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,UAAU,CAAC,CAAC,CAAC;QAEtG,IAAI,CAAC,wBAAwB,GAAG,uBAAuB,CAAC;QACxD,IAAI,CAAC,2BAA2B,GAAG,0BAA0B,CAAC;QAC9D,IAAI,CAAC,2BAA2B,GAAG,0BAA0B,CAAC;QAE9D,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,CAAC,CAAC;IACnC,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAED,eAAe;QACb,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;QACnB,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAC,MAAM,EAAE,UAAU,CAAC,KAAK,EAAC,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC;IACpH,CAAC;IAED,iBAAiB;QACf,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,EAAC,MAAM,EAAE,EAAE,EAAC,CAAC,CAAC;IAChE,CAAC;IAED,UAAU,CAAC,IAAkB,EAAE,SAAkB;QAC/C,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC9C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;QAClD,MAAM,MAAM,GAAG,OAAO,CAAC,WAAW,CAAC,KAAK,EAAE,oBAAoB,CAAC,CAAC;QAChE,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;QACjC,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QAChD,OAAO,OAAO,CAAC;IACjB,CAAC;IAED,mBAAmB,CAAC,IAAkB,EAAE,MAAc;QACpD,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC9C,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;QACtD,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAED,UAAU,CAAC,IAAkB,EAAE,MAA0C,EAAE,KAAc;QACvF,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;QACvD,IAAI,OAAO,CAAC;QACZ,IAAI,KAAK,EAAE;YACT,OAAO,GAAG,IAAI,CAAC,wBAAwB,CAAC,QAAQ,CAAC,CAAC;SACnD;aAAM;YACL,OAAO,GAAG,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;SACnE;QAED,IAAI,OAAO,IAAI,CAAC,KAAK,EAAE;YACrB,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;SACvD;QACD,IAAI,OAAO,EAAE;YACX,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,EAAE,EAAC,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAC,CAAC,CAAC;SACpF;QAED,IAAI,CAAC,eAAe,EAAE,CAAC;IACzB,CAAC;IAED,SAAS,CAAC,IAAkB;QAC1B,MAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACpC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;QAC7C,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,aAAa;QACX,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,OAAO,IAAI,CAAC,OAAO,CAAC;SACrB;QAED,MAAM,MAAM,GAAG,IAAI,EAAE,CAAC,UAAU,CAAC,MAAM,EAAgB,CAAC;QACxD,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,MAAM,OAAO,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;QAExC,MAAM,MAAM,GAAG,OAAO,CAAC,WAAW,CAAC,KAAK,EAAE,yBAAyB,CAAC,CAAC;QACrE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,uBAAuB,CAAC,CAAC,WAAW,GAAG,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAElG,MAAM,MAAM,GAAG,OAAO,CAAC,WAAW,CAAC,KAAK,EAAE,yBAAyB,CAAC,CAAC;QACrE,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,uBAAuB,CAAC;aAC7C,WAAW,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,EAAE,MAAM,EAAE,iBAAiB,EAAE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAErG,OAAO,MAAM,CAAC;QAEd,SAAS,cAAc,CACmB,IAAkB,EAAE,MAAc,EACxE,MAA0C;YAC5C,IAAI,KAAK,GAAG,IAAI,CAAC;YACjB,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,WAAW,EAAE,CAAC;YACrE,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,MAAM,KAAK,QAAQ,EAAE;gBACjE,KAAK,GAAG,KAAK,CAAC;aACf;YACD,OAAO,EAAC,KAAK,EAAE,YAAY,EAAE,SAAS,EAAC,CAAC;QAC1C,CAAC;IACH,CAAC;CACF","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nconst UIStrings = {\n  /**\n  *@description Text in Network Manage Custom Headers View of the Network panel\n  */\n  manageHeaderColumns: 'Manage Header Columns',\n  /**\n  *@description Placeholder text content in Network Manage Custom Headers View of the Network panel\n  */\n  noCustomHeaders: 'No custom headers',\n  /**\n  *@description Text of add button in Network Manage Custom Headers View of the Network panel\n  */\n  addCustomHeader: 'Add custom headerâ€¦',\n  /**\n  *@description Text in Network Manage Custom Headers View of the Network panel\n  */\n  headerName: 'Header Name',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/network/NetworkManageCustomHeadersView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ninterface CustomHeader {\n  header: string;\n}\n\nexport class NetworkManageCustomHeadersView extends UI.Widget.VBox implements UI.ListWidget.Delegate<CustomHeader> {\n  _list: UI.ListWidget.ListWidget<CustomHeader>;\n  _columnConfigs: Map<string, {\n    title: string,\n    editable: boolean,\n  }>;\n  _addHeaderColumnCallback: (arg0: string) => boolean;\n  _changeHeaderColumnCallback: (arg0: string, arg1: string) => boolean;\n  _removeHeaderColumnCallback: (arg0: string) => boolean;\n  _editor?: UI.ListWidget.Editor<CustomHeader>;\n\n  constructor(\n      columnData: {\n        title: string,\n        editable: boolean,\n      }[],\n      addHeaderColumnCallback: (arg0: string) => boolean,\n      changeHeaderColumnCallback: (arg0: string, arg1: string) => boolean,\n      removeHeaderColumnCallback: (arg0: string) => boolean) {\n    super(true);\n    this.registerRequiredCSS('panels/network/networkManageCustomHeadersView.css', {enableLegacyPatching: false});\n\n    this.contentElement.classList.add('custom-headers-wrapper');\n    this.contentElement.createChild('div', 'header').textContent = i18nString(UIStrings.manageHeaderColumns);\n\n    this._list = new UI.ListWidget.ListWidget(this);\n    this._list.element.classList.add('custom-headers-list');\n    this._list.registerRequiredCSS('panels/network/networkManageCustomHeadersView.css', {enableLegacyPatching: false});\n\n    const placeholder = document.createElement('div');\n    placeholder.classList.add('custom-headers-list-list-empty');\n    placeholder.textContent = i18nString(UIStrings.noCustomHeaders);\n    this._list.setEmptyPlaceholder(placeholder);\n    this._list.show(this.contentElement);\n    this.contentElement.appendChild(UI.UIUtils.createTextButton(\n        i18nString(UIStrings.addCustomHeader), this._addButtonClicked.bind(this), 'add-button'));\n\n    this._columnConfigs = new Map();\n    columnData.forEach(columnData => this._columnConfigs.set(columnData.title.toLowerCase(), columnData));\n\n    this._addHeaderColumnCallback = addHeaderColumnCallback;\n    this._changeHeaderColumnCallback = changeHeaderColumnCallback;\n    this._removeHeaderColumnCallback = removeHeaderColumnCallback;\n\n    this.contentElement.tabIndex = 0;\n  }\n\n  wasShown(): void {\n    this._headersUpdated();\n  }\n\n  _headersUpdated(): void {\n    this._list.clear();\n    this._columnConfigs.forEach(headerData => this._list.appendItem({header: headerData.title}, headerData.editable));\n  }\n\n  _addButtonClicked(): void {\n    this._list.addNewItem(this._columnConfigs.size, {header: ''});\n  }\n\n  renderItem(item: CustomHeader, _editable: boolean): Element {\n    const element = document.createElement('div');\n    element.classList.add('custom-headers-list-item');\n    const header = element.createChild('div', 'custom-header-name');\n    header.textContent = item.header;\n    UI.Tooltip.Tooltip.install(header, item.header);\n    return element;\n  }\n\n  removeItemRequested(item: CustomHeader, _index: number): void {\n    this._removeHeaderColumnCallback(item.header);\n    this._columnConfigs.delete(item.header.toLowerCase());\n    this._headersUpdated();\n  }\n\n  commitEdit(item: CustomHeader, editor: UI.ListWidget.Editor<CustomHeader>, isNew: boolean): void {\n    const headerId = editor.control('header').value.trim();\n    let success;\n    if (isNew) {\n      success = this._addHeaderColumnCallback(headerId);\n    } else {\n      success = this._changeHeaderColumnCallback(item.header, headerId);\n    }\n\n    if (success && !isNew) {\n      this._columnConfigs.delete(item.header.toLowerCase());\n    }\n    if (success) {\n      this._columnConfigs.set(headerId.toLowerCase(), {title: headerId, editable: true});\n    }\n\n    this._headersUpdated();\n  }\n\n  beginEdit(item: CustomHeader): UI.ListWidget.Editor<CustomHeader> {\n    const editor = this._createEditor();\n    editor.control('header').value = item.header;\n    return editor;\n  }\n\n  _createEditor(): UI.ListWidget.Editor<CustomHeader> {\n    if (this._editor) {\n      return this._editor;\n    }\n\n    const editor = new UI.ListWidget.Editor<CustomHeader>();\n    this._editor = editor;\n    const content = editor.contentElement();\n\n    const titles = content.createChild('div', 'custom-headers-edit-row');\n    titles.createChild('div', 'custom-headers-header').textContent = i18nString(UIStrings.headerName);\n\n    const fields = content.createChild('div', 'custom-headers-edit-row');\n    fields.createChild('div', 'custom-headers-header')\n        .appendChild(editor.createInput('header', 'text', 'x-custom-header', validateHeader.bind(this)));\n\n    return editor;\n\n    function validateHeader(\n        this: NetworkManageCustomHeadersView, item: CustomHeader, _index: number,\n        _input: HTMLInputElement|HTMLSelectElement): UI.ListWidget.ValidatorResult {\n      let valid = true;\n      const headerId = editor.control('header').value.trim().toLowerCase();\n      if (this._columnConfigs.has(headerId) && item.header !== headerId) {\n        valid = false;\n      }\n      return {valid, errorMessage: undefined};\n    }\n  }\n}\n"]}