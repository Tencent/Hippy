{"version":3,"file":"DatabaseQueryView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/application/DatabaseQueryView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2008 Apple Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as DataGrid from '../../ui/legacy/components/data_grid/data_grid.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport type {Database} from './DatabaseModel.js'; // eslint-disable-line no-unused-vars\n\nconst UIStrings = {\n  /**\n  *@description Data grid name for Database Query data grids\n  */\n  databaseQuery: 'Database Query',\n  /**\n  *@description Aria text for table selected in WebSQL DatabaseQueryView in Application panel\n  *@example {\"SELECT * FROM LOGS\"} PH1\n  */\n  queryS: 'Query: {PH1}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/application/DatabaseQueryView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class DatabaseQueryView extends UI.Widget.VBox {\n  database: Database;\n  _queryWrapper: HTMLElement;\n  _promptContainer: HTMLElement;\n  _promptElement: HTMLElement;\n  _prompt: UI.TextPrompt.TextPrompt;\n  _proxyElement: Element;\n  _queryResults: HTMLElement[];\n  _virtualSelectedIndex: number;\n  _lastSelectedElement!: Element|null;\n  _selectionTimeout: number;\n  constructor(database: Database) {\n    super();\n\n    this.database = database;\n\n    this.element.classList.add('storage-view', 'query', 'monospace');\n    this.element.addEventListener('selectstart', this._selectStart.bind(this), false);\n\n    this._queryWrapper = this.element.createChild('div', 'database-query-group-messages');\n    this._queryWrapper.addEventListener('focusin', (this._onFocusIn.bind(this) as EventListener));\n    this._queryWrapper.addEventListener('focusout', (this._onFocusOut.bind(this) as EventListener));\n    this._queryWrapper.addEventListener('keydown', (this._onKeyDown.bind(this) as EventListener));\n    this._queryWrapper.tabIndex = -1;\n\n    this._promptContainer = this.element.createChild('div', 'database-query-prompt-container');\n    this._promptContainer.appendChild(UI.Icon.Icon.create('smallicon-text-prompt', 'prompt-icon'));\n    this._promptElement = this._promptContainer.createChild('div');\n    this._promptElement.className = 'database-query-prompt';\n    this._promptElement.addEventListener('keydown', (this._promptKeyDown.bind(this) as EventListener));\n\n    this._prompt = new UI.TextPrompt.TextPrompt();\n    this._prompt.initialize(this.completions.bind(this), ' ');\n    this._proxyElement = this._prompt.attach(this._promptElement);\n\n    this.element.addEventListener('click', this._messagesClicked.bind(this), true);\n\n    this._queryResults = [];\n    this._virtualSelectedIndex = -1;\n    this._selectionTimeout = 0;\n  }\n\n  _messagesClicked(): void {\n    this._prompt.focus();\n    if (!this._prompt.isCaretInsidePrompt() && !this.element.hasSelection()) {\n      this._prompt.moveCaretToEndOfPrompt();\n    }\n  }\n\n  _onKeyDown(event: KeyboardEvent): void {\n    if (UI.UIUtils.isEditing() || !this._queryResults.length || event.shiftKey) {\n      return;\n    }\n    switch (event.key) {\n      case 'ArrowUp':\n        if (this._virtualSelectedIndex > 0) {\n          this._virtualSelectedIndex--;\n        } else {\n          return;\n        }\n        break;\n      case 'ArrowDown':\n        if (this._virtualSelectedIndex < this._queryResults.length - 1) {\n          this._virtualSelectedIndex++;\n        } else {\n          return;\n        }\n        break;\n      case 'Home':\n        this._virtualSelectedIndex = 0;\n        break;\n      case 'End':\n        this._virtualSelectedIndex = this._queryResults.length - 1;\n        break;\n      default:\n        return;\n    }\n    event.consume(true);\n    this._updateFocusedItem();\n  }\n\n  _onFocusIn(event: FocusEvent): void {\n    // Make default selection when moving from external (e.g. prompt) to the container.\n    if (this._virtualSelectedIndex === -1 && this._isOutsideViewport((event.relatedTarget as Element | null)) &&\n        event.target === this._queryWrapper && this._queryResults.length) {\n      this._virtualSelectedIndex = this._queryResults.length - 1;\n    }\n    this._updateFocusedItem();\n  }\n\n  _onFocusOut(event: FocusEvent): void {\n    if (this._isOutsideViewport((event.relatedTarget as Element | null))) {\n      this._virtualSelectedIndex = -1;\n    }\n    this._updateFocusedItem();\n\n    this._queryWrapper.scrollTop = 10000000;\n  }\n\n  _isOutsideViewport(element: Element|null): boolean {\n    return element !== null && !element.isSelfOrDescendant(this._queryWrapper);\n  }\n\n  _updateFocusedItem(): void {\n    let index: number = this._virtualSelectedIndex;\n    if (this._queryResults.length && this._virtualSelectedIndex < 0) {\n      index = this._queryResults.length - 1;\n    }\n\n    const selectedElement = index >= 0 ? this._queryResults[index] : null;\n    const changed = this._lastSelectedElement !== selectedElement;\n    const containerHasFocus = this._queryWrapper === this.element.ownerDocument.deepActiveElement();\n\n    if (selectedElement && (changed || containerHasFocus) && this.element.hasFocus()) {\n      if (!selectedElement.hasFocus()) {\n        selectedElement.focus();\n      }\n    }\n\n    if (this._queryResults.length && !this._queryWrapper.hasFocus()) {\n      this._queryWrapper.tabIndex = 0;\n    } else {\n      this._queryWrapper.tabIndex = -1;\n    }\n    this._lastSelectedElement = selectedElement;\n  }\n\n  async completions(_expression: string, prefix: string, _force?: boolean): Promise<UI.SuggestBox.Suggestions> {\n    if (!prefix) {\n      return [];\n    }\n\n    prefix = prefix.toLowerCase();\n    const tableNames = await this.database.tableNames();\n    return tableNames.map(name => name + ' ')\n        .concat(SQL_BUILT_INS)\n        .filter(proposal => proposal.toLowerCase().startsWith(prefix))\n        .map(completion => ({text: completion} as UI.SuggestBox.Suggestion));\n  }\n\n  _selectStart(_event: Event): void {\n    if (this._selectionTimeout) {\n      clearTimeout(this._selectionTimeout);\n    }\n\n    this._prompt.clearAutocomplete();\n\n    function moveBackIfOutside(this: DatabaseQueryView): void {\n      this._selectionTimeout = 0;\n      if (!this._prompt.isCaretInsidePrompt() && !this.element.hasSelection()) {\n        this._prompt.moveCaretToEndOfPrompt();\n      }\n      this._prompt.autoCompleteSoon();\n    }\n\n    this._selectionTimeout = window.setTimeout(moveBackIfOutside.bind(this), 100);\n  }\n\n  _promptKeyDown(event: KeyboardEvent): void {\n    if (event.key === 'Enter') {\n      this._enterKeyPressed(event);\n      return;\n    }\n  }\n\n  async _enterKeyPressed(event: KeyboardEvent): Promise<void> {\n    event.consume(true);\n\n    const query = this._prompt.textWithCurrentSuggestion();\n    this._prompt.clearAutocomplete();\n\n    if (!query.length) {\n      return;\n    }\n\n    this._prompt.setEnabled(false);\n    try {\n      // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const result = await new Promise<{columnNames: string[], values: any[]}>((resolve, reject) => {\n        this.database.executeSql(\n            query, (columnNames, values) => resolve({columnNames, values}), errorText => reject(errorText));\n      });\n      this._queryFinished(query, result.columnNames, result.values);\n    } catch (e) {\n      this._appendErrorQueryResult(query, e);\n    }\n    this._prompt.setEnabled(true);\n    this._prompt.setText('');\n    this._prompt.focus();\n  }\n\n  // TODO(crbug.com/1172300) Ignored during the jsdoc to ts migration)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _queryFinished(query: string, columnNames: string[], values: any[]): void {\n    const dataGrid =\n        DataGrid.SortableDataGrid.SortableDataGrid.create(columnNames, values, i18nString(UIStrings.databaseQuery));\n    const trimmedQuery = query.trim();\n\n    let view: DataGrid.DataGrid.DataGridWidget<unknown>|null = null;\n    if (dataGrid) {\n      dataGrid.setStriped(true);\n      dataGrid.renderInline();\n      dataGrid.autoSizeColumns(5);\n      view = dataGrid.asWidget();\n      dataGrid.setFocusable(false);\n    }\n    this._appendViewQueryResult(trimmedQuery, view);\n\n    if (trimmedQuery.match(/^create /i) || trimmedQuery.match(/^drop table /i)) {\n      this.dispatchEventToListeners(Events.SchemaUpdated, this.database);\n    }\n  }\n\n  _appendViewQueryResult(query: string, view: UI.Widget.Widget|null): void {\n    const resultElement = this._appendQueryResult(query);\n    if (view) {\n      view.show(resultElement);\n    } else {\n      resultElement.remove();\n    }\n\n    this._scrollResultIntoView();\n  }\n\n  _appendErrorQueryResult(query: string, errorText: string): void {\n    const resultElement = this._appendQueryResult(query);\n    resultElement.classList.add('error');\n    resultElement.appendChild(UI.Icon.Icon.create('smallicon-error', 'prompt-icon'));\n    UI.UIUtils.createTextChild(resultElement, errorText);\n\n    this._scrollResultIntoView();\n  }\n\n  _scrollResultIntoView(): void {\n    this._queryResults[this._queryResults.length - 1].scrollIntoView(false);\n    this._promptElement.scrollIntoView(false);\n  }\n\n  _appendQueryResult(query: string): HTMLDivElement {\n    const element = (document.createElement('div') as HTMLElement);\n    element.className = 'database-user-query';\n    element.tabIndex = -1;\n\n    UI.ARIAUtils.setAccessibleName(element, i18nString(UIStrings.queryS, {PH1: query}));\n    this._queryResults.push(element);\n    this._updateFocusedItem();\n\n    element.appendChild(UI.Icon.Icon.create('smallicon-user-command', 'prompt-icon'));\n\n    const commandTextElement = document.createElement('span');\n    commandTextElement.className = 'database-query-text';\n    commandTextElement.textContent = query;\n    element.appendChild(commandTextElement);\n\n    const resultElement = document.createElement('div');\n    resultElement.className = 'database-query-result';\n    element.appendChild(resultElement);\n\n    this._queryWrapper.appendChild(element);\n    return resultElement;\n  }\n}\n\n// TODO(crbug.com/1167717): Make this a const enum again\n// eslint-disable-next-line rulesdir/const_enum\nexport enum Events {\n  SchemaUpdated = 'SchemaUpdated',\n}\n\n\nexport const SQL_BUILT_INS = [\n  'SELECT ',\n  'FROM ',\n  'WHERE ',\n  'LIMIT ',\n  'DELETE FROM ',\n  'CREATE ',\n  'DROP ',\n  'TABLE ',\n  'INDEX ',\n  'UPDATE ',\n  'INSERT INTO ',\n  'VALUES (',\n];\n"]}