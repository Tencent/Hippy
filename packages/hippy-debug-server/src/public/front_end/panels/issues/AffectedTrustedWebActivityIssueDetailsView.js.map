{"version":3,"file":"AffectedTrustedWebActivityIssueDetailsView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/issues/AffectedTrustedWebActivityIssueDetailsView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as IssuesManager from '../../models/issues_manager/issues_manager.js';\n\nimport {AffectedResourcesView} from './AffectedResourcesView.js';\nimport type {AggregatedIssue} from './IssueAggregator.js';\nimport type {IssueView} from './IssueView.js';\n\nconst UIStrings = {\n  /**\n  *@description Label for number of affected resources indication in issue view\n  */\n  nResources: '{n, plural, =1 {# resource} other {# resources}}',\n  /**\n  *@description Title for a column in a Trusted Web Activity issue view\n  */\n  statusCode: 'Status code',\n  /**\n  *@description Text in Timeline UIUtils of the Performance panel\n  */\n  url: 'Url',\n  /**\n  *@description Title for a column in a Trusted Web Activity issue view\n  */\n  packageName: 'Package name',\n  /**\n  *@description Title for a column in a Trusted Web Activity issue view\n  */\n  packageSignature: 'Package signature',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/issues/AffectedTrustedWebActivityIssueDetailsView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class AffectedTrustedWebActivityIssueDetailsView extends AffectedResourcesView {\n  private issue: AggregatedIssue;\n\n  constructor(parentView: IssueView, issue: AggregatedIssue) {\n    super(parentView);\n    this.issue = issue;\n  }\n\n  protected getResourceNameWithCount(count: number): Platform.UIString.LocalizedString {\n    return i18nString(UIStrings.nResources, {n: count});\n  }\n\n  private appendDetail(twaIssue: IssuesManager.TrustedWebActivityIssue.TrustedWebActivityIssue): void {\n    const element = document.createElement('tr');\n    element.classList.add('affected-resource-row');\n\n    const details = twaIssue.details();\n    if (this.issue.code() === IssuesManager.TrustedWebActivityIssue.httpViolationCode && details.httpStatusCode) {\n      this.appendIssueDetailCell(element, details.httpStatusCode.toString());\n      this.appendIssueDetailCell(element, details.url);\n    } else if (this.issue.code() === IssuesManager.TrustedWebActivityIssue.offlineViolationCode) {\n      this.appendIssueDetailCell(element, details.url);\n    } else if (this.issue.code() === IssuesManager.TrustedWebActivityIssue.assetlinkViolationCode) {\n      this.appendIssueDetailCell(element, details.packageName || '');\n      this.appendIssueDetailCell(element, details.url);\n      this.appendIssueDetailCell(element, details.signature || '');\n    }\n\n    this.affectedResources.appendChild(element);\n  }\n\n  private appendDetails(twaIssues: Iterable<IssuesManager.TrustedWebActivityIssue.TrustedWebActivityIssue>): void {\n    const header = document.createElement('tr');\n    if (this.issue.code() === IssuesManager.TrustedWebActivityIssue.httpViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.statusCode));\n      this.appendColumnTitle(header, i18nString(UIStrings.url));\n    } else if (this.issue.code() === IssuesManager.TrustedWebActivityIssue.offlineViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.url));\n    } else if (this.issue.code() === IssuesManager.TrustedWebActivityIssue.assetlinkViolationCode) {\n      this.appendColumnTitle(header, i18nString(UIStrings.packageName));\n      this.appendColumnTitle(header, i18nString(UIStrings.url));\n      this.appendColumnTitle(header, i18nString(UIStrings.packageSignature));\n    }\n    this.affectedResources.appendChild(header);\n\n    let count = 0;\n    for (const twaIssue of twaIssues) {\n      this.appendDetail(twaIssue);\n      count++;\n    }\n    this.updateAffectedResourceCount(count);\n  }\n\n  update(): void {\n    this.clear();\n    this.appendDetails(this.issue.getTrustedWebActivityIssues());\n  }\n}\n"]}