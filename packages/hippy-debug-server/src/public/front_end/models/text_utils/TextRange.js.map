{"version":3,"file":"TextRange.js","sourceRoot":"","sources":["../../../../../../front_end/models/text_utils/TextRange.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2013 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as Platform from '../../core/platform/platform.js';\n\nexport class TextRange {\n  startLine: number;\n  startColumn: number;\n  endLine: number;\n  endColumn: number;\n\n  constructor(startLine: number, startColumn: number, endLine: number, endColumn: number) {\n    this.startLine = startLine;\n    this.startColumn = startColumn;\n    this.endLine = endLine;\n    this.endColumn = endColumn;\n  }\n\n  static createFromLocation(line: number, column: number): TextRange {\n    return new TextRange(line, column, line, column);\n  }\n\n  static fromObject(serializedTextRange: {\n    startLine: number,\n    startColumn: number,\n    endLine: number,\n    endColumn: number,\n  }): TextRange {\n    return new TextRange(\n        serializedTextRange.startLine, serializedTextRange.startColumn, serializedTextRange.endLine,\n        serializedTextRange.endColumn);\n  }\n\n  static comparator(range1: TextRange, range2: TextRange): number {\n    return range1.compareTo(range2);\n  }\n\n  static fromEdit(oldRange: TextRange, newText: string): TextRange {\n    let endLine: number = oldRange.startLine;\n    let endColumn: number = oldRange.startColumn + newText.length;\n\n    const lineEndings = Platform.StringUtilities.findLineEndingIndexes(newText);\n    if (lineEndings.length > 1) {\n      endLine = oldRange.startLine + lineEndings.length - 1;\n      const len = lineEndings.length;\n      endColumn = lineEndings[len - 1] - lineEndings[len - 2] - 1;\n    }\n    return new TextRange(oldRange.startLine, oldRange.startColumn, endLine, endColumn);\n  }\n\n  isEmpty(): boolean {\n    return this.startLine === this.endLine && this.startColumn === this.endColumn;\n  }\n\n  immediatelyPrecedes(range?: TextRange): boolean {\n    if (!range) {\n      return false;\n    }\n    return this.endLine === range.startLine && this.endColumn === range.startColumn;\n  }\n\n  immediatelyFollows(range?: TextRange): boolean {\n    if (!range) {\n      return false;\n    }\n    return range.immediatelyPrecedes(this);\n  }\n\n  follows(range: TextRange): boolean {\n    return (range.endLine === this.startLine && range.endColumn <= this.startColumn) || range.endLine < this.startLine;\n  }\n\n  get linesCount(): number {\n    return this.endLine - this.startLine;\n  }\n\n  collapseToEnd(): TextRange {\n    return new TextRange(this.endLine, this.endColumn, this.endLine, this.endColumn);\n  }\n\n  collapseToStart(): TextRange {\n    return new TextRange(this.startLine, this.startColumn, this.startLine, this.startColumn);\n  }\n\n  normalize(): TextRange {\n    if (this.startLine > this.endLine || (this.startLine === this.endLine && this.startColumn > this.endColumn)) {\n      return new TextRange(this.endLine, this.endColumn, this.startLine, this.startColumn);\n    }\n    return this.clone();\n  }\n\n  clone(): TextRange {\n    return new TextRange(this.startLine, this.startColumn, this.endLine, this.endColumn);\n  }\n\n  serializeToObject(): {\n    startLine: number,\n    startColumn: number,\n    endLine: number,\n    endColumn: number,\n  } {\n    return {\n      startLine: this.startLine,\n      startColumn: this.startColumn,\n      endLine: this.endLine,\n      endColumn: this.endColumn,\n    };\n  }\n\n  compareTo(other: TextRange): number {\n    if (this.startLine > other.startLine) {\n      return 1;\n    }\n    if (this.startLine < other.startLine) {\n      return -1;\n    }\n    if (this.startColumn > other.startColumn) {\n      return 1;\n    }\n    if (this.startColumn < other.startColumn) {\n      return -1;\n    }\n    return 0;\n  }\n\n  compareToPosition(lineNumber: number, columnNumber: number): number {\n    if (lineNumber < this.startLine || (lineNumber === this.startLine && columnNumber < this.startColumn)) {\n      return -1;\n    }\n    if (lineNumber > this.endLine || (lineNumber === this.endLine && columnNumber > this.endColumn)) {\n      return 1;\n    }\n    return 0;\n  }\n\n  equal(other: TextRange): boolean {\n    return this.startLine === other.startLine && this.endLine === other.endLine &&\n        this.startColumn === other.startColumn && this.endColumn === other.endColumn;\n  }\n\n  relativeTo(line: number, column: number): TextRange {\n    const relative = this.clone();\n\n    if (this.startLine === line) {\n      relative.startColumn -= column;\n    }\n    if (this.endLine === line) {\n      relative.endColumn -= column;\n    }\n\n    relative.startLine -= line;\n    relative.endLine -= line;\n    return relative;\n  }\n\n  relativeFrom(line: number, column: number): TextRange {\n    const relative = this.clone();\n\n    if (this.startLine === 0) {\n      relative.startColumn += column;\n    }\n    if (this.endLine === 0) {\n      relative.endColumn += column;\n    }\n\n    relative.startLine += line;\n    relative.endLine += line;\n    return relative;\n  }\n\n  rebaseAfterTextEdit(originalRange: TextRange, editedRange: TextRange): TextRange {\n    console.assert(originalRange.startLine === editedRange.startLine);\n    console.assert(originalRange.startColumn === editedRange.startColumn);\n    const rebase = this.clone();\n    if (!this.follows(originalRange)) {\n      return rebase;\n    }\n    const lineDelta = editedRange.endLine - originalRange.endLine;\n    const columnDelta = editedRange.endColumn - originalRange.endColumn;\n    rebase.startLine += lineDelta;\n    rebase.endLine += lineDelta;\n    if (rebase.startLine === editedRange.endLine) {\n      rebase.startColumn += columnDelta;\n    }\n    if (rebase.endLine === editedRange.endLine) {\n      rebase.endColumn += columnDelta;\n    }\n    return rebase;\n  }\n\n  toString(): string {\n    return JSON.stringify(this);\n  }\n\n  containsLocation(lineNumber: number, columnNumber: number): boolean {\n    if (this.startLine === this.endLine) {\n      return this.startLine === lineNumber && this.startColumn <= columnNumber && columnNumber <= this.endColumn;\n    }\n    if (this.startLine === lineNumber) {\n      return this.startColumn <= columnNumber;\n    }\n    if (this.endLine === lineNumber) {\n      return columnNumber <= this.endColumn;\n    }\n    return this.startLine < lineNumber && lineNumber < this.endLine;\n  }\n}\n\nexport class SourceRange {\n  offset: number;\n  length: number;\n  constructor(offset: number, length: number) {\n    this.offset = offset;\n    this.length = length;\n  }\n}\n\nexport class SourceEdit {\n  sourceURL: string;\n  oldRange: TextRange;\n  newText: string;\n  constructor(sourceURL: string, oldRange: TextRange, newText: string) {\n    this.sourceURL = sourceURL;\n    this.oldRange = oldRange;\n    this.newText = newText;\n  }\n\n  static comparator(edit1: SourceEdit, edit2: SourceEdit): number {\n    return TextRange.comparator(edit1.oldRange, edit2.oldRange);\n  }\n\n  newRange(): TextRange {\n    return TextRange.fromEdit(this.oldRange, this.newText);\n  }\n}\n"]}