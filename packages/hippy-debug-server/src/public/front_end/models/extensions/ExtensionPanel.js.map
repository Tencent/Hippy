{"version":3,"file":"ExtensionPanel.js","sourceRoot":"","sources":["../../../../../../front_end/models/extensions/ExtensionPanel.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2012 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as _ProtocolClient from '../../core/protocol_client/protocol_client.js';  // eslint-disable-line @typescript-eslint/no-unused-vars\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport type {ExtensionServer} from './ExtensionServer.js'; // eslint-disable-line no-unused-vars\nimport {ExtensionNotifierView, ExtensionView} from './ExtensionView.js';\n\nexport class ExtensionPanel extends UI.Panel.Panel implements UI.SearchableView.Searchable {\n  _server: ExtensionServer;\n  _id: string;\n  _panelToolbar: UI.Toolbar.Toolbar;\n  _searchableView: UI.SearchableView.SearchableView;\n\n  constructor(server: ExtensionServer, panelName: string, id: string, pageURL: string) {\n    super(panelName);\n    this._server = server;\n    this._id = id;\n    this.setHideOnDetach();\n    this._panelToolbar = new UI.Toolbar.Toolbar('hidden', this.element);\n\n    this._searchableView = new UI.SearchableView.SearchableView(this, null);\n    this._searchableView.show(this.element);\n\n    const extensionView = new ExtensionView(server, this._id, pageURL, 'extension');\n    extensionView.show(this._searchableView.element);\n  }\n\n  addToolbarItem(item: UI.Toolbar.ToolbarItem): void {\n    this._panelToolbar.element.classList.remove('hidden');\n    this._panelToolbar.appendToolbarItem(item);\n  }\n\n  searchCanceled(): void {\n    // @ts-expect-error TODO(crbug.com/1011811): Fix after extensionAPI is migrated.\n    this._server.notifySearchAction(this._id, Extensions.extensionAPI.panels.SearchAction.CancelSearch);\n    this._searchableView.updateSearchMatchesCount(0);\n  }\n\n  searchableView(): UI.SearchableView.SearchableView {\n    return this._searchableView;\n  }\n\n  performSearch(searchConfig: UI.SearchableView.SearchConfig, _shouldJump: boolean, _jumpBackwards?: boolean): void {\n    const query = searchConfig.query;\n    // @ts-expect-error TODO(crbug.com/1011811): Fix after extensionAPI is migrated.\n    this._server.notifySearchAction(this._id, Extensions.extensionAPI.panels.SearchAction.PerformSearch, query);\n  }\n\n  jumpToNextSearchResult(): void {\n    // @ts-expect-error TODO(crbug.com/1011811): Fix after extensionAPI is migrated.\n    this._server.notifySearchAction(this._id, Extensions.extensionAPI.panels.SearchAction.NextSearchResult);\n  }\n\n  jumpToPreviousSearchResult(): void {\n    // @ts-expect-error TODO(crbug.com/1011811): Fix after extensionAPI is migrated.\n    this._server.notifySearchAction(this._id, Extensions.extensionAPI.panels.SearchAction.PreviousSearchResult);\n  }\n\n  supportsCaseSensitiveSearch(): boolean {\n    return false;\n  }\n\n  supportsRegexSearch(): boolean {\n    return false;\n  }\n}\n\nexport class ExtensionButton {\n  _id: string;\n  _toolbarButton: UI.Toolbar.ToolbarButton;\n  constructor(server: ExtensionServer, id: string, iconURL: string, tooltip?: string, disabled?: boolean) {\n    this._id = id;\n\n    this._toolbarButton = new UI.Toolbar.ToolbarButton('', '');\n    this._toolbarButton.addEventListener(\n        UI.Toolbar.ToolbarButton.Events.Click, server.notifyButtonClicked.bind(server, this._id));\n    this.update(iconURL, tooltip, disabled);\n  }\n\n  update(iconURL: string, tooltip?: string, disabled?: boolean): void {\n    if (typeof iconURL === 'string') {\n      this._toolbarButton.setBackgroundImage(iconURL);\n    }\n    if (typeof tooltip === 'string') {\n      this._toolbarButton.setTitle(tooltip);\n    }\n    if (typeof disabled === 'boolean') {\n      this._toolbarButton.setEnabled(!disabled);\n    }\n  }\n\n  toolbarButton(): UI.Toolbar.ToolbarButton {\n    return this._toolbarButton;\n  }\n}\n\nexport class ExtensionSidebarPane extends UI.View.SimpleView {\n  _panelName: string;\n  _server: ExtensionServer;\n  _id: string;\n  _extensionView?: ExtensionView;\n  _objectPropertiesView?: ExtensionNotifierView;\n  constructor(server: ExtensionServer, panelName: string, title: string, id: string) {\n    super(title);\n    this.element.classList.add('fill');\n    this._panelName = panelName;\n    this._server = server;\n    this._id = id;\n  }\n\n  id(): string {\n    return this._id;\n  }\n\n  panelName(): string {\n    return this._panelName;\n  }\n\n  setObject(object: Object, title: string, callback: (arg0?: (string|null)|undefined) => void): void {\n    this._createObjectPropertiesView();\n    this._setObject(SDK.RemoteObject.RemoteObject.fromLocalObject(object), title, callback);\n  }\n\n  setExpression(\n      expression: string, title: string, evaluateOptions: Object, securityOrigin: string,\n      callback: (arg0?: (string|null)|undefined) => void): void {\n    this._createObjectPropertiesView();\n    this._server.evaluate(\n        expression, true, false, evaluateOptions, securityOrigin, this._onEvaluate.bind(this, title, callback));\n  }\n\n  setPage(url: string): void {\n    if (this._objectPropertiesView) {\n      this._objectPropertiesView.detach();\n      delete this._objectPropertiesView;\n    }\n    if (this._extensionView) {\n      this._extensionView.detach(true);\n    }\n\n    this._extensionView = new ExtensionView(this._server, this._id, url, 'extension fill');\n    this._extensionView.show(this.element);\n\n    if (!this.element.style.height) {\n      this.setHeight('150px');\n    }\n  }\n\n  setHeight(height: string): void {\n    this.element.style.height = height;\n  }\n\n  _onEvaluate(\n      title: string, callback: (arg0?: (string|null)|undefined) => void, error: string|null,\n      result: SDK.RemoteObject.RemoteObject|null, _wasThrown?: boolean): void {\n    if (error) {\n      callback(error.toString());\n    } else if (!result) {\n      callback();\n    } else {\n      this._setObject(result, title, callback);\n    }\n  }\n\n  _createObjectPropertiesView(): void {\n    if (this._objectPropertiesView) {\n      return;\n    }\n    if (this._extensionView) {\n      this._extensionView.detach(true);\n      delete this._extensionView;\n    }\n    this._objectPropertiesView = new ExtensionNotifierView(this._server, this._id);\n    this._objectPropertiesView.show(this.element);\n  }\n\n  _setObject(object: SDK.RemoteObject.RemoteObject, title: string, callback: (arg0?: (string|null)|undefined) => void):\n      void {\n    const objectPropertiesView = this._objectPropertiesView;\n    // This may only happen if setPage() was called while we were evaluating the expression.\n    if (!objectPropertiesView) {\n      callback('operation cancelled');\n      return;\n    }\n    objectPropertiesView.element.removeChildren();\n    UI.UIUtils.Renderer.render(object, {title, editable: false}).then(result => {\n      if (!result) {\n        callback();\n        return;\n      }\n      const firstChild = result.tree && result.tree.firstChild();\n      if (firstChild) {\n        firstChild.expand();\n      }\n      objectPropertiesView.element.appendChild(result.node);\n      callback();\n    });\n  }\n}\n"]}