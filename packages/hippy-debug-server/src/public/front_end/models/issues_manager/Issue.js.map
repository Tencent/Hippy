{"version":3,"file":"Issue.js","sourceRoot":"","sources":["../../../../../../front_end/models/issues_manager/Issue.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\n\nimport type {MarkdownIssueDescription} from './MarkdownIssueDescription.js';\n\n// eslint-disable-next-line rulesdir/const_enum\nexport enum IssueCategory {\n  CrossOriginEmbedderPolicy = 'CrossOriginEmbedderPolicy',\n  MixedContent = 'MixedContent',\n  SameSiteCookie = 'SameSiteCookie',\n  HeavyAd = 'HeavyAd',\n  ContentSecurityPolicy = 'ContentSecurityPolicy',\n  TrustedWebActivity = 'TrustedWebActivity',\n  LowTextContrast = 'LowTextContrast',\n  Cors = 'Cors',\n  AttributionReporting = 'AttributionReporting',\n  QuirksMode = 'QuirksMode',\n  Other = 'Other',\n}\n\n// eslint-disable-next-line rulesdir/const_enum\nexport enum IssueKind {\n  BreakingChange = 'BreakingChange',\n  PageError = 'PageError',\n  Improvement = 'Improvement',\n}\n\n/**\n * Union two issue kinds for issue aggregation. The idea is to show the most\n * important kind on aggregated issues that union issues of different kinds.\n */\nexport function unionIssueKind(a: IssueKind, b: IssueKind): IssueKind {\n  if (a === IssueKind.PageError || b === IssueKind.PageError) {\n    return IssueKind.PageError;\n  }\n  if (a === IssueKind.BreakingChange || b === IssueKind.BreakingChange) {\n    return IssueKind.BreakingChange;\n  }\n  return IssueKind.Improvement;\n}\n\nexport function getShowThirdPartyIssuesSetting(): Common.Settings.Setting<boolean> {\n  return Common.Settings.Settings.instance().createSetting('showThirdPartyIssues', false);\n}\n\nexport interface AffectedElement {\n  backendNodeId: number;\n  nodeName: string;\n  target: SDK.Target.Target|null;\n}\n\nexport abstract class Issue<IssueCode extends string = string> extends Common.ObjectWrapper.ObjectWrapper {\n  private issueCode: IssueCode;\n  private issuesModel: SDK.IssuesModel.IssuesModel|null;\n\n  constructor(\n      code: IssueCode|{code: IssueCode, umaCode: string}, issuesModel: SDK.IssuesModel.IssuesModel|null = null) {\n    super();\n    this.issueCode = typeof code === 'object' ? code.code : code;\n    this.issuesModel = issuesModel;\n    Host.userMetrics.issueCreated(typeof code === 'string' ? code : code.umaCode);\n  }\n\n  code(): IssueCode {\n    return this.issueCode;\n  }\n\n  abstract primaryKey(): string;\n  abstract getDescription(): MarkdownIssueDescription|null;\n  abstract getCategory(): IssueCategory;\n  abstract getKind(): IssueKind;\n\n  getBlockedByResponseDetails(): Iterable<Protocol.Audits.BlockedByResponseIssueDetails> {\n    return [];\n  }\n\n  cookies(): Iterable<Protocol.Audits.AffectedCookie> {\n    return [];\n  }\n\n  elements(): Iterable<AffectedElement> {\n    return [];\n  }\n\n  requests(): Iterable<Protocol.Audits.AffectedRequest> {\n    return [];\n  }\n\n  sources(): Iterable<Protocol.Audits.SourceCodeLocation> {\n    return [];\n  }\n\n  isAssociatedWithRequestId(requestId: string): boolean {\n    for (const request of this.requests()) {\n      if (request.requestId === requestId) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * The model might be unavailable or belong to a target that has already been disposed.\n   */\n  model(): SDK.IssuesModel.IssuesModel|null {\n    return this.issuesModel;\n  }\n\n  isCausedByThirdParty(): boolean {\n    return false;\n  }\n}\n\nexport function toZeroBasedLocation(location: Protocol.Audits.SourceCodeLocation|undefined):\n    {url: string, scriptId: string|undefined, lineNumber: number, columnNumber: number|undefined}|undefined {\n  if (!location) {\n    return undefined;\n  }\n  return {\n    url: location.url,\n    scriptId: location.scriptId,\n    lineNumber: location.lineNumber,\n    columnNumber: location.columnNumber === 0 ? undefined : location.columnNumber - 1,\n  };\n}\n"]}