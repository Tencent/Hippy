{"version":3,"file":"SameSiteCookieIssue.js","sourceRoot":"","sources":["../../../../../../front_end/models/issues_manager/SameSiteCookieIssue.ts"],"names":[],"mappings":"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","sourcesContent":["\n// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\n\nimport {Issue, IssueCategory, IssueKind} from './Issue.js';\nimport type {LazyMarkdownIssueDescription, MarkdownIssueDescription} from './MarkdownIssueDescription.js';\nimport {resolveLazyDescription} from './MarkdownIssueDescription.js';\n\n\nconst UIStrings = {\n  /**\n  *@description Label for the link for SameSiteCookies Issues\n  */\n  samesiteCookiesExplained: 'SameSite cookies explained',\n  /**\n  *@description Label for the link for Schemeful Same-Site Issues\n  */\n  howSchemefulSamesiteWorks: 'How Schemeful Same-Site Works',\n  /**\n  *@description Phrase used to describe the security of a context. Substitued like 'a secure context' or 'a secure origin'.\n  */\n  aSecure: 'a secure',\n  /**\n  *@description Phrase used to describe the security of a context. Substitued like 'an insecure context' or 'an insecure origin'.\n  */\n  anInsecure: 'an insecure',\n};\nconst str_ = i18n.i18n.registerUIStrings('models/issues_manager/SameSiteCookieIssue.ts', UIStrings);\nconst i18nLazyString = i18n.i18n.getLazilyComputedLocalizedString.bind(undefined, str_);\n\nexport class SameSiteCookieIssue extends Issue {\n  private issueDetails: Protocol.Audits.SameSiteCookieIssueDetails;\n\n  constructor(\n      code: string, issueDetails: Protocol.Audits.SameSiteCookieIssueDetails,\n      issuesModel: SDK.IssuesModel.IssuesModel) {\n    super(code, issuesModel);\n    this.issueDetails = issueDetails;\n  }\n\n  private cookieId(): string {\n    if (this.issueDetails.cookie) {\n      const {domain, path, name} = this.issueDetails.cookie;\n      const cookieId = `${domain};${path};${name}`;\n      return cookieId;\n    }\n    return this.issueDetails.rawCookieLine ?? 'no-cookie-info';\n  }\n\n  primaryKey(): string {\n    const requestId = this.issueDetails.request ? this.issueDetails.request.requestId : 'no-request';\n    return `${this.code()}-(${this.cookieId()})-(${requestId})`;\n  }\n\n  /**\n   * Returns an array of issues from a given SameSiteCookieIssueDetails.\n   */\n  static createIssuesFromSameSiteDetails(\n      sameSiteDetails: Protocol.Audits.SameSiteCookieIssueDetails,\n      issuesModel: SDK.IssuesModel.IssuesModel): SameSiteCookieIssue[] {\n    /** @type {!Array<!Issue>} */\n    const issues = [];\n\n    // Exclusion reasons have priority. It means a cookie was blocked. Create an issue\n    // for every exclusion reason but ignore warning reasons if the cookie was blocked.\n    // Some exclusion reasons are dependent on warning reasons existing in order to produce an issue.\n    if (sameSiteDetails.cookieExclusionReasons && sameSiteDetails.cookieExclusionReasons.length > 0) {\n      for (const exclusionReason of sameSiteDetails.cookieExclusionReasons) {\n        const code = SameSiteCookieIssue.codeForSameSiteDetails(\n            exclusionReason, sameSiteDetails.cookieWarningReasons, sameSiteDetails.operation,\n            sameSiteDetails.cookieUrl);\n        if (code) {\n          issues.push(new SameSiteCookieIssue(code, sameSiteDetails, issuesModel));\n        }\n      }\n      return issues;\n    }\n\n    if (sameSiteDetails.cookieWarningReasons) {\n      for (const warningReason of sameSiteDetails.cookieWarningReasons) {\n        // warningReasons should be an empty array here.\n        const code = SameSiteCookieIssue.codeForSameSiteDetails(\n            warningReason, [], sameSiteDetails.operation, sameSiteDetails.cookieUrl);\n        if (code) {\n          issues.push(new SameSiteCookieIssue(code, sameSiteDetails, issuesModel));\n        }\n      }\n    }\n    return issues;\n  }\n\n  /**\n   * Calculates an issue code from a reason, an operation, and an array of warningReasons. All these together\n   * can uniquely identify a specific SameSite cookie issue.\n   * warningReasons is only needed for some SameSiteCookieExclusionReason in order to determine if an issue should be raised.\n   * It is not required if reason is a SameSiteCookieWarningReason.\n   */\n  static codeForSameSiteDetails(\n      reason: Protocol.Audits.SameSiteCookieExclusionReason|Protocol.Audits.SameSiteCookieWarningReason,\n      warningReasons: Protocol.Audits.SameSiteCookieWarningReason[], operation: Protocol.Audits.SameSiteCookieOperation,\n      cookieUrl?: string): string|null {\n    const isURLSecure = cookieUrl && (cookieUrl.startsWith('https://') || cookieUrl.startsWith('wss://'));\n    const secure = isURLSecure ? 'Secure' : 'Insecure';\n\n    if (reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteStrict ||\n        reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteLax ||\n        reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteUnspecifiedTreatedAsLax) {\n      if (warningReasons && warningReasons.length > 0) {\n        if (warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictLaxDowngradeStrict)) {\n          return [\n            Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue,\n            'ExcludeNavigationContextDowngrade',\n            secure,\n          ].join('::');\n        }\n\n        if (warningReasons.includes(\n                Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeStrict) ||\n            warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeLax) ||\n            warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeStrict) ||\n            warningReasons.includes(Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeLax)) {\n          return [\n            Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue,\n            'ExcludeContextDowngrade',\n            operation,\n            secure,\n          ].join('::');\n        }\n      }\n\n      // If we have ExcludeSameSiteUnspecifiedTreatedAsLax but no corresponding warnings, then add just\n      // the Issue code for ExcludeSameSiteUnspecifiedTreatedAsLax.\n      if (reason === Protocol.Audits.SameSiteCookieExclusionReason.ExcludeSameSiteUnspecifiedTreatedAsLax) {\n        return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, reason, operation].join('::');\n      }\n\n      // ExcludeSameSiteStrict and ExcludeSameSiteLax require being paired with an appropriate warning. We didn't\n      // find one of those warnings so return null to indicate there shouldn't be an issue created.\n      return null;\n    }\n\n    if (reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictLaxDowngradeStrict) {\n      return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, reason, secure].join('::');\n    }\n    // These have the same message.\n    if (reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeStrict ||\n        reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteStrictCrossDowngradeLax ||\n        reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeLax ||\n        reason === Protocol.Audits.SameSiteCookieWarningReason.WarnSameSiteLaxCrossDowngradeStrict) {\n      return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, 'WarnCrossDowngrade', operation, secure].join(\n          '::');\n    }\n    return [Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue, reason, operation].join('::');\n  }\n\n  cookies(): Iterable<Protocol.Audits.AffectedCookie> {\n    if (this.issueDetails.cookie) {\n      return [this.issueDetails.cookie];\n    }\n    return [];\n  }\n\n  requests(): Iterable<Protocol.Audits.AffectedRequest> {\n    if (this.issueDetails.request) {\n      return [this.issueDetails.request];\n    }\n    return [];\n  }\n\n  getCategory(): IssueCategory {\n    return IssueCategory.SameSiteCookie;\n  }\n\n  getDescription(): MarkdownIssueDescription|null {\n    const description = issueDescriptions.get(this.code());\n    if (!description) {\n      return null;\n    }\n    return resolveLazyDescription(description);\n  }\n\n  isCausedByThirdParty(): boolean {\n    const topFrame = SDK.FrameManager.FrameManager.instance().getTopFrame();\n    return isCausedByThirdParty(topFrame, this.issueDetails.cookieUrl);\n  }\n\n  getKind(): IssueKind {\n    if (this.issueDetails.cookieExclusionReasons?.length > 0) {\n      return IssueKind.PageError;\n    }\n    return IssueKind.BreakingChange;\n  }\n\n  static fromInspectorIssue(issuesModel: SDK.IssuesModel.IssuesModel, inspectorIssue: Protocol.Audits.InspectorIssue):\n      SameSiteCookieIssue[] {\n    const sameSiteDetails = inspectorIssue.details.sameSiteCookieIssueDetails;\n    if (!sameSiteDetails) {\n      console.warn('SameSite issue without details received.');\n      return [];\n    }\n\n    return SameSiteCookieIssue.createIssuesFromSameSiteDetails(sameSiteDetails, issuesModel);\n  }\n}\n\n/**\n * Exported for unit test.\n */\nexport function isCausedByThirdParty(\n    topFrame: SDK.ResourceTreeModel.ResourceTreeFrame|null, cookieUrl?: string): boolean {\n  if (!topFrame) {\n    // The top frame is not yet available. Consider this issue as a third-party issue\n    // until the top frame is available. This will prevent the issue from being visible\n    // for only just a split second.\n    return true;\n  }\n\n  // In the case of no domain and registry, we assume its an IP address or localhost\n  // during development, in this case we classify the issue as first-party.\n  if (!cookieUrl || topFrame.domainAndRegistry() === '') {\n    return false;\n  }\n\n  const parsedCookieUrl = Common.ParsedURL.ParsedURL.fromString(cookieUrl);\n  if (!parsedCookieUrl) {\n    return false;\n  }\n\n  // For both operation types we compare the cookieUrl's domain  with the top frames\n  // registered domain to determine first-party vs third-party. If they don't match\n  // then we consider this issue a third-party issue.\n  //\n  // For a Set operation: The Set-Cookie response is part of a request to a third-party.\n  //\n  // For a Read operation: The cookie was included in a request to a third-party\n  //     site. Only cookies that have their domain also set to this third-party\n  //     are included in the request. We assume that the cookie was set by the same\n  //     third-party at some point, so we treat this as a third-party issue.\n  //\n  // TODO(crbug.com/1080589): Use \"First-Party sets\" instead of the sites registered domain.\n  return !isSubdomainOf(parsedCookieUrl.domain(), topFrame.domainAndRegistry());\n}\n\nfunction isSubdomainOf(subdomain: string, superdomain: string): boolean {\n  // Subdomain must be identical or have strictly more labels than the\n  // superdomain.\n  if (subdomain.length <= superdomain.length) {\n    return subdomain === superdomain;\n  }\n\n  // Superdomain must be suffix of subdomain, and the last character not\n  // included in the matching substring must be a dot.\n  if (!subdomain.endsWith(superdomain)) {\n    return false;\n  }\n\n  const subdomainWithoutSuperdomian = subdomain.substr(0, subdomain.length - superdomain.length);\n  return subdomainWithoutSuperdomian.endsWith('.');\n}\n\nconst sameSiteUnspecifiedErrorRead: LazyMarkdownIssueDescription = {\n  file: 'SameSiteUnspecifiedTreatedAsLaxRead.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteUnspecifiedErrorSet: LazyMarkdownIssueDescription = {\n  file: 'SameSiteUnspecifiedTreatedAsLaxSet.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteUnspecifiedWarnRead: LazyMarkdownIssueDescription = {\n  file: 'SameSiteUnspecifiedLaxAllowUnsafeRead.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteUnspecifiedWarnSet: LazyMarkdownIssueDescription = {\n  file: 'SameSiteUnspecifiedLaxAllowUnsafeSet.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteNoneInsecureErrorRead: LazyMarkdownIssueDescription = {\n  file: 'SameSiteNoneInsecureErrorRead.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteNoneInsecureErrorSet: LazyMarkdownIssueDescription = {\n  file: 'SameSiteNoneInsecureErrorSet.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteNoneInsecureWarnRead: LazyMarkdownIssueDescription = {\n  file: 'SameSiteNoneInsecureWarnRead.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst sameSiteNoneInsecureWarnSet: LazyMarkdownIssueDescription = {\n  file: 'SameSiteNoneInsecureWarnSet.md',\n  links: [\n    {\n      link: 'https://web.dev/samesite-cookies-explained/',\n      linkTitle: i18nLazyString(UIStrings.samesiteCookiesExplained),\n    },\n  ],\n};\n\nconst schemefulSameSiteArticles =\n    [{link: 'https://web.dev/schemeful-samesite/', linkTitle: i18nLazyString(UIStrings.howSchemefulSamesiteWorks)}];\n\nfunction sameSiteWarnStrictLaxDowngradeStrict(isSecure: boolean): LazyMarkdownIssueDescription {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n    ['PLACEHOLDER_origin', !isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n  ]);\n  return {\n    file: 'SameSiteWarnStrictLaxDowngradeStrict.md',\n    substitutions,\n    links: schemefulSameSiteArticles,\n  };\n}\n\nfunction sameSiteExcludeNavigationContextDowngrade(isSecure: boolean): LazyMarkdownIssueDescription {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n    ['PLACEHOLDER_origin', !isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n  ]);\n  return {\n    file: 'SameSiteExcludeNavigationContextDowngrade.md',\n    substitutions,\n    links: schemefulSameSiteArticles,\n  };\n}\n\nfunction sameSiteWarnCrossDowngradeRead(isSecure: boolean): LazyMarkdownIssueDescription {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n    ['PLACEHOLDER_origin', !isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n  ]);\n  return {\n    file: 'SameSiteWarnCrossDowngradeRead.md',\n    substitutions,\n    links: schemefulSameSiteArticles,\n  };\n}\n\nfunction sameSiteExcludeContextDowngradeRead(isSecure: boolean): LazyMarkdownIssueDescription {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n    ['PLACEHOLDER_origin', !isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n  ]);\n  return {\n    file: 'SameSiteExcludeContextDowngradeRead.md',\n    substitutions,\n    links: schemefulSameSiteArticles,\n  };\n}\n\nfunction sameSiteWarnCrossDowngradeSet(isSecure: boolean): LazyMarkdownIssueDescription {\n  const substitutions = new Map([\n    ['PLACEHOLDER_ORIGIN', isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n    ['PLACEHOLDER_DESTINATION', !isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n  ]);\n  return {\n    file: 'SameSiteWarnCrossDowngradeSet.md',\n    substitutions,\n    links: schemefulSameSiteArticles,\n  };\n}\n\nfunction sameSiteExcludeContextDowngradeSet(isSecure: boolean): LazyMarkdownIssueDescription {\n  const substitutions = new Map([\n    ['PLACEHOLDER_destination', isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n    ['PLACEHOLDER_origin', !isSecure ? i18nLazyString(UIStrings.aSecure) : i18nLazyString(UIStrings.anInsecure)],\n  ]);\n  return {\n    file: 'SameSiteExcludeContextDowngradeSet.md',\n    substitutions,\n    links: schemefulSameSiteArticles,\n  };\n}\n\nconst issueDescriptions: Map<string, LazyMarkdownIssueDescription> = new Map([\n  ['SameSiteCookieIssue::ExcludeSameSiteUnspecifiedTreatedAsLax::ReadCookie', sameSiteUnspecifiedErrorRead],\n  ['SameSiteCookieIssue::ExcludeSameSiteUnspecifiedTreatedAsLax::SetCookie', sameSiteUnspecifiedErrorSet],\n  // These two don't have a deprecation date yet, but they need to be fixed eventually.\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedLaxAllowUnsafe::ReadCookie', sameSiteUnspecifiedWarnRead],\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedLaxAllowUnsafe::SetCookie', sameSiteUnspecifiedWarnSet],\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedCrossSiteContext::ReadCookie', sameSiteUnspecifiedWarnRead],\n  ['SameSiteCookieIssue::WarnSameSiteUnspecifiedCrossSiteContext::SetCookie', sameSiteUnspecifiedWarnSet],\n  ['SameSiteCookieIssue::ExcludeSameSiteNoneInsecure::ReadCookie', sameSiteNoneInsecureErrorRead],\n  ['SameSiteCookieIssue::ExcludeSameSiteNoneInsecure::SetCookie', sameSiteNoneInsecureErrorSet],\n  ['SameSiteCookieIssue::WarnSameSiteNoneInsecure::ReadCookie', sameSiteNoneInsecureWarnRead],\n  ['SameSiteCookieIssue::WarnSameSiteNoneInsecure::SetCookie', sameSiteNoneInsecureWarnSet],\n  ['SameSiteCookieIssue::WarnSameSiteStrictLaxDowngradeStrict::Secure', sameSiteWarnStrictLaxDowngradeStrict(true)],\n  ['SameSiteCookieIssue::WarnSameSiteStrictLaxDowngradeStrict::Insecure', sameSiteWarnStrictLaxDowngradeStrict(false)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::ReadCookie::Secure', sameSiteWarnCrossDowngradeRead(true)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::ReadCookie::Insecure', sameSiteWarnCrossDowngradeRead(false)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::SetCookie::Secure', sameSiteWarnCrossDowngradeSet(true)],\n  ['SameSiteCookieIssue::WarnCrossDowngrade::SetCookie::Insecure', sameSiteWarnCrossDowngradeSet(false)],\n  ['SameSiteCookieIssue::ExcludeNavigationContextDowngrade::Secure', sameSiteExcludeNavigationContextDowngrade(true)],\n  [\n    'SameSiteCookieIssue::ExcludeNavigationContextDowngrade::Insecure',\n    sameSiteExcludeNavigationContextDowngrade(false),\n  ],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::ReadCookie::Secure', sameSiteExcludeContextDowngradeRead(true)],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::ReadCookie::Insecure', sameSiteExcludeContextDowngradeRead(false)],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::SetCookie::Secure', sameSiteExcludeContextDowngradeSet(true)],\n  ['SameSiteCookieIssue::ExcludeContextDowngrade::SetCookie::Insecure', sameSiteExcludeContextDowngradeSet(false)],\n]);\n"]}