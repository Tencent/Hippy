{"version":3,"file":"ResourceUtils.js","sourceRoot":"","sources":["../../../../../../front_end/models/bindings/ResourceUtils.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2006, 2007, 2008 Apple Inc.  All rights reserved.\n * Copyright (C) 2007 Matt Lilek (pewtermoose@gmail.com).\n * Copyright (C) 2009 Joseph Pecoraro\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n * 1.  Redistributions of source code must retain the above copyright\n *     notice, this list of conditions and the following disclaimer.\n * 2.  Redistributions in binary form must reproduce the above copyright\n *     notice, this list of conditions and the following disclaimer in the\n *     documentation and/or other materials provided with the distribution.\n * 3.  Neither the name of Apple Computer, Inc. (\"Apple\") nor the names of\n *     its contributors may be used to endorse or promote products derived\n *     from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as Common from '../../core/common/common.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Workspace from '../workspace/workspace.js';\n\nexport function resourceForURL(url: string): SDK.Resource.Resource|null {\n  for (const resourceTreeModel of SDK.TargetManager.TargetManager.instance().models(\n           SDK.ResourceTreeModel.ResourceTreeModel)) {\n    const resource = resourceTreeModel.resourceForURL(url);\n    if (resource) {\n      return resource;\n    }\n  }\n  return null;\n}\n\nexport function displayNameForURL(url: string): string {\n  if (!url) {\n    return '';\n  }\n\n  const resource = resourceForURL(url);\n  if (resource) {\n    return resource.displayName;\n  }\n\n  const uiSourceCode = Workspace.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(url);\n  if (uiSourceCode) {\n    return uiSourceCode.displayName();\n  }\n\n  const mainTarget = SDK.TargetManager.TargetManager.instance().mainTarget();\n  const inspectedURL = mainTarget && mainTarget.inspectedURL();\n  if (!inspectedURL) {\n    return Platform.StringUtilities.trimURL(url, '');\n  }\n\n  const parsedURL = Common.ParsedURL.ParsedURL.fromString(inspectedURL);\n  if (!parsedURL) {\n    return url;\n  }\n\n  const lastPathComponent = parsedURL.lastPathComponent;\n  const index = inspectedURL.indexOf(lastPathComponent);\n  if (index !== -1 && index + lastPathComponent.length === inspectedURL.length) {\n    const baseURL = inspectedURL.substring(0, index);\n    if (url.startsWith(baseURL)) {\n      return url.substring(index);\n    }\n  }\n\n  const displayName = Platform.StringUtilities.trimURL(url, parsedURL.host);\n  return displayName === '/' ? parsedURL.host + '/' : displayName;\n}\n\nexport function metadataForURL(\n    target: SDK.Target.Target, frameId: string, url: string): Workspace.UISourceCode.UISourceCodeMetadata|null {\n  const resourceTreeModel = target.model(SDK.ResourceTreeModel.ResourceTreeModel);\n  if (!resourceTreeModel) {\n    return null;\n  }\n  const frame = resourceTreeModel.frameForId(frameId);\n  if (!frame) {\n    return null;\n  }\n  return resourceMetadata(frame.resourceForURL(url));\n}\n\nexport function resourceMetadata(resource: SDK.Resource.Resource|null): Workspace.UISourceCode.UISourceCodeMetadata|\n    null {\n  if (!resource || (typeof resource.contentSize() !== 'number' && !resource.lastModified())) {\n    return null;\n  }\n  return new Workspace.UISourceCode.UISourceCodeMetadata(resource.lastModified(), resource.contentSize());\n}\n"]}