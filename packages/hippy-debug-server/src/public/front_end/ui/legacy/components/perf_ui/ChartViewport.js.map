{"version":3,"file":"ChartViewport.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/perf_ui/ChartViewport.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as Common from '../../../../core/common/common.js';\nimport * as i18n from '../../../../core/i18n/i18n.js';\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as UI from '../../legacy.js';\n\nimport {MinimalTimeWindowMs} from './FlameChart.js';\n\nexport interface ChartViewportDelegate {\n  windowChanged(startTime: number, endTime: number, animate: boolean): void;\n  updateRangeSelection(startTime: number, endTime: number): void;\n  setSize(width: number, height: number): void;\n  update(): void;\n}\n\nexport class ChartViewport extends UI.Widget.VBox {\n  _delegate: ChartViewportDelegate;\n  viewportElement: HTMLElement;\n  _alwaysShowVerticalScroll: boolean;\n  _rangeSelectionEnabled: boolean;\n  _vScrollElement: HTMLElement;\n  _vScrollContent: HTMLElement;\n  _selectionOverlay: HTMLElement;\n  _selectedTimeSpanLabel: HTMLElement;\n  _cursorElement: HTMLElement;\n  _isDragging!: boolean;\n  _totalHeight!: number;\n  _offsetHeight!: number;\n  _scrollTop!: number;\n  _rangeSelectionStart: number|null;\n  _rangeSelectionEnd: number|null;\n  _dragStartPointX!: number;\n  _dragStartPointY!: number;\n  _dragStartScrollTop!: number;\n  _visibleLeftTime!: number;\n  _visibleRightTime!: number;\n  _offsetWidth!: number;\n  _targetLeftTime!: number;\n  _targetRightTime!: number;\n  _selectionOffsetShiftX!: number;\n  _selectionOffsetShiftY!: number;\n  _selectionStartX!: number|null;\n  _lastMouseOffsetX!: number;\n  _minimumBoundary!: number;\n  _totalTime!: number;\n  _updateTimerId?: number;\n  _cancelWindowTimesAnimation?: (() => void)|null;\n\n  constructor(delegate: ChartViewportDelegate) {\n    super();\n    this.registerRequiredCSS('ui/legacy/components/perf_ui/chartViewport.css', {enableLegacyPatching: false});\n\n    this._delegate = delegate;\n\n    this.viewportElement = this.contentElement.createChild('div', 'fill');\n    this.viewportElement.addEventListener('mousemove', this._updateCursorPosition.bind(this), false);\n    this.viewportElement.addEventListener('mouseout', this._onMouseOut.bind(this), false);\n    this.viewportElement.addEventListener('wheel', this._onMouseWheel.bind(this), false);\n    this.viewportElement.addEventListener('keydown', this._onChartKeyDown.bind(this), false);\n    this.viewportElement.addEventListener('keyup', this._onChartKeyUp.bind(this), false);\n\n    UI.UIUtils.installDragHandle(\n        this.viewportElement, this._startDragging.bind(this), this._dragging.bind(this), this._endDragging.bind(this),\n        '-webkit-grabbing', null);\n    UI.UIUtils.installDragHandle(\n        this.viewportElement, this._startRangeSelection.bind(this), this._rangeSelectionDragging.bind(this),\n        this._endRangeSelection.bind(this), 'text', null);\n\n    this._alwaysShowVerticalScroll = false;\n    this._rangeSelectionEnabled = true;\n    this._vScrollElement = this.contentElement.createChild('div', 'chart-viewport-v-scroll');\n    this._vScrollContent = this._vScrollElement.createChild('div');\n    this._vScrollElement.addEventListener('scroll', this._onScroll.bind(this), false);\n\n    this._selectionOverlay = this.contentElement.createChild('div', 'chart-viewport-selection-overlay hidden');\n    this._selectedTimeSpanLabel = this._selectionOverlay.createChild('div', 'time-span');\n\n    this._cursorElement = this.contentElement.createChild('div', 'chart-cursor-element hidden');\n\n    this.reset();\n\n    this._rangeSelectionStart = null;\n\n    this._rangeSelectionEnd = null;\n  }\n\n  alwaysShowVerticalScroll(): void {\n    this._alwaysShowVerticalScroll = true;\n    this._vScrollElement.classList.add('always-show-scrollbar');\n  }\n\n  disableRangeSelection(): void {\n    this._rangeSelectionEnabled = false;\n    this._rangeSelectionStart = null;\n    this._rangeSelectionEnd = null;\n    this._updateRangeSelectionOverlay();\n  }\n\n  isDragging(): boolean {\n    return this._isDragging;\n  }\n\n  elementsToRestoreScrollPositionsFor(): Element[] {\n    return [this._vScrollElement];\n  }\n\n  _updateScrollBar(): void {\n    const showScroll = this._alwaysShowVerticalScroll || this._totalHeight > this._offsetHeight;\n    if (this._vScrollElement.classList.contains('hidden') !== showScroll) {\n      return;\n    }\n    this._vScrollElement.classList.toggle('hidden', !showScroll);\n    this._updateContentElementSize();\n  }\n\n  onResize(): void {\n    this._updateScrollBar();\n    this._updateContentElementSize();\n    this.scheduleUpdate();\n  }\n\n  reset(): void {\n    this._vScrollElement.scrollTop = 0;\n    this._scrollTop = 0;\n    this._rangeSelectionStart = null;\n    this._rangeSelectionEnd = null;\n    this._isDragging = false;\n    this._dragStartPointX = 0;\n    this._dragStartPointY = 0;\n    this._dragStartScrollTop = 0;\n    this._visibleLeftTime = 0;\n    this._visibleRightTime = 0;\n    this._offsetWidth = 0;\n    this._offsetHeight = 0;\n    this._totalHeight = 0;\n    this._targetLeftTime = 0;\n    this._targetRightTime = 0;\n    this._updateContentElementSize();\n  }\n\n  _updateContentElementSize(): void {\n    let offsetWidth: number = this._vScrollElement.offsetLeft;\n    if (!offsetWidth) {\n      offsetWidth = this.contentElement.offsetWidth;\n    }\n    this._offsetWidth = offsetWidth;\n    this._offsetHeight = this.contentElement.offsetHeight;\n    this._delegate.setSize(this._offsetWidth, this._offsetHeight);\n  }\n\n  setContentHeight(totalHeight: number): void {\n    this._totalHeight = totalHeight;\n    this._vScrollContent.style.height = totalHeight + 'px';\n    this._updateScrollBar();\n    this._updateContentElementSize();\n    if (this._scrollTop + this._offsetHeight <= totalHeight) {\n      return;\n    }\n    this._scrollTop = Math.max(0, totalHeight - this._offsetHeight);\n    this._vScrollElement.scrollTop = this._scrollTop;\n  }\n\n  setScrollOffset(offset: number, height?: number): void {\n    height = height || 0;\n    if (this._vScrollElement.scrollTop > offset) {\n      this._vScrollElement.scrollTop = offset;\n    } else if (this._vScrollElement.scrollTop < offset - this._offsetHeight + height) {\n      this._vScrollElement.scrollTop = offset - this._offsetHeight + height;\n    }\n  }\n\n  scrollOffset(): number {\n    return this._vScrollElement.scrollTop;\n  }\n\n  chartHeight(): number {\n    return this._offsetHeight;\n  }\n\n  setBoundaries(zeroTime: number, totalTime: number): void {\n    this._minimumBoundary = zeroTime;\n    this._totalTime = totalTime;\n  }\n\n  _onMouseWheel(e: Event): void {\n    const wheelEvent = (e as WheelEvent);\n    const doZoomInstead = wheelEvent.shiftKey !==\n        (Common.Settings.Settings.instance().moduleSetting('flamechartMouseWheelAction').get() === 'zoom');\n    const panVertically = !doZoomInstead && (wheelEvent.deltaY || Math.abs(wheelEvent.deltaX) === 53);\n    const panHorizontally = doZoomInstead && Math.abs(wheelEvent.deltaX) > Math.abs(wheelEvent.deltaY);\n    if (panVertically) {\n      this._vScrollElement.scrollTop += (wheelEvent.deltaY || wheelEvent.deltaX) / 53 * this._offsetHeight / 8;\n    } else if (panHorizontally) {\n      this._handlePanGesture(wheelEvent.deltaX, /* animate */ true);\n    } else {  // Zoom.\n      const wheelZoomSpeed = 1 / 53;\n      this._handleZoomGesture(Math.pow(1.2, (wheelEvent.deltaY || wheelEvent.deltaX) * wheelZoomSpeed) - 1);\n    }\n\n    // Block swipe gesture.\n    e.consume(true);\n  }\n\n  _startDragging(event: MouseEvent): boolean {\n    if (event.shiftKey) {\n      return false;\n    }\n    this._isDragging = true;\n    this._dragStartPointX = event.pageX;\n    this._dragStartPointY = event.pageY;\n    this._dragStartScrollTop = this._vScrollElement.scrollTop;\n    this.viewportElement.style.cursor = '';\n    return true;\n  }\n\n  _dragging(event: MouseEvent): void {\n    const pixelShift = this._dragStartPointX - event.pageX;\n    this._dragStartPointX = event.pageX;\n    this._handlePanGesture(pixelShift);\n    const pixelScroll = this._dragStartPointY - event.pageY;\n    this._vScrollElement.scrollTop = this._dragStartScrollTop + pixelScroll;\n  }\n\n  _endDragging(): void {\n    this._isDragging = false;\n  }\n\n  _startRangeSelection(event: MouseEvent): boolean {\n    if (!event.shiftKey || !this._rangeSelectionEnabled) {\n      return false;\n    }\n    this._isDragging = true;\n    this._selectionOffsetShiftX = event.offsetX - event.pageX;\n    this._selectionOffsetShiftY = event.offsetY - event.pageY;\n    this._selectionStartX = event.offsetX;\n    const style = this._selectionOverlay.style;\n    style.left = this._selectionStartX + 'px';\n    style.width = '1px';\n    this._selectedTimeSpanLabel.textContent = '';\n    this._selectionOverlay.classList.remove('hidden');\n    return true;\n  }\n\n  _endRangeSelection(): void {\n    this._isDragging = false;\n    this._selectionStartX = null;\n  }\n\n  hideRangeSelection(): void {\n    this._selectionOverlay.classList.add('hidden');\n    this._rangeSelectionStart = null;\n    this._rangeSelectionEnd = null;\n  }\n\n  setRangeSelection(startTime: number, endTime: number): void {\n    if (!this._rangeSelectionEnabled) {\n      return;\n    }\n    this._rangeSelectionStart = Math.min(startTime, endTime);\n    this._rangeSelectionEnd = Math.max(startTime, endTime);\n    this._updateRangeSelectionOverlay();\n    this._delegate.updateRangeSelection(this._rangeSelectionStart, this._rangeSelectionEnd);\n  }\n\n  onClick(event: Event): void {\n    const mouseEvent = (event as MouseEvent);\n    const time = this.pixelToTime(mouseEvent.offsetX);\n    if (this._rangeSelectionStart !== null && this._rangeSelectionEnd !== null && time >= this._rangeSelectionStart &&\n        time <= this._rangeSelectionEnd) {\n      return;\n    }\n    this.hideRangeSelection();\n  }\n\n  _rangeSelectionDragging(event: MouseEvent): void {\n    const x = Platform.NumberUtilities.clamp(event.pageX + this._selectionOffsetShiftX, 0, this._offsetWidth);\n    const start = this.pixelToTime(this._selectionStartX || 0);\n    const end = this.pixelToTime(x);\n    this.setRangeSelection(start, end);\n  }\n\n  _updateRangeSelectionOverlay(): void {\n    const rangeSelectionStart = this._rangeSelectionStart || 0;\n    const rangeSelectionEnd = this._rangeSelectionEnd || 0;\n    const margin = 100;\n    const left =\n        Platform.NumberUtilities.clamp(this.timeToPosition(rangeSelectionStart), -margin, this._offsetWidth + margin);\n    const right =\n        Platform.NumberUtilities.clamp(this.timeToPosition(rangeSelectionEnd), -margin, this._offsetWidth + margin);\n    const style = this._selectionOverlay.style;\n    style.left = left + 'px';\n    style.width = (right - left) + 'px';\n    const timeSpan = rangeSelectionEnd - rangeSelectionStart;\n    this._selectedTimeSpanLabel.textContent = i18n.i18n.preciseMillisToString(timeSpan, 2);\n  }\n\n  _onScroll(): void {\n    this._scrollTop = this._vScrollElement.scrollTop;\n    this.scheduleUpdate();\n  }\n\n  _onMouseOut(): void {\n    this._lastMouseOffsetX = -1;\n    this._showCursor(false);\n  }\n\n  _updateCursorPosition(e: Event): void {\n    const mouseEvent = (e as MouseEvent);\n    this._showCursor(mouseEvent.shiftKey);\n    this._cursorElement.style.left = mouseEvent.offsetX + 'px';\n    this._lastMouseOffsetX = mouseEvent.offsetX;\n  }\n\n  pixelToTime(x: number): number {\n    return this.pixelToTimeOffset(x) + this._visibleLeftTime;\n  }\n\n  pixelToTimeOffset(x: number): number {\n    return x * (this._visibleRightTime - this._visibleLeftTime) / this._offsetWidth;\n  }\n\n  timeToPosition(time: number): number {\n    return Math.floor(\n        (time - this._visibleLeftTime) / (this._visibleRightTime - this._visibleLeftTime) * this._offsetWidth);\n  }\n\n  timeToPixel(): number {\n    return this._offsetWidth / (this._visibleRightTime - this._visibleLeftTime);\n  }\n\n  _showCursor(visible: boolean): void {\n    this._cursorElement.classList.toggle('hidden', !visible || this._isDragging);\n  }\n\n  _onChartKeyDown(e: Event): void {\n    const mouseEvent = (e as MouseEvent);\n    this._showCursor(mouseEvent.shiftKey);\n    this._handleZoomPanKeys(e);\n  }\n\n  _onChartKeyUp(e: Event): void {\n    const mouseEvent = (e as MouseEvent);\n    this._showCursor(mouseEvent.shiftKey);\n  }\n\n  _handleZoomPanKeys(e: Event): void {\n    if (!UI.KeyboardShortcut.KeyboardShortcut.hasNoModifiers(e)) {\n      return;\n    }\n    const keyboardEvent = (e as KeyboardEvent);\n    const zoomFactor = keyboardEvent.shiftKey ? 0.8 : 0.3;\n    const panOffset = keyboardEvent.shiftKey ? 320 : 160;\n    switch (keyboardEvent.code) {\n      case 'KeyA':\n        this._handlePanGesture(-panOffset, /* animate */ true);\n        break;\n      case 'KeyD':\n        this._handlePanGesture(panOffset, /* animate */ true);\n        break;\n      case 'KeyW':\n        this._handleZoomGesture(-zoomFactor);\n        break;\n      case 'KeyS':\n        this._handleZoomGesture(zoomFactor);\n        break;\n      default:\n        return;\n    }\n    e.consume(true);\n  }\n\n  _handleZoomGesture(zoom: number): void {\n    const bounds = {left: this._targetLeftTime, right: this._targetRightTime};\n    const cursorTime = this.pixelToTime(this._lastMouseOffsetX);\n    bounds.left += (bounds.left - cursorTime) * zoom;\n    bounds.right += (bounds.right - cursorTime) * zoom;\n    this._requestWindowTimes(bounds, /* animate */ true);\n  }\n\n  _handlePanGesture(offset: number, animate?: boolean): void {\n    const bounds = {left: this._targetLeftTime, right: this._targetRightTime};\n    const timeOffset = Platform.NumberUtilities.clamp(\n        this.pixelToTimeOffset(offset), this._minimumBoundary - bounds.left,\n        this._totalTime + this._minimumBoundary - bounds.right);\n    bounds.left += timeOffset;\n    bounds.right += timeOffset;\n    this._requestWindowTimes(bounds, Boolean(animate));\n  }\n\n  _requestWindowTimes(\n      bounds: {\n        left: number,\n        right: number,\n      },\n      animate: boolean): void {\n    const maxBound = this._minimumBoundary + this._totalTime;\n    if (bounds.left < this._minimumBoundary) {\n      bounds.right = Math.min(bounds.right + this._minimumBoundary - bounds.left, maxBound);\n      bounds.left = this._minimumBoundary;\n    } else if (bounds.right > maxBound) {\n      bounds.left = Math.max(bounds.left - bounds.right + maxBound, this._minimumBoundary);\n      bounds.right = maxBound;\n    }\n    if (bounds.right - bounds.left < MinimalTimeWindowMs) {\n      return;\n    }\n    this._delegate.windowChanged(bounds.left, bounds.right, animate);\n  }\n\n  scheduleUpdate(): void {\n    if (this._updateTimerId || this._cancelWindowTimesAnimation) {\n      return;\n    }\n    this._updateTimerId = this.element.window().requestAnimationFrame(() => {\n      this._updateTimerId = 0;\n      this._update();\n    });\n  }\n\n  _update(): void {\n    this._updateRangeSelectionOverlay();\n    this._delegate.update();\n  }\n\n  setWindowTimes(startTime: number, endTime: number, animate?: boolean): void {\n    if (startTime === this._targetLeftTime && endTime === this._targetRightTime) {\n      return;\n    }\n    if (!animate || this._visibleLeftTime === 0 || this._visibleRightTime === Infinity ||\n        (startTime === 0 && endTime === Infinity) || (startTime === Infinity && endTime === Infinity)) {\n      // Skip animation, move instantly.\n      this._targetLeftTime = startTime;\n      this._targetRightTime = endTime;\n      this._visibleLeftTime = startTime;\n      this._visibleRightTime = endTime;\n      this.scheduleUpdate();\n      return;\n    }\n    if (this._cancelWindowTimesAnimation) {\n      this._cancelWindowTimesAnimation();\n      this._visibleLeftTime = this._targetLeftTime;\n      this._visibleRightTime = this._targetRightTime;\n    }\n    this._targetLeftTime = startTime;\n    this._targetRightTime = endTime;\n    this._cancelWindowTimesAnimation = UI.UIUtils.animateFunction(\n        this.element.window(), animateWindowTimes.bind(this),\n        [{from: this._visibleLeftTime, to: startTime}, {from: this._visibleRightTime, to: endTime}], 100, () => {\n          this._cancelWindowTimesAnimation = null;\n        });\n\n    function animateWindowTimes(this: ChartViewport, startTime: number, endTime: number): void {\n      this._visibleLeftTime = startTime;\n      this._visibleRightTime = endTime;\n      this._update();\n    }\n  }\n\n  windowLeftTime(): number {\n    return this._visibleLeftTime;\n  }\n\n  windowRightTime(): number {\n    return this._visibleRightTime;\n  }\n}\n"]}