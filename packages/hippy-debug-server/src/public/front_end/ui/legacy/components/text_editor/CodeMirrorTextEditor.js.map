{"version":3,"file":"CodeMirrorTextEditor.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/text_editor/CodeMirrorTextEditor.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (C) 2012 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable rulesdir/no_underscored_properties */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/naming-convention */\n\nimport * as Common from '../../../../core/common/common.js';\nimport * as Host from '../../../../core/host/host.js';\nimport * as i18n from '../../../../core/i18n/i18n.js';\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as TextUtils from '../../../../models/text_utils/text_utils.js';\nimport * as UI from '../../legacy.js';\n\nimport {TextEditorAutocompleteController} from './TextEditorAutocompleteController.js';\n\nconst UIStrings = {\n  /**\n  *@description Text in Code Mirror Text Editor of the CodeMirror text editor\n  */\n  codeEditor: 'Code editor',\n};\nconst str_ = i18n.i18n.registerUIStrings('ui/legacy/components/text_editor/CodeMirrorTextEditor.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface Token {\n  startColumn: number;\n  endColumn: number;\n  type: string;\n}\n\nexport interface Coordinates {\n  x: number;\n  y: number;\n  height: number;\n}\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\nconst editorToDevtoolsWrapper = new WeakMap<any, CodeMirrorTextEditor>();\n\nexport class CodeMirrorTextEditor extends UI.Widget.VBox implements UI.TextEditor.TextEditor {\n  _options: UI.TextEditor.Options;\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  _codeMirror: any;\n  _codeMirrorElement: HTMLElement;\n  _shouldClearHistory: boolean;\n  _lineSeparator: string;\n  _hasOneLine!: boolean;\n  // https://crbug.com/1151919 * = CodeMirror.TextMarker\n  _bookmarkForMarker: WeakMap<any, TextEditorBookMark>;\n  _selectNextOccurrenceController: SelectNextOccurrenceController;\n  _decorations: Platform.MapUtilities.Multimap<number, Decoration>;\n  _needsRefresh: boolean;\n  _readOnly: boolean;\n  _mimeType: string;\n  _placeholderElement: HTMLPreElement|null;\n  _autocompleteController?: TextEditorAutocompleteController;\n  _highlightedLine?: any;\n  _clearHighlightTimeout?: number;\n  _editorSizeInSync?: boolean;\n  _lastSelection?: TextUtils.TextRange.TextRange;\n  _selectionSetScheduled?: boolean;\n\n  constructor(options: UI.TextEditor.Options) {\n    super();\n    this._options = options;\n\n    this.registerRequiredCSS('third_party/codemirror/codemirror.css', {enableLegacyPatching: false});\n    this.registerRequiredCSS('ui/legacy/components/text_editor/cmdevtools.css', {enableLegacyPatching: false});\n    this.registerRequiredCSS('ui/legacy/components/text_editor/cmdevtools.darkmode.css', {enableLegacyPatching: false});\n\n    const {indentWithTabs, indentUnit} = CodeMirrorTextEditor._getIndentation(\n        Common.Settings.Settings.instance().moduleSetting('textEditorIndent').get());\n    // @ts-ignore TODO(crbug.com/1172300) Properly type this after jsdoc to ts migration\n    this._codeMirror = new CodeMirror(this.element, {\n      screenReaderLabel: options.devtoolsAccessibleName || i18nString(UIStrings.codeEditor),\n      lineNumbers: options.lineNumbers,\n      smartIndent: true,\n      electricChars: true,\n      indentUnit,\n      indentWithTabs,\n      lineWrapping: options.lineWrapping,\n      lineWiseCopyCut: options.lineWiseCopyCut || false,\n      pollInterval: Math.pow(2, 31) - 1,\n      matchBrackets: true,\n      inputStyle: (options.inputStyle || 'devToolsAccessibleTextArea') as unknown as undefined,\n      styleSelectedText: true,\n      styleActiveLine: true,\n      tabIndex: 0,\n    });\n    this._codeMirrorElement = this.element.lastElementChild as HTMLElement;\n\n    editorToDevtoolsWrapper.set(this._codeMirror, this);\n\n    Common.Settings.Settings.instance()\n        .moduleSetting('textEditorIndent')\n        .addChangeListener(this._updateIndentSize.bind(this));\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    CodeMirror.keyMap['devtools-common'] = {\n      'Left': 'goCharLeft',\n      'Right': 'goCharRight',\n      'Up': 'goLineUp',\n      'Down': 'goLineDown',\n      'End': 'goLineEnd',\n      'Home': 'goLineStartSmart',\n      'PageUp': 'goSmartPageUp',\n      'PageDown': 'goSmartPageDown',\n      'Delete': 'delCharAfter',\n      'Backspace': 'delCharBefore',\n      'Tab': 'UserIndent',\n      'Shift-Tab': 'indentLessOrPass',\n      'Enter': 'newlineAndIndent',\n      'Ctrl-Space': 'autocomplete',\n      'Esc': 'dismiss',\n      'Ctrl-M': 'gotoMatchingBracket',\n    };\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    CodeMirror.keyMap['devtools-pc'] = {\n      'Ctrl-A': 'selectAll',\n      'Ctrl-Z': 'undoAndReveal',\n      'Shift-Ctrl-Z': 'redoAndReveal',\n      'Ctrl-Y': 'redo',\n      'Ctrl-Home': 'goDocStart',\n      'Ctrl-Up': 'goDocStart',\n      'Ctrl-End': 'goDocEnd',\n      'Ctrl-Down': 'goDocEnd',\n      'Ctrl-Left': 'goGroupLeft',\n      'Ctrl-Right': 'goGroupRight',\n      'Alt-Left': 'moveCamelLeft',\n      'Alt-Right': 'moveCamelRight',\n      'Shift-Alt-Left': 'selectCamelLeft',\n      'Shift-Alt-Right': 'selectCamelRight',\n      'Ctrl-Backspace': 'delGroupBefore',\n      'Ctrl-Delete': 'delGroupAfter',\n      'Ctrl-/': 'toggleComment',\n      'Ctrl-D': 'selectNextOccurrence',\n      'Ctrl-U': 'undoLastSelection',\n      fallthrough: 'devtools-common',\n    };\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    CodeMirror.keyMap['devtools-mac'] = {\n      'Cmd-A': 'selectAll',\n      'Cmd-Z': 'undoAndReveal',\n      'Shift-Cmd-Z': 'redoAndReveal',\n      'Cmd-Up': 'goDocStart',\n      'Cmd-Down': 'goDocEnd',\n      'Alt-Left': 'goGroupLeft',\n      'Alt-Right': 'goGroupRight',\n      'Ctrl-Left': 'moveCamelLeft',\n      'Ctrl-Right': 'moveCamelRight',\n      'Ctrl-A': 'goLineLeft',\n      'Ctrl-E': 'goLineRight',\n      'Ctrl-B': 'goCharLeft',\n      'Ctrl-F': 'goCharRight',\n      'Ctrl-Alt-B': 'goGroupLeft',\n      'Ctrl-Alt-F': 'goGroupRight',\n      'Ctrl-H': 'delCharBefore',\n      'Ctrl-D': 'delCharAfter',\n      'Ctrl-K': 'killLine',\n      'Ctrl-T': 'transposeChars',\n      'Ctrl-P': 'goLineUp',\n      'Ctrl-N': 'goLineDown',\n      'Shift-Ctrl-Left': 'selectCamelLeft',\n      'Shift-Ctrl-Right': 'selectCamelRight',\n      'Cmd-Left': 'goLineStartSmart',\n      'Cmd-Right': 'goLineEnd',\n      'Cmd-Backspace': 'delLineLeft',\n      'Alt-Backspace': 'delGroupBefore',\n      'Alt-Delete': 'delGroupAfter',\n      'Cmd-/': 'toggleComment',\n      'Cmd-D': 'selectNextOccurrence',\n      'Cmd-U': 'undoLastSelection',\n      fallthrough: 'devtools-common',\n    };\n\n    if (options.bracketMatchingSetting) {\n      options.bracketMatchingSetting.addChangeListener(this._enableBracketMatchingIfNeeded, this);\n    }\n    this._enableBracketMatchingIfNeeded();\n\n    this._codeMirror.setOption('keyMap', Host.Platform.isMac() ? 'devtools-mac' : 'devtools-pc');\n\n    this._codeMirror.setOption('flattenSpans', false);\n\n    let maxHighlightLength = options.maxHighlightLength;\n    if (typeof maxHighlightLength !== 'number') {\n      maxHighlightLength = CodeMirrorTextEditor.maxHighlightLength;\n    }\n    this._codeMirror.setOption('maxHighlightLength', maxHighlightLength);\n    this._codeMirror.setOption('mode', null);\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    this._codeMirror.setOption('crudeMeasuringFrom', 1000);\n\n    this._shouldClearHistory = true;\n    this._lineSeparator = '\\n';\n\n    this._bookmarkForMarker = new WeakMap();\n\n    CodeMirrorTextEditor._fixWordMovement(this._codeMirror);\n\n    this._selectNextOccurrenceController = new SelectNextOccurrenceController(this, this._codeMirror);\n\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    this._codeMirror.on('changes', this._changes.bind(this));\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    this._codeMirror.on('beforeSelectionChange', this._beforeSelectionChange.bind(this));\n    this._codeMirror.on('cursorActivity', () => {\n      this.dispatchEventToListeners(UI.TextEditor.Events.CursorChanged);\n    });\n\n    this.element.style.overflow = 'hidden';\n    this._codeMirrorElement.classList.add('source-code');\n    this._codeMirrorElement.classList.add('fill');\n\n    this._decorations = new Platform.MapUtilities.Multimap();\n\n    this.element.addEventListener('keydown', this._handleKeyDown.bind(this), true);\n    this.element.addEventListener('keydown', this._handlePostKeyDown.bind(this), false);\n\n    this._needsRefresh = true;\n\n    this._readOnly = false;\n\n    this._mimeType = '';\n    if (options.mimeType) {\n      this.setMimeType(options.mimeType);\n    }\n    if (options.autoHeight) {\n      this._codeMirror.setSize(null, 'auto');\n    }\n\n    this._placeholderElement = null;\n    if (options.placeholder) {\n      this._placeholderElement = document.createElement('pre');\n      this._placeholderElement.classList.add('placeholder-text');\n      this._placeholderElement.classList.add('CodeMirror-line-like');\n      this._placeholderElement.textContent = options.placeholder;\n      this._updatePlaceholder();\n    }\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static getForCodeMirror(codeMirrorEditor: any): CodeMirrorTextEditor {\n    const wrapper = editorToDevtoolsWrapper.get(codeMirrorEditor);\n    if (!wrapper) {\n      throw new Error('CodeMirrorTextEditor not found');\n    }\n    return wrapper;\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static autocompleteCommand(codeMirror: any): void {\n    const autocompleteController = CodeMirrorTextEditor.getForCodeMirror(codeMirror)._autocompleteController;\n    if (autocompleteController) {\n      autocompleteController.autocomplete(true);\n    }\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static undoLastSelectionCommand(codeMirror: any): void {\n    CodeMirrorTextEditor.getForCodeMirror(codeMirror)._selectNextOccurrenceController.undoLastSelection();\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static selectNextOccurrenceCommand(codeMirror: any): void {\n    CodeMirrorTextEditor.getForCodeMirror(codeMirror)._selectNextOccurrenceController.selectNextOccurrence();\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static moveCamelLeftCommand(shift: boolean, codeMirror: any): void {\n    CodeMirrorTextEditor.getForCodeMirror(codeMirror)._doCamelCaseMovement(-1, shift);\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static moveCamelRightCommand(shift: boolean, codeMirror: any): void {\n    CodeMirrorTextEditor.getForCodeMirror(codeMirror)._doCamelCaseMovement(1, shift);\n  }\n\n  static _getIndentation(indentationValue: string): {\n    indentWithTabs: boolean,\n    indentUnit: number,\n  } {\n    const indentWithTabs = /\\t/.test(indentationValue);\n    const indentUnit = indentWithTabs ? 4 : indentationValue.length;\n    return {indentWithTabs, indentUnit};\n  }\n\n  static _overrideModeWithPrefixedTokens(modeName: string, tokenPrefix: string): void {\n    const oldModeName = modeName + '-old';\n    if (CodeMirror.modes[oldModeName]) {\n      return;\n    }\n\n    CodeMirror.defineMode(oldModeName, CodeMirror.modes[modeName]);\n    CodeMirror.defineMode(modeName, modeConstructor);\n\n    // @ts-ignore TODO(crbug.com/1172300) Properly type this after jsdoc to ts migration\n    function modeConstructor(config: any, parserConfig: any): any {\n      // TODO(crbug.com/1172300) Properly type this after jsdoc to ts migration\n      const innerConfig: any = {};\n      for (const i in parserConfig) {\n        innerConfig[i] = parserConfig[i];\n      }\n      innerConfig.name = oldModeName;\n      const codeMirrorMode = CodeMirror.getMode(config, innerConfig);\n      codeMirrorMode.name = modeName;\n      if (typeof codeMirrorMode.token === 'undefined') {\n        throw new Error('codeMirrorMode.token was unexpectedly undefined');\n      }\n      codeMirrorMode.token = getTokenFunction(codeMirrorMode.token);\n      return codeMirrorMode;\n    }\n\n    function getTokenFunction(superToken: (arg0: any, arg1: any) => string | null): (stream: any, state: any) =>\n        string | null {\n      function childFunc(stream: any, state: any): string|null {\n        return tokenOverride(superToken, stream, state);\n      }\n\n      return childFunc;\n    }\n    function tokenOverride(superToken: (arg0: any, arg1: any) => string | null, stream: any, state: any): string|null {\n      const token = superToken(stream, state);\n      return token ? tokenPrefix + token.split(/ +/).join(' ' + tokenPrefix) : token;\n    }\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  static _fixWordMovement(codeMirror: any): void {\n    // https://crbug.com/1151919 * = CodeMirror.Editor\n    function moveLeft(shift: boolean, codeMirror: any): void {\n      codeMirror.setExtending(shift);\n      const cursor = codeMirror.getCursor('head');\n      codeMirror.execCommand('goGroupLeft');\n      const newCursor = codeMirror.getCursor('head');\n      if (newCursor.ch === 0 && newCursor.line !== 0) {\n        codeMirror.setExtending(false);\n        return;\n      }\n\n      const skippedText = codeMirror.getRange(newCursor, cursor, '#');\n      if (/^\\s+$/.test(skippedText)) {\n        codeMirror.execCommand('goGroupLeft');\n      }\n      codeMirror.setExtending(false);\n    }\n\n    // https://crbug.com/1151919 * = CodeMirror.Editor\n    function moveRight(shift: boolean, codeMirror: any): void {\n      codeMirror.setExtending(shift);\n      const cursor = codeMirror.getCursor('head');\n      codeMirror.execCommand('goGroupRight');\n      const newCursor = codeMirror.getCursor('head');\n      if (newCursor.ch === 0 && newCursor.line !== 0) {\n        codeMirror.setExtending(false);\n        return;\n      }\n\n      const skippedText = codeMirror.getRange(cursor, newCursor, '#');\n      if (/^\\s+$/.test(skippedText)) {\n        codeMirror.execCommand('goGroupRight');\n      }\n      codeMirror.setExtending(false);\n    }\n\n    const modifierKey = Host.Platform.isMac() ? 'Alt' : 'Ctrl';\n    const leftKey = modifierKey + '-Left';\n    const rightKey = modifierKey + '-Right';\n    const keyMap: {[key: string]: Function} = {};\n    keyMap[leftKey] = moveLeft.bind(null, false);\n    keyMap[rightKey] = moveRight.bind(null, false);\n    keyMap['Shift-' + leftKey] = moveLeft.bind(null, true);\n    keyMap['Shift-' + rightKey] = moveRight.bind(null, true);\n    codeMirror.addKeyMap(keyMap);\n  }\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  codeMirror(): any {\n    // https://crbug.com/1151919 * = CodeMirror.Editor\n    return /** @type {*} */ this._codeMirror as any;\n  }\n\n  widget(): UI.Widget.Widget {\n    return this;\n  }\n\n  setPlaceholder(placeholder: string): void {\n    if (!this._placeholderElement) {\n      this._placeholderElement = document.createElement('pre');\n      this._placeholderElement.classList.add('placeholder-text');\n      this._placeholderElement.classList.add('CodeMirror-line-like');\n    }\n    this._placeholderElement.textContent = placeholder || '';\n    this._updatePlaceholder();\n  }\n\n  _normalizePositionForOverlappingColumn(lineNumber: number, lineLength: number, charNumber: number): {\n    lineNumber: number,\n    columnNumber: number,\n  } {\n    const linesCount = this._codeMirror.lineCount();\n    let columnNumber: number|0 = charNumber;\n    if (charNumber < 0 && lineNumber > 0) {\n      --lineNumber;\n      columnNumber = this.line(lineNumber).length;\n    } else if (charNumber >= lineLength && lineNumber < linesCount - 1) {\n      ++lineNumber;\n      columnNumber = 0;\n    } else {\n      columnNumber = Platform.NumberUtilities.clamp(charNumber, 0, lineLength);\n    }\n    return {lineNumber: lineNumber, columnNumber: columnNumber};\n  }\n\n  _camelCaseMoveFromPosition(lineNumber: number, columnNumber: number, direction: number): {\n    lineNumber: number,\n    columnNumber: number,\n  } {\n    function valid(charNumber: number, length: number): boolean {\n      return charNumber >= 0 && charNumber < length;\n    }\n\n    function isWordStart(text: string, charNumber: number): boolean {\n      const position = charNumber;\n      const nextPosition = charNumber + 1;\n      return valid(position, text.length) && valid(nextPosition, text.length) &&\n          TextUtils.TextUtils.Utils.isWordChar(text[position]) &&\n          TextUtils.TextUtils.Utils.isWordChar(text[nextPosition]) &&\n          TextUtils.TextUtils.Utils.isUpperCase(text[position]) &&\n          TextUtils.TextUtils.Utils.isLowerCase(text[nextPosition]);\n    }\n\n    function isWordEnd(text: string, charNumber: number): boolean {\n      const position = charNumber;\n      const prevPosition = charNumber - 1;\n      return valid(position, text.length) && valid(prevPosition, text.length) &&\n          TextUtils.TextUtils.Utils.isWordChar(text[position]) &&\n          TextUtils.TextUtils.Utils.isWordChar(text[prevPosition]) &&\n          TextUtils.TextUtils.Utils.isUpperCase(text[position]) &&\n          TextUtils.TextUtils.Utils.isLowerCase(text[prevPosition]);\n    }\n\n    function constrainPosition(lineNumber: number, lineLength: number, columnNumber: number): {\n      lineNumber: number,\n      columnNumber: number,\n    } {\n      return {lineNumber: lineNumber, columnNumber: Platform.NumberUtilities.clamp(columnNumber, 0, lineLength)};\n    }\n\n    const text = this.line(lineNumber);\n    const length = text.length;\n\n    if ((columnNumber === length && direction === 1) || (columnNumber === 0 && direction === -1)) {\n      return this._normalizePositionForOverlappingColumn(lineNumber, length, columnNumber + direction);\n    }\n\n    let charNumber = direction === 1 ? columnNumber : columnNumber - 1;\n\n    // Move through initial spaces if any.\n    while (valid(charNumber, length) && TextUtils.TextUtils.Utils.isSpaceChar(text[charNumber])) {\n      charNumber += direction;\n    }\n    if (!valid(charNumber, length)) {\n      return constrainPosition(lineNumber, length, charNumber);\n    }\n\n    if (TextUtils.TextUtils.Utils.isStopChar(text[charNumber])) {\n      while (valid(charNumber, length) && TextUtils.TextUtils.Utils.isStopChar(text[charNumber])) {\n        charNumber += direction;\n      }\n      if (!valid(charNumber, length)) {\n        return constrainPosition(lineNumber, length, charNumber);\n      }\n      return {lineNumber: lineNumber, columnNumber: direction === -1 ? charNumber + 1 : charNumber};\n    }\n\n    charNumber += direction;\n    while (valid(charNumber, length) && !isWordStart(text, charNumber) && !isWordEnd(text, charNumber) &&\n           TextUtils.TextUtils.Utils.isWordChar(text[charNumber])) {\n      charNumber += direction;\n    }\n\n    if (!valid(charNumber, length)) {\n      return constrainPosition(lineNumber, length, charNumber);\n    }\n    if (isWordStart(text, charNumber) || isWordEnd(text, charNumber)) {\n      return {lineNumber: lineNumber, columnNumber: charNumber};\n    }\n\n    return {lineNumber: lineNumber, columnNumber: direction === -1 ? charNumber + 1 : charNumber};\n  }\n\n  _doCamelCaseMovement(direction: number, shift: boolean): void {\n    const selections = this.selections();\n    for (let i = 0; i < selections.length; ++i) {\n      const selection = selections[i];\n      const move = this._camelCaseMoveFromPosition(selection.endLine, selection.endColumn, direction);\n      selection.endLine = move.lineNumber;\n      selection.endColumn = move.columnNumber;\n      if (!shift) {\n        selections[i] = selection.collapseToEnd();\n      }\n    }\n    this.setSelections(selections);\n  }\n\n  dispose(): void {\n    if (this._options.bracketMatchingSetting) {\n      this._options.bracketMatchingSetting.removeChangeListener(this._enableBracketMatchingIfNeeded, this);\n    }\n  }\n\n  _enableBracketMatchingIfNeeded(): void {\n    this._codeMirror.setOption(\n        // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n        'autoCloseBrackets',\n        (this._options.bracketMatchingSetting && this._options.bracketMatchingSetting.get()) ? {explode: false} :\n                                                                                               false);\n  }\n\n  wasShown(): void {\n    if (this._needsRefresh) {\n      this.refresh();\n    }\n  }\n\n  protected refresh(): void {\n    if (this.isShowing()) {\n      this._codeMirror.refresh();\n      this._needsRefresh = false;\n      return;\n    }\n    this._needsRefresh = true;\n  }\n\n  willHide(): void {\n    delete this._editorSizeInSync;\n  }\n\n  undo(): void {\n    this._codeMirror.undo();\n  }\n\n  redo(): void {\n    this._codeMirror.redo();\n  }\n\n  _handleKeyDown(e: Event): void {\n    const keyboardEvent = e as KeyboardEvent;\n    if (keyboardEvent.key === 'Tab' &&\n        Common.Settings.Settings.instance().moduleSetting('textEditorTabMovesFocus').get()) {\n      keyboardEvent.consume(false);\n      return;\n    }\n    if (this._autocompleteController && this._autocompleteController.keyDown(keyboardEvent)) {\n      keyboardEvent.consume(true);\n    }\n  }\n\n  _handlePostKeyDown(e: Event): void {\n    if (e.defaultPrevented) {\n      e.consume(true);\n    }\n  }\n\n  configureAutocomplete(config: UI.TextEditor.AutocompleteConfig|null): void {\n    if (this._autocompleteController) {\n      this._autocompleteController.dispose();\n      delete this._autocompleteController;\n    }\n\n    if (config) {\n      this._autocompleteController = new TextEditorAutocompleteController(this, this._codeMirror, config);\n    }\n  }\n\n  cursorPositionToCoordinates(lineNumber: number, column: number): Coordinates|null {\n    if (lineNumber >= this._codeMirror.lineCount() || lineNumber < 0 || column < 0 ||\n        column > this._codeMirror.getLine(lineNumber).length) {\n      return null;\n    }\n    const metrics = this._codeMirror.cursorCoords(new CodeMirror.Pos(lineNumber, column));\n    return {x: metrics.left, y: metrics.top, height: metrics.bottom - metrics.top};\n  }\n\n  coordinatesToCursorPosition(x: number, y: number): TextUtils.TextRange.TextRange|null {\n    const element = this.element.ownerDocument.elementFromPoint(x, y);\n    if (!element || !element.isSelfOrDescendant(this._codeMirror.getWrapperElement())) {\n      return null;\n    }\n    const gutterBox = this._codeMirror.getGutterElement().boxInWindow();\n    if (x >= gutterBox.x && x <= gutterBox.x + gutterBox.width && y >= gutterBox.y &&\n        y <= gutterBox.y + gutterBox.height) {\n      return null;\n    }\n    const coords = this._codeMirror.coordsChar({left: x, top: y});\n    return TextUtils.CodeMirrorUtils.toRange(coords, coords);\n  }\n\n  visualCoordinates(lineNumber: number, columnNumber: number): {\n    x: number,\n    y: number,\n  } {\n    const metrics = this._codeMirror.cursorCoords(new CodeMirror.Pos(lineNumber, columnNumber));\n    return {x: metrics.left, y: metrics.top};\n  }\n\n  tokenAtTextPosition(lineNumber: number, columnNumber: number): Token|null {\n    if (lineNumber < 0 || lineNumber >= this._codeMirror.lineCount()) {\n      return null;\n    }\n    const token = this._codeMirror.getTokenAt(new CodeMirror.Pos(lineNumber, (columnNumber || 0) + 1));\n    if (!token) {\n      return null;\n    }\n    return {startColumn: token.start, endColumn: token.end, type: token.type as string};\n  }\n\n  isClean(generation: number): boolean {\n    return this._codeMirror.isClean(generation);\n  }\n\n  markClean(): number {\n    return this._codeMirror.changeGeneration(true);\n  }\n\n  _hasLongLines(): boolean {\n    function lineIterator(lineHandle: {\n      text: string,\n    }): boolean {\n      if (lineHandle.text.length > CodeMirrorTextEditor.LongLineModeLineLengthThreshold) {\n        hasLongLines = true;\n      }\n      return hasLongLines;\n    }\n    let hasLongLines = false;\n    this._codeMirror.eachLine(lineIterator);\n    return hasLongLines;\n  }\n\n  _enableLongLinesMode(): void {\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    this._codeMirror.setOption('styleSelectedText', false);\n  }\n\n  _disableLongLinesMode(): void {\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    this._codeMirror.setOption('styleSelectedText', true);\n  }\n\n  _updateIndentSize(updatedValue: {\n    data: any,\n  }): void {\n    const {indentWithTabs, indentUnit} = CodeMirrorTextEditor._getIndentation(updatedValue.data as string);\n\n    this._codeMirror.setOption('indentUnit', indentUnit);\n    this._codeMirror.setOption('indentWithTabs', indentWithTabs);\n  }\n\n  setMimeType(mimeType: string): void {\n    this._mimeType = mimeType;\n\n    const rewrittenMimeType = this.rewriteMimeType(mimeType);\n    const modeOption = this._codeMirror.getOption('mode');\n    if (modeOption !== rewrittenMimeType) {\n      this._codeMirror.setOption('mode', rewrittenMimeType);\n    }\n  }\n\n  setHighlightMode(mode: Object): void {\n    this._mimeType = '';\n    this._codeMirror.setOption('mode', mode);\n  }\n\n  protected rewriteMimeType(mimeType: string): string {\n    // Overridden in SourcesTextEditor\n    return mimeType;\n  }\n\n  protected mimeType(): string {\n    return this._mimeType;\n  }\n\n  setReadOnly(readOnly: boolean): void {\n    if (this._readOnly === readOnly) {\n      return;\n    }\n    this.clearPositionHighlight();\n    this._readOnly = readOnly;\n    this.element.classList.toggle('CodeMirror-readonly', readOnly);\n    this._codeMirror.setOption('readOnly', readOnly);\n  }\n\n  readOnly(): boolean {\n    return Boolean(this._codeMirror.getOption('readOnly'));\n  }\n\n  setLineNumberFormatter(formatter: (arg0: number) => string): void {\n    this._codeMirror.setOption('lineNumberFormatter', formatter);\n  }\n\n  addKeyDownHandler(handler: (arg0: KeyboardEvent) => void): void {\n    this._codeMirror.on(\n        'keydown', /**\n    * @param {*} CodeMirror\n    * @param {!KeyboardEvent} event\n    */\n        (CodeMirror: any, event: KeyboardEvent) => handler(event));\n  }\n\n  addBookmark(lineNumber: number, columnNumber: number, element: HTMLElement, type: symbol, insertBefore?: boolean):\n      TextEditorBookMark {\n    const marker = this._codeMirror.setBookmark(\n        new CodeMirror.Pos(lineNumber, columnNumber), {widget: element, insertLeft: insertBefore});\n\n    const bookmark = new TextEditorBookMark(marker, type, this);\n    this._bookmarkForMarker.set(marker, bookmark);\n    this._updateDecorations(lineNumber);\n    return bookmark;\n  }\n\n  bookmarks(range: TextUtils.TextRange.TextRange, type?: symbol): TextEditorBookMark[] {\n    const pos = TextUtils.CodeMirrorUtils.toPos(range);\n    let markers = this._codeMirror.findMarksAt(pos.start);\n    if (!range.isEmpty()) {\n      const middleMarkers = this._codeMirror.findMarks(pos.start, pos.end);\n      const endMarkers = this._codeMirror.findMarksAt(pos.end);\n      markers = markers.concat(middleMarkers, endMarkers);\n    }\n    const bookmarks: TextEditorBookMark[] = [];\n    for (let i = 0; i < markers.length; i++) {\n      const marker = markers[i];\n      const bookmark = this._bookmarkForMarker.get(marker);\n      if (bookmark && (!type || bookmark.type() === type)) {\n        bookmarks.push(bookmark);\n      }\n    }\n    return bookmarks;\n  }\n\n  focus(): void {\n    this._codeMirror.focus();\n  }\n\n  hasFocus(): boolean {\n    return this._codeMirror.hasFocus();\n  }\n\n  operation(operation: () => any): void {\n    this._codeMirror.operation(operation);\n  }\n\n  scrollLineIntoView(lineNumber: number): void {\n    this._innerRevealLine(lineNumber, this._codeMirror.getScrollInfo());\n  }\n\n  _innerRevealLine(lineNumber: number, scrollInfo: {\n    left: number,\n    top: number,\n    width: number,\n    height: number,\n    clientWidth: number,\n    clientHeight: number,\n  }): void {\n    const topLine = this._codeMirror.lineAtHeight(scrollInfo.top, 'local');\n    const bottomLine = this._codeMirror.lineAtHeight(scrollInfo.top + scrollInfo.clientHeight, 'local');\n    const linesPerScreen = bottomLine - topLine + 1;\n    if (lineNumber < topLine) {\n      const topLineToReveal = Math.max(lineNumber - (linesPerScreen / 2) + 1, 0) | 0;\n      this._codeMirror.scrollIntoView(new CodeMirror.Pos(topLineToReveal, 0));\n    } else if (lineNumber > bottomLine) {\n      const bottomLineToReveal = Math.min(lineNumber + (linesPerScreen / 2) - 1, this.linesCount - 1) | 0;\n      this._codeMirror.scrollIntoView(new CodeMirror.Pos(bottomLineToReveal, 0));\n    }\n  }\n\n  addDecoration(element: HTMLElement, lineNumber: number, startColumn?: number, endColumn?: number): void {\n    const widget = this._codeMirror.addLineWidget(lineNumber, element);\n    let update: (() => void)|null = null;\n    if (typeof startColumn !== 'undefined') {\n      if (typeof endColumn === 'undefined') {\n        endColumn = Infinity;\n      }\n      update = this._updateFloatingDecoration.bind(this, element, lineNumber, startColumn, endColumn);\n      update();\n    }\n\n    this._decorations.set(lineNumber, {element: element, update: update, widget: widget});\n  }\n\n  _updateFloatingDecoration(element: HTMLElement, lineNumber: number, startColumn: number, endColumn: number): void {\n    const base = this._codeMirror.cursorCoords(new CodeMirror.Pos(lineNumber, 0), 'page');\n    const start = this._codeMirror.cursorCoords(new CodeMirror.Pos(lineNumber, startColumn), 'page');\n    const end = this._codeMirror.charCoords(new CodeMirror.Pos(lineNumber, endColumn), 'page');\n    element.style.width = (end.right - start.left) + 'px';\n    element.style.left = (start.left - base.left) + 'px';\n  }\n\n  _updateDecorations(lineNumber: number): void {\n    this._decorations.get(lineNumber).forEach(innerUpdateDecorations);\n\n    function innerUpdateDecorations(decoration: Decoration): void {\n      if (decoration.update) {\n        decoration.update();\n      }\n    }\n  }\n\n  removeDecoration(element: Element, lineNumber: number): void {\n    this._decorations.get(lineNumber).forEach(innerRemoveDecoration.bind(this));\n\n    function innerRemoveDecoration(this: CodeMirrorTextEditor, decoration: Decoration): void {\n      if (decoration.element !== element) {\n        return;\n      }\n      this._codeMirror.removeLineWidget(decoration.widget);\n      this._decorations.delete(lineNumber, decoration);\n    }\n  }\n\n  revealPosition(lineNumber: number, columnNumber?: number, shouldHighlight?: boolean): void {\n    lineNumber = Platform.NumberUtilities.clamp(lineNumber, 0, this._codeMirror.lineCount() - 1);\n    if (typeof columnNumber !== 'number') {\n      columnNumber = 0;\n    }\n    columnNumber = Platform.NumberUtilities.clamp(columnNumber, 0, this._codeMirror.getLine(lineNumber).length);\n\n    this.clearPositionHighlight();\n    this._highlightedLine = this._codeMirror.getLineHandle(lineNumber);\n    if (!this._highlightedLine) {\n      return;\n    }\n    this.scrollLineIntoView(lineNumber);\n    if (shouldHighlight) {\n      this._codeMirror.addLineClass(\n          this._highlightedLine, null, this._readOnly ? 'cm-readonly-highlight' : 'cm-highlight');\n      if (!this._readOnly) {\n        this._clearHighlightTimeout = window.setTimeout(this.clearPositionHighlight.bind(this), 2000);\n      }\n    }\n    this.setSelection(TextUtils.TextRange.TextRange.createFromLocation(lineNumber, columnNumber));\n  }\n\n  clearPositionHighlight(): void {\n    if (this._clearHighlightTimeout) {\n      clearTimeout(this._clearHighlightTimeout);\n    }\n    delete this._clearHighlightTimeout;\n\n    if (this._highlightedLine) {\n      this._codeMirror.removeLineClass(\n          // @ts-ignore the `null` argument should be a string?\n          this._highlightedLine, null, this._readOnly ? 'cm-readonly-highlight' : 'cm-highlight');\n    }\n    delete this._highlightedLine;\n  }\n\n  elementsToRestoreScrollPositionsFor(): Element[] {\n    return [];\n  }\n\n  _updatePaddingBottom(width: number, height: number): void {\n    let newPaddingBottom = 0;\n    const linesElement = this._codeMirrorElement.getElementsByClassName('CodeMirror-lines')[0] as HTMLElement;\n\n    if (this._options.padBottom) {\n      const scrollInfo = this._codeMirror.getScrollInfo();\n      const lineCount = this._codeMirror.lineCount();\n      if (lineCount > 1) {\n        newPaddingBottom =\n            // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n            Math.max(scrollInfo.clientHeight - this._codeMirror.getLineHandle(this._codeMirror.lastLine()).height, 0);\n      }\n    }\n    const stringPaddingBottomValue = String(newPaddingBottom) + 'px';\n    if (linesElement.style.paddingBottom !== stringPaddingBottomValue) {\n      linesElement.style.paddingBottom = stringPaddingBottomValue;\n      this._codeMirror.setSize(width, height);\n    }\n  }\n\n  toggleScrollPastEof(enableScrolling: boolean): void {\n    if (this._options.padBottom === enableScrolling) {\n      return;\n    }\n\n    this._options.padBottom = enableScrolling;\n    this._resizeEditor();\n  }\n\n  _resizeEditor(): void {\n    const parentElement = this.element.parentElement;\n    if (!parentElement || !this.isShowing()) {\n      return;\n    }\n    this._codeMirror.operation(() => {\n      const scrollLeft = this._codeMirror.doc.scrollLeft;\n      const scrollTop = this._codeMirror.doc.scrollTop;\n      const width = parentElement.offsetWidth;\n      const height = parentElement.offsetHeight - this.element.offsetTop;\n      if (this._options.autoHeight) {\n        this._codeMirror.setSize(width, 'auto');\n      } else {\n        this._codeMirror.setSize(width, height);\n        this._updatePaddingBottom(width, height);\n      }\n      this._codeMirror.scrollTo(scrollLeft, scrollTop);\n    });\n  }\n\n  onResize(): void {\n    if (this._autocompleteController) {\n      this._autocompleteController.clearAutocomplete();\n    }\n    this._resizeEditor();\n    this._editorSizeInSync = true;\n    if (this._selectionSetScheduled) {\n      delete this._selectionSetScheduled;\n      if (this._lastSelection) {\n        this.setSelection(this._lastSelection);\n      }\n    }\n  }\n\n  editRange(range: TextUtils.TextRange.TextRange, text: string, origin?: string): TextUtils.TextRange.TextRange {\n    const pos = TextUtils.CodeMirrorUtils.toPos(range);\n    this._codeMirror.replaceRange(text, pos.start, pos.end, origin);\n    const newRange = TextUtils.CodeMirrorUtils.toRange(\n        pos.start, this._codeMirror.posFromIndex(this._codeMirror.indexFromPos(pos.start) + text.length));\n    this.dispatchEventToListeners(UI.TextEditor.Events.TextChanged, {oldRange: range, newRange: newRange});\n    return newRange;\n  }\n\n  clearAutocomplete(): void {\n    if (this._autocompleteController) {\n      this._autocompleteController.clearAutocomplete();\n    }\n  }\n\n  wordRangeForCursorPosition(lineNumber: number, column: number, isWordChar: (arg0: string) => boolean):\n      TextUtils.TextRange.TextRange {\n    const line = this.line(lineNumber);\n    let wordStart: number = column;\n    if (column !== 0 && isWordChar(line.charAt(column - 1))) {\n      wordStart = column - 1;\n      while (wordStart > 0 && isWordChar(line.charAt(wordStart - 1))) {\n        --wordStart;\n      }\n    }\n    let wordEnd = column;\n    while (wordEnd < line.length && isWordChar(line.charAt(wordEnd))) {\n      ++wordEnd;\n    }\n    return new TextUtils.TextRange.TextRange(lineNumber, wordStart, lineNumber, wordEnd);\n  }\n\n  // https://crbug.com/1151919 first * = CodeMirror.Editor, second * = CodeMirror.EditorChangeLinkedList\n  _changes(codeMirror: any, changes: any): void {\n    if (!changes.length) {\n      return;\n    }\n\n    this._updatePlaceholder();\n\n    // We do not show \"scroll beyond end of file\" span for one line documents, so we need to check if \"document has one line\" changed.\n    const hasOneLine = this._codeMirror.lineCount() === 1;\n    if (hasOneLine !== this._hasOneLine) {\n      this._resizeEditor();\n    }\n    this._hasOneLine = hasOneLine;\n\n    this._decorations.valuesArray().forEach(decoration => this._codeMirror.removeLineWidget(decoration.widget));\n    this._decorations.clear();\n\n    const edits = [];\n    let currentEdit;\n\n    for (let changeIndex = 0; changeIndex < changes.length; ++changeIndex) {\n      const changeObject = changes[changeIndex];\n      const edit = TextUtils.CodeMirrorUtils.changeObjectToEditOperation(changeObject);\n      if (currentEdit && edit.oldRange.equal(currentEdit.newRange)) {\n        currentEdit.newRange = edit.newRange;\n      } else {\n        currentEdit = edit;\n        edits.push(currentEdit);\n      }\n    }\n\n    for (let i = 0; i < edits.length; i++) {\n      this.dispatchEventToListeners(\n          UI.TextEditor.Events.TextChanged, {oldRange: edits[i].oldRange, newRange: edits[i].newRange});\n    }\n  }\n\n  // https://crbug.com/1151919 first * = CodeMirror.Editor, second and third * = CodeMirror.Pos\n  _beforeSelectionChange(_codeMirror: any, _selection: {\n    ranges: Array<{\n      head: any,\n      anchor: any,\n    }>,\n  }): void {\n    this._selectNextOccurrenceController.selectionWillChange();\n  }\n\n  scrollToLine(lineNumber: number): void {\n    const pos = new CodeMirror.Pos(lineNumber, 0);\n    const coords = this._codeMirror.charCoords(pos, 'local');\n    this._codeMirror.scrollTo(0, coords.top);\n  }\n\n  firstVisibleLine(): number {\n    return this._codeMirror.lineAtHeight(this._codeMirror.getScrollInfo().top, 'local');\n  }\n\n  scrollTop(): number {\n    return this._codeMirror.getScrollInfo().top;\n  }\n\n  setScrollTop(scrollTop: number): void {\n    this._codeMirror.scrollTo(0, scrollTop);\n  }\n\n  lastVisibleLine(): number {\n    const scrollInfo = this._codeMirror.getScrollInfo();\n    return this._codeMirror.lineAtHeight(scrollInfo.top + scrollInfo.clientHeight, 'local');\n  }\n\n  selection(): TextUtils.TextRange.TextRange {\n    const start = this._codeMirror.getCursor('anchor');\n    const end = this._codeMirror.getCursor('head');\n\n    return TextUtils.CodeMirrorUtils.toRange(start, end);\n  }\n\n  selections(): TextUtils.TextRange.TextRange[] {\n    const selectionList = this._codeMirror.listSelections();\n    const result = [];\n    for (let i = 0; i < selectionList.length; ++i) {\n      const selection = selectionList[i];\n      result.push(TextUtils.CodeMirrorUtils.toRange(selection.anchor, selection.head));\n    }\n    return result;\n  }\n\n  lastSelection(): TextUtils.TextRange.TextRange|null {\n    return this._lastSelection || null;\n  }\n\n  setSelection(textRange: TextUtils.TextRange.TextRange, dontScroll?: boolean): void {\n    this._lastSelection = textRange;\n    if (!this._editorSizeInSync) {\n      this._selectionSetScheduled = true;\n      return;\n    }\n    const pos = TextUtils.CodeMirrorUtils.toPos(textRange);\n    // https://crbug.com/1151919 both * = CodeMirror.Position\n    const startAsPosition = (pos.start as any);\n    const endAsPosition = (pos.end as any);\n    const scroll = !dontScroll;\n    this._codeMirror.setSelection(startAsPosition, endAsPosition, {scroll});\n  }\n\n  setSelections(ranges: TextUtils.TextRange.TextRange[], primarySelectionIndex?: number): void {\n    const selections = [];\n    for (let i = 0; i < ranges.length; ++i) {\n      const selection = TextUtils.CodeMirrorUtils.toPos(ranges[i]);\n      selections.push({anchor: selection.start, head: selection.end});\n    }\n    primarySelectionIndex = primarySelectionIndex || 0;\n    this._codeMirror.setSelections(selections, primarySelectionIndex, {scroll: false});\n  }\n\n  _detectLineSeparator(text: string): void {\n    this._lineSeparator = text.indexOf('\\r\\n') >= 0 ? '\\r\\n' : '\\n';\n  }\n\n  setText(text: string): void {\n    if (text.length > CodeMirrorTextEditor.MaxEditableTextSize) {\n      this.configureAutocomplete(null);\n      this.setReadOnly(true);\n    }\n    this._codeMirror.setValue(text);\n    if (this._shouldClearHistory) {\n      this._codeMirror.clearHistory();\n      this._shouldClearHistory = false;\n    }\n    this._detectLineSeparator(text);\n\n    if (this._hasLongLines()) {\n      this._enableLongLinesMode();\n    } else {\n      this._disableLongLinesMode();\n    }\n\n    if (!this.isShowing()) {\n      this.refresh();\n    }\n  }\n\n  text(textRange?: TextUtils.TextRange.TextRange): string {\n    if (!textRange) {\n      return this._codeMirror.getValue(this._lineSeparator);\n    }\n    const pos = TextUtils.CodeMirrorUtils.toPos(textRange.normalize());\n    return this._codeMirror.getRange(pos.start, pos.end, this._lineSeparator);\n  }\n\n  textWithCurrentSuggestion(): string {\n    if (!this._autocompleteController) {\n      return this.text();\n    }\n    return this._autocompleteController.textWithCurrentSuggestion();\n  }\n\n  fullRange(): TextUtils.TextRange.TextRange {\n    const lineCount = this.linesCount;\n    const lastLine = this._codeMirror.getLine(lineCount - 1);\n    return TextUtils.CodeMirrorUtils.toRange(\n        new CodeMirror.Pos(0, 0), new CodeMirror.Pos(lineCount - 1, lastLine.length));\n  }\n\n  currentLineNumber(): number {\n    return this._codeMirror.getCursor().line;\n  }\n\n  line(lineNumber: number): string {\n    return this._codeMirror.getLine(lineNumber);\n  }\n\n  get linesCount(): number {\n    return this._codeMirror.lineCount();\n  }\n\n  newlineAndIndent(): void {\n    this._codeMirror.execCommand('newlineAndIndent');\n  }\n\n  textEditorPositionHandle(lineNumber: number, columnNumber: number): TextEditorPositionHandle {\n    return new CodeMirrorPositionHandle(this._codeMirror, new CodeMirror.Pos(lineNumber, columnNumber));\n  }\n\n  _updatePlaceholder(): void {\n    if (!this._placeholderElement) {\n      return;\n    }\n\n    this._placeholderElement.remove();\n\n    if (this.linesCount === 1 && !this.line(0)) {\n      // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n      this._codeMirror.display.lineSpace.insertBefore(\n          // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n          this._placeholderElement, this._codeMirror.display.lineSpace.firstChild);\n    }\n  }\n\n  static readonly maxHighlightLength = 1000;\n  static readonly LongLineModeLineLengthThreshold = 2000;\n  static readonly MaxEditableTextSize = 1024 * 1024 * 10;\n}\n\nCodeMirrorTextEditor._overrideModeWithPrefixedTokens('css', 'css-');\nCodeMirrorTextEditor._overrideModeWithPrefixedTokens('javascript', 'js-');\nCodeMirrorTextEditor._overrideModeWithPrefixedTokens('xml', 'xml-');\n\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.autocomplete = CodeMirrorTextEditor.autocompleteCommand;\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.undoLastSelection = CodeMirrorTextEditor.undoLastSelectionCommand;\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.selectNextOccurrence = CodeMirrorTextEditor.selectNextOccurrenceCommand;\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.moveCamelLeft = CodeMirrorTextEditor.moveCamelLeftCommand.bind(null, false);\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.selectCamelLeft = CodeMirrorTextEditor.moveCamelLeftCommand.bind(null, true);\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.moveCamelRight = CodeMirrorTextEditor.moveCamelRightCommand.bind(null, false);\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.selectCamelRight = CodeMirrorTextEditor.moveCamelRightCommand.bind(null, true);\n\n// @ts-ignore https://crbug.com/1151919 * = CodeMirror.Editor\nCodeMirror.commands.UserIndent = function(codeMirror: any): void {\n  const ranges = codeMirror.listSelections();\n  if (ranges.length === 0) {\n    return;\n  }\n\n  if (codeMirror.somethingSelected()) {\n    codeMirror.indentSelection('add');\n    return;\n  }\n\n  const indentation = Common.Settings.Settings.instance().moduleSetting('textEditorIndent').get();\n  codeMirror.replaceSelection(indentation);\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore TS doesn't find the property even though it's defined in codemirror-legacy.d.ts\nCodeMirror.commands.indentLessOrPass = function(codeMirror: any): Object|undefined {\n  const selections = codeMirror.listSelections();\n  if (selections.length === 1) {\n    const range = TextUtils.CodeMirrorUtils.toRange(selections[0].anchor, selections[0].head);\n    if (range.isEmpty() && !/^\\s/.test(codeMirror.getLine(range.startLine))) {\n      return CodeMirror.Pass;\n    }\n  }\n  codeMirror.execCommand('indentLess');\n  return undefined;\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.gotoMatchingBracket = function(codeMirror: any): void {\n  const updatedSelections = [];\n  const selections = codeMirror.listSelections();\n  for (let i = 0; i < selections.length; ++i) {\n    const selection = selections[i];\n    const cursor = selection.head;\n    // @ts-ignore findMatchingBracket types are incorrect\n    const matchingBracket = codeMirror.findMatchingBracket(cursor, false, {maxScanLines: 10000});\n    let updatedHead = cursor;\n    if (matchingBracket && matchingBracket.match) {\n      const columnCorrection = CodeMirror.cmpPos(matchingBracket.from, cursor) === 0 ? 1 : 0;\n      updatedHead = new CodeMirror.Pos(matchingBracket.to.line, matchingBracket.to.ch + columnCorrection);\n    }\n    updatedSelections.push({anchor: updatedHead, head: updatedHead});\n  }\n  codeMirror.setSelections(updatedSelections);\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.undoAndReveal = function(codemirror: any): void {\n  const scrollInfo = codemirror.getScrollInfo();\n  codemirror.execCommand('undo');\n  const cursor = codemirror.getCursor('start');\n  CodeMirrorTextEditor.getForCodeMirror(codemirror)._innerRevealLine(cursor.line, scrollInfo);\n  const autocompleteController = CodeMirrorTextEditor.getForCodeMirror(codemirror)._autocompleteController;\n  if (autocompleteController) {\n    autocompleteController.clearAutocomplete();\n  }\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.redoAndReveal = function(codemirror: any): void {\n  const scrollInfo = codemirror.getScrollInfo();\n  codemirror.execCommand('redo');\n  const cursor = codemirror.getCursor('start');\n  CodeMirrorTextEditor.getForCodeMirror(codemirror)._innerRevealLine(cursor.line, scrollInfo);\n  const autocompleteController = CodeMirrorTextEditor.getForCodeMirror(codemirror)._autocompleteController;\n  if (autocompleteController) {\n    autocompleteController.clearAutocomplete();\n  }\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.dismiss = function(codemirror: any): Object|undefined {\n  const selections = codemirror.listSelections();\n  const selection = selections[0];\n  if (selections.length === 1) {\n    if (TextUtils.CodeMirrorUtils.toRange(selection.anchor, selection.head).isEmpty()) {\n      return CodeMirror.Pass;\n    }\n    codemirror.setSelection(selection.anchor, selection.anchor, {scroll: false});\n    CodeMirrorTextEditor.getForCodeMirror(codemirror).scrollLineIntoView(selection.anchor.line);\n    return;\n  }\n\n  codemirror.setSelection(selection.anchor, selection.head, {scroll: false});\n  CodeMirrorTextEditor.getForCodeMirror(codemirror).scrollLineIntoView(selection.anchor.line);\n  return undefined;\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.goSmartPageUp = function(codemirror: any): Object|undefined {\n  if (CodeMirrorTextEditor.getForCodeMirror(codemirror)\n          .selection()\n          .equal(TextUtils.TextRange.TextRange.createFromLocation(0, 0))) {\n    return CodeMirror.Pass;\n  }\n  codemirror.execCommand('goPageUp');\n  return undefined;\n};\n\n// https://crbug.com/1151919 * = CodeMirror.Editor\n// @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\nCodeMirror.commands.goSmartPageDown = function(codemirror: any): Object|undefined {\n  if (CodeMirrorTextEditor.getForCodeMirror(codemirror)\n          .selection()\n          .equal(CodeMirrorTextEditor.getForCodeMirror(codemirror).fullRange().collapseToEnd())) {\n    return CodeMirror.Pass;\n  }\n  codemirror.execCommand('goPageDown');\n  return undefined;\n};\n\nexport class CodeMirrorPositionHandle implements TextEditorPositionHandle {\n  _codeMirror: any;\n  _lineHandle: any;\n  _columnNumber: any;\n  // https://crbug.com/1151919 first * = CodeMirror.Editor, second * = CodeMirror.Pos\n  constructor(codeMirror: any, pos: any) {\n    this._codeMirror = codeMirror;\n    this._lineHandle = codeMirror.getLineHandle(pos.line);\n    this._columnNumber = pos.ch;\n  }\n\n  resolve(): {\n    lineNumber: number,\n    columnNumber: number,\n  }|null {\n    const lineNumber = this._lineHandle ? this._codeMirror.getLineNumber(this._lineHandle) : null;\n    if (typeof lineNumber !== 'number') {\n      return null;\n    }\n    return {lineNumber: lineNumber, columnNumber: this._columnNumber};\n  }\n\n  equal(argPositionHandle: TextEditorPositionHandle): boolean {\n    const positionHandle = argPositionHandle as CodeMirrorPositionHandle;\n    return positionHandle._lineHandle === this._lineHandle && positionHandle._columnNumber === this._columnNumber &&\n        positionHandle._codeMirror === this._codeMirror;\n  }\n}\n\nexport class SelectNextOccurrenceController {\n  _textEditor: CodeMirrorTextEditor;\n  _codeMirror: any;\n  _muteSelectionListener?: boolean;\n  _fullWordSelection?: boolean;\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  constructor(textEditor: CodeMirrorTextEditor, codeMirror: any) {\n    this._textEditor = textEditor;\n    this._codeMirror = codeMirror;\n  }\n\n  selectionWillChange(): void {\n    if (!this._muteSelectionListener) {\n      delete this._fullWordSelection;\n    }\n  }\n\n  _findRange(selections: TextUtils.TextRange.TextRange[], range: TextUtils.TextRange.TextRange): boolean {\n    for (let i = 0; i < selections.length; ++i) {\n      if (range.equal(selections[i])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  undoLastSelection(): void {\n    this._muteSelectionListener = true;\n    this._codeMirror.execCommand('undoSelection');\n    this._muteSelectionListener = false;\n  }\n\n  selectNextOccurrence(): void {\n    const selections = this._textEditor.selections();\n    let anyEmptySelection = false;\n    for (let i = 0; i < selections.length; ++i) {\n      const selection = selections[i];\n      anyEmptySelection = anyEmptySelection || selection.isEmpty();\n      if (selection.startLine !== selection.endLine) {\n        return;\n      }\n    }\n    if (anyEmptySelection) {\n      this._expandSelectionsToWords(selections);\n      return;\n    }\n\n    const last = selections[selections.length - 1];\n    let next: (TextUtils.TextRange.TextRange|null)|TextUtils.TextRange.TextRange = last;\n    do {\n      next = next ? this._findNextOccurrence(next, Boolean(this._fullWordSelection)) : null;\n    } while (next && this._findRange(selections, next) && !next.equal(last));\n\n    if (!next) {\n      return;\n    }\n    selections.push(next);\n\n    this._muteSelectionListener = true;\n    this._textEditor.setSelections(selections, selections.length - 1);\n    delete this._muteSelectionListener;\n\n    this._textEditor.scrollLineIntoView(next.startLine);\n  }\n\n  _expandSelectionsToWords(selections: TextUtils.TextRange.TextRange[]): void {\n    const newSelections = [];\n    for (let i = 0; i < selections.length; ++i) {\n      const selection = selections[i];\n      const startRangeWord = this._textEditor.wordRangeForCursorPosition(\n                                 selection.startLine, selection.startColumn, TextUtils.TextUtils.Utils.isWordChar) ||\n          TextUtils.TextRange.TextRange.createFromLocation(selection.startLine, selection.startColumn);\n      const endRangeWord = this._textEditor.wordRangeForCursorPosition(\n                               selection.endLine, selection.endColumn, TextUtils.TextUtils.Utils.isWordChar) ||\n          TextUtils.TextRange.TextRange.createFromLocation(selection.endLine, selection.endColumn);\n      const newSelection = new TextUtils.TextRange.TextRange(\n          startRangeWord.startLine, startRangeWord.startColumn, endRangeWord.endLine, endRangeWord.endColumn);\n      newSelections.push(newSelection);\n    }\n    this._textEditor.setSelections(newSelections, newSelections.length - 1);\n    this._fullWordSelection = true;\n  }\n\n  _findNextOccurrence(range: TextUtils.TextRange.TextRange, fullWord: boolean): TextUtils.TextRange.TextRange|null {\n    range = range.normalize();\n    let matchedLineNumber: number|undefined = undefined;\n    let matchedColumnNumber: number|undefined = undefined;\n    const textToFind = this._textEditor.text(range);\n    function findWordInLine(\n        wordRegex: RegExp, lineNumber: number, lineText: string, from: number, to: number): boolean {\n      if (typeof matchedLineNumber === 'number') {\n        return true;\n      }\n      wordRegex.lastIndex = from;\n      const result = wordRegex.exec(lineText);\n      if (!result || result.index + textToFind.length > to) {\n        return false;\n      }\n      matchedLineNumber = lineNumber;\n      matchedColumnNumber = result.index;\n      return true;\n    }\n\n    let iteratedLineNumber: number;\n    // https://crbug.com/1151919 * = CodeMirror.LineHandle\n    function lineIterator(regex: RegExp, lineHandle: any): true|undefined {\n      if (findWordInLine(regex, iteratedLineNumber++, lineHandle.text, 0, lineHandle.text.length)) {\n        return true;\n      }\n      return undefined;\n    }\n\n    let regexSource = Platform.StringUtilities.escapeForRegExp(textToFind);\n    if (fullWord) {\n      regexSource = '\\\\b' + regexSource + '\\\\b';\n    }\n    const wordRegex = new RegExp(regexSource, 'g');\n    const currentLineText = this._codeMirror.getLine(range.startLine);\n\n    findWordInLine(wordRegex, range.startLine, currentLineText, range.endColumn, currentLineText.length);\n    iteratedLineNumber = range.startLine + 1;\n    this._codeMirror.eachLine(range.startLine + 1, this._codeMirror.lineCount(), lineIterator.bind(null, wordRegex));\n    iteratedLineNumber = 0;\n    this._codeMirror.eachLine(0, range.startLine, lineIterator.bind(null, wordRegex));\n    findWordInLine(wordRegex, range.startLine, currentLineText, 0, range.startColumn);\n\n    if (typeof matchedLineNumber !== 'number' || typeof matchedColumnNumber !== 'number') {\n      return null;\n    }\n    const textToFindLength = textToFind ? textToFind.length : 0;\n    return new TextUtils.TextRange.TextRange(\n        matchedLineNumber as number, matchedColumnNumber as number, matchedLineNumber as number,\n        matchedColumnNumber + textToFindLength);\n  }\n}\n\n/**\n * @interface\n */\nexport interface TextEditorPositionHandle {\n  resolve(): {\n    lineNumber: number,\n    columnNumber: number,\n  }|null;\n\n  equal(positionHandle: TextEditorPositionHandle): boolean;\n}\n\nexport class TextEditorBookMark {\n  _marker: any;\n  _type: symbol;\n  _editor: CodeMirrorTextEditor;\n  // https://crbug.com/1151919 * = CodeMirror.TextMarker\n  constructor(marker: any, type: symbol, editor: CodeMirrorTextEditor) {\n    this._marker = marker;\n    this._type = type;\n    this._editor = editor;\n  }\n\n  clear(): void {\n    const position = this._marker.find();\n    this._marker.clear();\n    if (position) {\n      // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n      this._editor._updateDecorations(position.line);\n    }\n  }\n\n  refresh(): void {\n    this._marker.changed();\n    const position = this._marker.find();\n    if (position) {\n      // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n      this._editor._updateDecorations(position.line);\n    }\n  }\n\n  type(): symbol {\n    return this._type;\n  }\n\n  position(): TextUtils.TextRange.TextRange|null {\n    const pos = this._marker.find();\n    // @ts-ignore https://crbug.com/1151919 CodeMirror types are incorrect\n    return pos ? TextUtils.TextRange.TextRange.createFromLocation(pos.line, pos.ch) : null;\n  }\n}\nlet codeMirrorTextEditorFactoryInstance: CodeMirrorTextEditorFactory;\n\nexport class CodeMirrorTextEditorFactory implements UI.TextEditor.TextEditorFactory {\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): CodeMirrorTextEditorFactory {\n    const {forceNew} = opts;\n    if (!codeMirrorTextEditorFactoryInstance || forceNew) {\n      codeMirrorTextEditorFactoryInstance = new CodeMirrorTextEditorFactory();\n    }\n\n    return codeMirrorTextEditorFactoryInstance;\n  }\n  createEditor(options: UI.TextEditor.Options): CodeMirrorTextEditor {\n    return new CodeMirrorTextEditor(options);\n  }\n}\n\n// CodeMirror uses an offscreen <textarea> to detect input. Due to inconsistencies in the many browsers it supports,\n// it simplifies things by regularly checking if something is in the textarea, adding those characters to the document,\n// and then clearing the textarea. This breaks assistive technology that wants to read from CodeMirror, because the\n// <textarea> that they interact with is constantly empty.\n// Because we target up-to-date Chrome, we can guarantee consistent input events. This lets us leave the current\n// line from the editor in our <textarea>. CodeMirror still expects a mostly empty <textarea>, so we pass CodeMirror a\n// fake <textarea> that only contains the users input.\n// @ts-ignore\nexport class DevToolsAccessibleTextArea extends CodeMirror.inputStyles.textarea {\n  textarea!: HTMLTextAreaElement;\n  contextMenuPending: boolean;\n  composing: boolean;\n  cm: any;\n  prevInput!: string;\n\n  // https://crbug.com/1151919 * = CodeMirror.Editor\n  constructor(codeMirror: any) {\n    super(codeMirror);\n    this.cm = codeMirror;\n    this.contextMenuPending = false;\n    this.composing = false;\n  }\n\n  init(display: Object): void {\n    super.init(display);\n    this.textarea.addEventListener('compositionstart', this._onCompositionStart.bind(this));\n  }\n\n  _onCompositionStart(): void {\n    if (this.textarea.selectionEnd === this.textarea.value.length) {\n      return;\n    }\n    // CodeMirror always expects the caret to be at the end of the textarea\n    // When in IME composition mode, clip the textarea to how CodeMirror expects it,\n    // and then let CodeMirror do it's thing.\n    this.textarea.value = this.textarea.value.substring(0, this.textarea.selectionEnd);\n    this.textarea.setSelectionRange(this.textarea.value.length, this.textarea.value.length);\n    this.prevInput = this.textarea.value;\n  }\n\n  reset(typing?: boolean): void {\n    if (this.textAreaBusy(Boolean(typing))) {\n      super.reset(typing);\n      return;\n    }\n\n    // When navigating around the document, keep the current visual line in the textarea.\n    const cursor = this.cm.getCursor();\n    let start, end;\n    if (this.cm.getOption('lineWrapping')) {\n      // To get the visual line, compute the leftmost and rightmost character positions.\n      const top = this.cm.charCoords(cursor, 'page').top;\n      start = this.cm.coordsChar({left: -Infinity, top});\n      end = this.cm.coordsChar({left: Infinity, top});\n    } else {\n      // Limit the line to 1000 characters to prevent lag.\n      const offset = Math.floor(cursor.ch / 1000) * 1000;\n      start = {ch: offset, line: cursor.line};\n      end = {ch: offset + 1000, line: cursor.line};\n    }\n    this.textarea.value = this.cm.getRange(start, end);\n    const caretPosition = cursor.ch - start.ch;\n    this.textarea.setSelectionRange(caretPosition, caretPosition);\n    this.prevInput = this.textarea.value;\n  }\n\n  /**\n   * If the user is currently typing into the textarea or otherwise\n   * modifying it, we don't want to clobber their work.\n   */\n  protected textAreaBusy(typing: boolean): boolean {\n    return typing || this.contextMenuPending || this.composing || this.cm.somethingSelected();\n  }\n\n  poll(): boolean {\n    if (this.contextMenuPending || this.composing) {\n      return super.poll();\n    }\n    const text = this.textarea.value;\n    let start = 0;\n    const length = Math.min(this.prevInput.length, text.length);\n    while (start < length && this.prevInput[start] === text[start]) {\n      ++start;\n    }\n    let end = 0;\n    while (end < length - start && this.prevInput[this.prevInput.length - end - 1] === text[text.length - end - 1]) {\n      ++end;\n    }\n\n    // CodeMirror expects the user to be typing into a blank <textarea>.\n    // Pass a fake textarea into super.poll that only contains the users input.\n    const placeholder = this.textarea;\n    this.textarea = document.createElement('textarea');\n    this.textarea.value = text.substring(start, text.length - end);\n    this.textarea.setSelectionRange(placeholder.selectionStart - start, placeholder.selectionEnd - start);\n    this.prevInput = '';\n    const result = super.poll();\n    this.prevInput = text;\n    this.textarea = placeholder;\n    return result;\n  }\n}\n\n// @ts-ignore\nCodeMirror.inputStyles.devToolsAccessibleTextArea = DevToolsAccessibleTextArea;\n\nexport interface Decoration {\n  element: Element;\n  // https://crbug.com/1151919 * = CodeMirror.LineWidget\n  widget: any;\n  update: (() => void)|null;\n}\n"]}