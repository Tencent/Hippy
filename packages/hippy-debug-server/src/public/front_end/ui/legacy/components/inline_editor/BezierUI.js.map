{"version":3,"file":"BezierUI.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/inline_editor/BezierUI.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable rulesdir/no_underscored_properties */\n\nimport * as UI from '../../legacy.js';\n\nexport class BezierUI {\n  width: number;\n  height: number;\n  marginTop: number;\n  radius: number;\n  linearLine: boolean;\n\n  constructor(width: number, height: number, marginTop: number, controlPointRadius: number, linearLine: boolean) {\n    this.width = width;\n    this.height = height;\n    this.marginTop = marginTop;\n    this.radius = controlPointRadius;\n    this.linearLine = linearLine;\n  }\n\n  static drawVelocityChart(bezier: UI.Geometry.CubicBezier, path: Element, width: number): void {\n    const height = Height;\n    let pathBuilder: (string|number)[]|(string | number)[] = ['M', 0, height];\n    /** @const */ const sampleSize = 1 / 40;\n\n    let prev = bezier.evaluateAt(0);\n    for (let t = sampleSize; t < 1 + sampleSize; t += sampleSize) {\n      const current = bezier.evaluateAt(t);\n      let slope: number = (current.y - prev.y) / (current.x - prev.x);\n      const weightedX = prev.x * (1 - t) + current.x * t;\n      slope = Math.tanh(slope / 1.5);  // Normalise slope\n      pathBuilder = pathBuilder.concat(['L', (weightedX * width).toFixed(2), (height - slope * height).toFixed(2)]);\n      prev = current;\n    }\n    pathBuilder = pathBuilder.concat(['L', width.toFixed(2), height, 'Z']);\n    path.setAttribute('d', pathBuilder.join(' '));\n  }\n\n  curveWidth(): number {\n    return this.width - this.radius * 2;\n  }\n\n  curveHeight(): number {\n    return this.height - this.radius * 2 - this.marginTop * 2;\n  }\n\n  _drawLine(parentElement: Element, className: string, x1: number, y1: number, x2: number, y2: number): void {\n    const line = UI.UIUtils.createSVGChild(parentElement, 'line', className);\n    line.setAttribute('x1', String(x1 + this.radius));\n    line.setAttribute('y1', String(y1 + this.radius + this.marginTop));\n    line.setAttribute('x2', String(x2 + this.radius));\n    line.setAttribute('y2', String(y2 + this.radius + this.marginTop));\n  }\n\n  _drawControlPoints(parentElement: Element, startX: number, startY: number, controlX: number, controlY: number): void {\n    this._drawLine(parentElement, 'bezier-control-line', startX, startY, controlX, controlY);\n    const circle = UI.UIUtils.createSVGChild(parentElement, 'circle', 'bezier-control-circle');\n    circle.setAttribute('cx', String(controlX + this.radius));\n    circle.setAttribute('cy', String(controlY + this.radius + this.marginTop));\n    circle.setAttribute('r', String(this.radius));\n  }\n\n  drawCurve(bezier: UI.Geometry.CubicBezier|null, svg: Element): void {\n    if (!bezier) {\n      return;\n    }\n    const width = this.curveWidth();\n    const height = this.curveHeight();\n    svg.setAttribute('width', String(this.width));\n    svg.setAttribute('height', String(this.height));\n    svg.removeChildren();\n    const group = UI.UIUtils.createSVGChild(svg, 'g');\n\n    if (this.linearLine) {\n      this._drawLine(group, 'linear-line', 0, height, width, 0);\n    }\n\n    const curve = UI.UIUtils.createSVGChild(group, 'path', 'bezier-path');\n    const curvePoints = [\n      new UI.Geometry.Point(\n          bezier.controlPoints[0].x * width + this.radius,\n          (1 - bezier.controlPoints[0].y) * height + this.radius + this.marginTop),\n      new UI.Geometry.Point(\n          bezier.controlPoints[1].x * width + this.radius,\n          (1 - bezier.controlPoints[1].y) * height + this.radius + this.marginTop),\n      new UI.Geometry.Point(width + this.radius, this.marginTop + this.radius),\n    ];\n    curve.setAttribute(\n        'd', 'M' + this.radius + ',' + (height + this.radius + this.marginTop) + ' C' + curvePoints.join(' '));\n\n    this._drawControlPoints(\n        group, 0, height, bezier.controlPoints[0].x * width, (1 - bezier.controlPoints[0].y) * height);\n    this._drawControlPoints(\n        group, width, 0, bezier.controlPoints[1].x * width, (1 - bezier.controlPoints[1].y) * height);\n  }\n}\n\nexport const Height = 26;\n"]}